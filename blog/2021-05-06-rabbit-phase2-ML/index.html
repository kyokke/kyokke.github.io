<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/poole_hyde.css"> <style> html {font-size: 17px;} .franklin-content {position: relative; padding-left: 8%; padding-right: 5%; line-height: 1.35em;} @media (min-width: 940px) { .franklin-content {width: 100%; margin-left: auto; margin-right: auto;} } @media (max-width: 768px) { .franklin-content {padding-left: 6%; padding-right: 6%;} } </style> <title>ラビットチャレンジ: Phase.2 機械学習</title> <div class=sidebar > <div class="container sidebar-sticky"> <div class=sidebar-about > <h1><a href="/">kyokke's blog</a></h1> <p class=lead > julialang や　機械学習関連の作業/Tips 記録など</p> </div> <nav class=sidebar-nav > <!-- <a class="sidebar-nav-item {{ispage index.html}}active{{end}}" href="/">Home</a> <a class="sidebar-nav-item {{ispage /blog/*}}active{{end}}" href="/blog/">Blog</a> --> <!-- <a class="sidebar-nav-item {{ispage menu1/*}}active{{end}}" href="/menu1/">Code blocks</a> <a class="sidebar-nav-item {{ispage menu2/*}}active{{end}}" href="/menu2/">More goodies</a> <a class="sidebar-nav-item {{ispage menu3/*}}active{{end}}" href="/menu3/">Tags</a> --> </nav> <p>&copy; kyokke.</p> </div> </div> <div class="content container"> <div class=franklin-content ><h1 id="ラビットチャレンジ_phase2_機械学習"><a href="#ラビットチャレンジ_phase2_機械学習" class=header-anchor >ラビットチャレンジ: Phase.2 機械学習 </a></h1> <p>本ページはラビットチャレンジの、 Phase.2 機械学習のレポート提出を兼ねた受講記録です。 提出指示に対して、下記の方針でまとめました</p> <ol> <li><p>動画講義の要点まとめ</p> <ul> <li><p>自分がその手法を思い出して実装するのに必要な最低限の情報 &#40;モデル定義・評価関数・解放の着想があれば十分かなぁ.. &#41;</p> <li><p>講義で口頭補足されたトピックなどあれば。</p> </ul> </ol> <ol start=2 > <li><p>実装演習&#40;ハンズオン実行&#41;</p> <ul> <li><p>基本的には scikit-learn のノートの内容に準じる&#40;より実践的?っぽいので&#41;</p> <ul> <li><p>対応する numpy実装を見て、sikit-learn側に応用できそうなことがあればやってみる &#40;コアアルゴリズム部分を numpy 実装に置き換えてみるとか&#41; </p> <li><p>その他パラメータのチューニングなど。その他、何か追加でやりたくなったら、適当に追加。</p> </ul> <li><p>ノートブックを jupyter nbconvert で markdown に変換しその抜粋を掲載</p> <ul> <li><p>markdown /コード/出力 のそれぞれに関して、blog上での表示を考慮してあとから微調整を行う</p> <li><p>手法に関する一般的な説明・数式展開などは、要点のまとめ側に移動する場合も　</p> </ul> </ul> </ol> <h2 id="目次"><a href="#目次" class=header-anchor >目次</a></h2> <div class=franklin-toc ><ol><li><a href="#目次">目次</a><li><a href="#各論前の講義内容">各論前の講義内容　</a><li><a href="#線形回帰モデル">線形回帰モデル </a><ol><li><a href="#動画講義メモ要点のまとめ">動画講義メモ&#40;要点のまとめ&#41;</a><li><a href="#ハンズオン_線形回帰モデル-boston_hausing_data-">ハンズオン: 線形回帰モデル-Boston Hausing Data-</a><ol><li><a href="#必要モジュールとデータのインポート">必要モジュールとデータのインポート</a><li><a href="#データフレームの作成">データフレームの作成</a><li><a href="#単回帰分析">単回帰分析</a><li><a href="#重回帰分析2変数">重回帰分析&#40;2変数&#41;</a><li><a href="#モデルの検証">モデルの検証</a></ol></ol><li><a href="#非線形回帰">非線形回帰 </a><ol><li><a href="#動画講義メモ要点のまとめ__2">動画講義メモ&#40;要点のまとめ&#41;</a><li><a href="#ハンズオン">ハンズオン</a><ol><li><a href="#多項式回帰">多項式回帰</a><li><a href="#ガウシアン基底_正則化項">ガウシアン基底 &#43; 正則化項</a><li><a href="#サポートベクトル回帰svr">サポートベクトル回帰&#40;SVR&#41;</a><li><a href="#多層パーセプトロンによる回帰">多層パーセプトロンによる回帰</a></ol></ol><li><a href="#ロジスティック回帰">ロジスティック回帰</a><ol><li><a href="#動画講義メモ要点のまとめ__3">動画講義メモ&#40;要点のまとめ&#41;</a><li><a href="#ハンズオン__2">ハンズオン</a><ol><li><a href="#データ読み込み_前処理">データ読み込み &amp; 前処理</a><li><a href="#実装チケット価格から生死を判別">実装&#40;チケット価格から生死を判別&#41;</a><li><a href="#実装2変数から生死を判別">実装&#40;2変数から生死を判別&#41;</a><li><a href="#モデル評価">モデル評価</a></ol></ol><li><a href="#主成分分析_pca">主成分分析 &#40;PCA&#41; </a><ol><li><a href="#動画講義メモ要点のまとめ__4">動画講義メモ&#40;要点のまとめ&#41;</a><li><a href="#ハンズオン__3">ハンズオン</a></ol><li><a href="#k-nnmeans_法_レポート提出課題の_アルゴリズム_の単元に該当">k-nn/means 法 &#40;レポート提出課題の &quot;アルゴリズム&quot; の単元に該当?&#41;</a><ol><li><a href="#動画講義メモ要点のまとめ__5">動画講義メモ&#40;要点のまとめ&#41;</a><li><a href="#ハンズオン__4">ハンズオン</a><ol><li><a href="#k-nn_で分類">k-nn で分類</a><li><a href="#k-means_クラスタリング">k-means クラスタリング</a></ol></ol><li><a href="#サポートベクターマシンsvm">サポートベクターマシン&#40;SVM&#41;</a><ol><li><a href="#動画講義メモ要点のまとめ__6">動画講義メモ&#40;要点のまとめ&#41;</a><li><a href="#ハンズオン__5">ハンズオン</a><ol><li><a href="#線形分離可能なケース">線形分離可能なケース</a><li><a href="#線形分離不可能なケース">線形分離不可能なケース</a></ol><li><a href="#重なりのあるケースでの_ソフトマージンsvm">重なりのあるケースでの ソフトマージンSVM</a><li><a href="#双対問題の導出_通常のsvmのケースについて">双対問題の導出 &#40;通常のSVMのケースについて&#41;</a></ol><li><a href="#取り組み概要_感想">取り組み概要 &amp; 感想</a><ol><li><a href="#取り組みの記録">取り組みの記録</a><li><a href="#感想ほか">感想ほか　</a></ol><li><a href="#計画の見直し_20210506_時点">計画の見直し &#40;2021/05/06 時点&#41;</a></ol></div> <h2 id="各論前の講義内容"><a href="#各論前の講義内容" class=header-anchor >各論前の講義内容　</a></h2> <ul> <li><p>プロローグ &#40; なぜ 非ディープラーニングの機械学習の勉強をするのか? &#41;</p> <ul> <li><p>数学的な背景を元にした機械学習の基礎を抑えていないエンジニアは、フレームワークを使って機械学習モデルを組める「程度」の人材にしかならない</p> </ul> </ul> <ul> <li><p>機械学習のモデリングプロセスをしっかりと抑えることが重要</p> <ol> <li><p>問題設定</p> <ul> <li><p>最終的な使われ方をイメージしよう</p> <li><p>必ずしも機械学習を使う必要は無く、ルールベースで解けるならそっちの方が楽</p> <ul> <li><p>技術的負債になりやすい</p> <ul> <li><p>自分が開発した技術を運用チームに移管するとして、移管先に専門知識を持った人間がいなければSLA&#40;Service Level Agreement&#41;を担保できない</p> </ul> <li><p>テストしにくい・考慮すべきことが多い</p> <li><p>データ集めるの大変</p> </ul> </ul> <li><p>データ選定</p> <ul> <li><p>GIGO&#40;garbage in garbage out&#41; &#61; ゴミを突っ込んだらゴミが出てくる</p> <ul> <li><p>ex. 集めたデータに&#40;意図しない&#41;バイアスがかかっているなど。</p> </ul> </ul> <li><p>データの前処理</p> <ul> <li><p>開発時間の殆どは、このプロセスに費やされるといっても過言でない</p> <li><p>実務経験がモノをいうところ。練習のチャンスがない人は、kaggleなどやるといい</p> </ul> <li><p>モデルの選定</p> <ul> <li><p>ディープラーニング&#40;で扱われるモデル&#41;も、機械学習モデルの一部に過ぎず、このプロセスの具体的な作業が異なるだけ</p> </ul> <li><p>モデルパラメータの決定</p> <li><p>モデルの評価</p> </ol> </ul> <ul> <li><p>ルールベースモデルと機械学習モデル</p> <ul> <li><p>技術者として、機械学習とは?と聞かれたら何らかの形で答えられるようになっておくこと</p> <ul> <li><p>講師の体感では、機械学習ってなに? と聞かれるよりも、人工知能って何? と聞かれることの方が多いらしい </p> </ul> </ul> </ul> <h2 id="線形回帰モデル"><a href="#線形回帰モデル" class=header-anchor >線形回帰モデル </a></h2> <h3 id="動画講義メモ要点のまとめ"><a href="#動画講義メモ要点のまとめ" class=header-anchor >動画講義メモ&#40;要点のまとめ&#41;</a></h3> <ul> <li><p>回帰問題 &#61; 入力から出力を予測する問題。線形回帰は、回帰式が線形。</p> <ul> <li><p>線形回帰モデルの形 &#40;線形とは?&#41; </p> <ul> <li><p>ざっくり説明 &#61; 入出力が比例関係である &#40;直線・平面・超平面&#41;</p> <li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><msub><mi>w</mi><mn>0</mn></msub><mo>+</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex"> y = w_0 + \sum_{i=1}^{n-1} w_i x_i </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.73333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.253718em;vertical-align:-0.29971000000000003em;"></span><span class=mop ><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.954008em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p> <ul> <li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex"> = \sum_{i=0}^{n-1} w_i x_i </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.36687em;vertical-align:0em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.253718em;vertical-align:-0.29971000000000003em;"></span><span class=mop ><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.954008em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> </p> <li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><msup><mi mathvariant=bold-italic >w</mi><mi>T</mi></msup><mi mathvariant=bold-italic >x</mi></mrow><annotation encoding="application/x-tex"> = \bm{w}^T \bm{x} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.36687em;vertical-align:0em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8413309999999999em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span></span></span></span> ただし <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant=bold-italic >w</mi><mi>T</mi></msup><mo>=</mo><mo stretchy=false >(</mo><msub><mi>w</mi><mn>0</mn></msub><mo separator=true >,</mo><msub><mi>w</mi><mn>1</mn></msub><mo separator=true >,</mo><mi mathvariant=normal >.</mi><mi mathvariant=normal >.</mi><mi mathvariant=normal >.</mi><mo separator=true >,</mo><msub><mi>w</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> \bm{w}^T = (w_0, w_1, ... , w_{n-1})</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8413309999999999em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >.</span><span class=mord >.</span><span class=mord >.</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant=bold-italic >x</mi><mi>T</mi></msup><mo>=</mo><mo stretchy=false >(</mo><mn>1</mn><mo separator=true >,</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=true >,</mo><mi mathvariant=normal >.</mi><mi mathvariant=normal >.</mi><mi mathvariant=normal >.</mi><mo separator=true >,</mo><msub><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> \bm{x}^T = (1, x_1, ... , x_{n-1})</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8413309999999999em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >.</span><span class=mord >.</span><span class=mord >.</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span> </p> </ul> <li><p>記法としては ベクトルが便利、訳わからなったら sigma 記法にする</p> <ul> <li><p>このベクトル/行列と 要素ごとの記法の行き来ができることがポイント</p> <li><p>この後の記述とあわせて係数は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span> にした</p> </ul> </ul> <li><p>出力について</p> <ul> <li><p>連続値とスライドに書かれているが、離散値でもいい</p> <ul> <li><p>例: 諸条件から、競馬の順位を予想する</p> <ul> <li><p>cf. &quot;vapnik の原理&quot; には反する</p> <ul> <li><p>順位 &#61; 大小関係 がわかるだけでいいのに、もっと難しい回帰問題を解くべきではないという話。</p> <li><p><a href="https://www.ism.ac.jp/editsec/toukei/pdf/58-2-141.pdf">論文</a></p> </ul> </ul> </ul> <li><p>スカラーと書いてあるが、多次元のベクトルにしてもいい&#40;マルチタスク学習など&#41;</p> <li><p>データ分割・学習</p> <ul> <li><p>未知のデータに対する予測精度をあげたいので、テスト用のデータと、学習用のデータは分ける</p> <li><p>最尤法による解とMSEの最小化は等価と書いてあったが、それは誤差を確率変数としたとき、これが正規分布に従う場合では? &#40;他の分布なら、別の解でてくる場合もあるよね?&#41; </p> </ul> </ul> <li><p>誤差について</p> <ul> <li><p>必ずしも偶発的な誤差だけではなく、モデル化誤差もある</p> <ul> <li><p>y &#61; 来店者数、x &#61; 気温 で予測ができる? いや、曜日にも影響する。このとき、曜日の項の影響は誤差になる</p> </ul> </ul> <li><p>未知数の数と方程式の数について</p> <ul> <li><p>今、重みw は m&#43;1 次元なので、基本的には、 m&#43;1 以上の方程式がないと厳しい</p> <ul> <li><p>データの方が少ないケースを扱う手法もあるが、それは advanced </p> <li><p>DLの場合パラメータがたくさんあるので、データが必要</p> </ul> </ul> <li><p>パラメータ推定方法 : 最小二乗法</p> <ul> <li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant=normal >M</mi><mi mathvariant=normal >S</mi><msub><mi mathvariant=normal >E</mi><mrow><mi mathvariant=normal >t</mi><mi mathvariant=normal >r</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >i</mi><mi mathvariant=normal >n</mi></mrow></msub></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msub></msubsup><mo stretchy=false >(</mo><msup><mover accent=true ><msub><mi>y</mi><mi>i</mi></msub><mo>^</mo></mover><mrow><mo stretchy=false >(</mo><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi><mo stretchy=false >)</mo></mrow></msup><mo>−</mo><msubsup><mi>y</mi><mi>i</mi><mrow><mo stretchy=false >(</mo><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi><mo stretchy=false >)</mo></mrow></msubsup><msup><mo stretchy=false >)</mo><mn>2</mn></msup><mo>=</mo><mo>∑</mo><msup><mi>ϵ</mi><mn>2</mn></msup><mo>:</mo><mo>=</mo><mi>J</mi><mo stretchy=false >(</mo><mi>w</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> \mathrm{MSE_{train}} = \frac{1}{n} \sum_{i=1}^{n_{train}} (\hat{y_i}^{(train)}-y_i^{(train)})^2 = \sum \epsilon^2 := J(w) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathrm">M</span><span class="mord mathrm">S</span><span class=mord ><span class="mord mathrm">E</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31750199999999995em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">t</span><span class="mord mathrm mtight">r</span><span class="mord mathrm mtight">a</span><span class="mord mathrm mtight">i</span><span class="mord mathrm mtight">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.31734em;vertical-align:-0.345em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mop ><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.69444em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.25em;"><span class=mord >^</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.19444em;"><span></span></span></span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.97234em;"><span style="top:-3.14734em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">n</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.321664em;vertical-align:-0.27686399999999994em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">n</span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.27686399999999994em;"><span></span></span></span></span></span></span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.064118em;vertical-align:-0.25001em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">ϵ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >:</span></span><span class=base ><span class=strut  style="height:0.36687em;vertical-align:0em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mclose >)</span></span></span></span></p> <ul> <li><p>MSE &#61; mean square error</p> </ul> <li><p>これをパラメータについて微分して、勾配が0になる点を求める</p> <ul> <li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi><mover accent=true ><mi mathvariant=bold-italic >w</mi><mo>^</mo></mover></mi><mo>=</mo><mo stretchy=false >(</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><msup><mo stretchy=false >)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>X</mi><mi>T</mi></msup><mi mathvariant=bold-italic >y</mi></mrow><annotation encoding="application/x-tex"> \bm{\hat{w}}= (X^T X) ^{-1} X^T \bm{y} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.70788em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.70788em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span style="top:-3.01344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.2875em;"><span class="mord mathbf">^</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span></span></span></span> : &#40;train&#41; は省略</p> <ul> <li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold-italic >y</mi></mrow><annotation encoding="application/x-tex">\bm{y}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.63888em;vertical-align:-0.19444em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span></span></span></span> に 一般化逆行列をかけた形</p> </ul> <li><p>必ずしも誤差関数として二乗誤差は最適ではないことに注意</p> <ul> <li><p>基本的にハズレ値の存在にかなり弱くなる</p> <li><p>Huber loss, Tukey loss とか　を使うとハズレ値に強くなる</p> </ul> </ul> <li><p>よく使う ベクトルの微分の形</p> <ul> <li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi mathvariant=normal >∂</mi><mrow><mi mathvariant=normal >∂</mi><mi mathvariant=bold-italic >w</mi></mrow></mfrac><msup><mi mathvariant=bold-italic >w</mi><mi>T</mi></msup><mi mathvariant=bold-italic >x</mi><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex"> \frac{\partial}{\partial \bm{w}} \bm{w} ^T \bm{x} = x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.02778em;">w</span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span></p> <li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi mathvariant=normal >∂</mi><mrow><mi mathvariant=normal >∂</mi><mi mathvariant=bold-italic >w</mi></mrow></mfrac><msup><mi mathvariant=bold-italic >w</mi><mi>T</mi></msup><mi>A</mi><mi mathvariant=bold-italic >w</mi><mo>=</mo><mo stretchy=false >(</mo><mi>A</mi><mo>+</mo><msup><mi>A</mi><mi>T</mi></msup><mo stretchy=false >)</mo><mi mathvariant=bold-italic >x</mi><mo>=</mo><mn>2</mn><mi>A</mi><mi mathvariant=bold-italic >x</mi></mrow><annotation encoding="application/x-tex"> \frac{\partial}{\partial \bm{w}} \bm{w}^T A \bm{w} = (A+A^T) \bm{x} = 2A\bm{x}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.02778em;">w</span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">A</span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class=mclose >)</span><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >2</span><span class="mord mathnormal">A</span><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span></span></span></span> &#40;Aが対称行列のとき&#41;</p> <li><p>参考図書: Matrix Cook Book </p> </ul> </ul> </ul> </ul> <ul> <li><p>ハンズオンに関するコメント</p> <ul> <li><p>全部の説明変数を使う必要はないし、使うべきではないことがある</p> <li><p>12番目の &quot;アフリカ系アメリカ人居住者の割合&quot; など</p> <li><p>現実のデータセットを扱う上では、よくデータをみる必要がある</p> <ul> <li><p>得られたデータの中に使用すべきでないもの&#40;ハズレ値など&#41; があるかもしれない</p> <li><p>要約統計量などを適宜活用</p> <li><p>pandas で 12行目まで観察 &#40; 頭の数行みて、怪しい所があったから。最初の5行 CHAS全部0じゃね?&#41;</p> </ul> <li><p>エイヤで学習すると、マイナスの価格が出てしまった件</p> <ul> <li><p>こういう現象が出た時点でおかしい、と気付かなければいけない</p> <li><p>何がダメだったんだろう -&gt; 1部屋のケースなどがデータに入ってないんだろうな</p> <ul> <li><p>外挿問題にDLは基本的には弱い 5~10部屋の範囲のデータから学習したとき、11部屋, 2部屋の時の予測は上手く行かない</p> </ul> </ul> <li><p>scikit-learn や tensorflow で動かすのは小学生でもできる。なんとなく動かすんじゃなくて、数式に対する理解を持つこと</p> <li><p>多重回帰の場合も試しに実行してみてね</p> <ul> <li><p>学習されたモデルを評価する</p> <li><p>部屋を増やしてみる&#40;価格増えるはず&#41;</p> <li><p>犯罪率増やしてみる&#40;価格下がるはず&#41;</p> </ul> </ul> </ul> <h3 id="ハンズオン_線形回帰モデル-boston_hausing_data-"><a href="#ハンズオン_線形回帰モデル-boston_hausing_data-" class=header-anchor >ハンズオン: 線形回帰モデル-Boston Hausing Data-</a></h3></p> <h4 id="必要モジュールとデータのインポート"><a href="#必要モジュールとデータのインポート" class=header-anchor >必要モジュールとデータのインポート</a></h4> <pre><code class="python hljs"><span class=hljs-comment >#from モジュール名 import クラス名（もしくは関数名や変数名）</span>
<span class=hljs-keyword >from</span> sklearn.datasets <span class=hljs-keyword >import</span> load_boston
<span class=hljs-keyword >from</span> pandas <span class=hljs-keyword >import</span> DataFrame
<span class=hljs-keyword >import</span> numpy <span class=hljs-keyword >as</span> np</code></pre> <pre><code class="python hljs"><span class=hljs-comment ># ボストンデータを&quot;boston&quot;というインスタンスにインポート</span>
boston = load_boston()

<span class=hljs-comment ># Bunch オブジェクト</span>
<span class=hljs-comment >#  https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch</span>
<span class=hljs-built_in >print</span>(<span class=hljs-built_in >type</span>(boston))
<span class=hljs-built_in >print</span>(boston.keys())</code></pre> <p>&lt;class &#39;sklearn.utils.Bunch&#39;&gt; dict_keys&#40;&#91;&#39;data&#39;, &#39;target&#39;, &#39;feature_names&#39;, &#39;DESCR&#39;, &#39;filename&#39;&#93;&#41;</p> <pre><code class="python hljs"><span class=hljs-comment >#DESCR変数の中身を確認</span>
<span class=hljs-built_in >print</span>(boston[<span class=hljs-string >&#x27;DESCR&#x27;</span>])</code></pre> <pre><code class="julia hljs">.. _boston_dataset:
    
    Boston house prices dataset
    ---------------------------
    
    **Data <span class=hljs-built_in >Set</span> Characteristics:**  
    
        :<span class=hljs-built_in >Number</span> of Instances: <span class=hljs-number >506</span> 
    
        :<span class=hljs-built_in >Number</span> of Attributes: <span class=hljs-number >13</span> numeric/categorical predictive. Median Value (attribute <span class=hljs-number >14</span>) is usually the target.
    
        :Attribute Information (<span class=hljs-keyword >in</span> order):
            - CRIM     per capita crime rate by town
            - ZN       proportion of residential land zoned <span class=hljs-keyword >for</span> lots over <span class=hljs-number >25</span>,<span class=hljs-number >000</span> sq.ft.
            - INDUS    proportion of non-retail business acres per town
            - CHAS     Charles River dummy variable (= <span class=hljs-number >1</span> <span class=hljs-keyword >if</span> tract bounds river; <span class=hljs-number >0</span> otherwise)
            - NOX      nitric oxides concentration (parts per <span class=hljs-number >10</span> million)
            - RM       average number of rooms per dwelling
            - AGE      proportion of owner-occupied units built prior to <span class=hljs-number >1940</span>
            - DIS      weighted distances to five Boston employment centres
            - RAD      index of accessibility to radial highways
            - TAX      full-value property-tax rate per $<span class=hljs-number >10</span>,<span class=hljs-number >000</span>
            - PTRATIO  pupil-teacher ratio by town
            - B        <span class=hljs-number >1000</span>(Bk - <span class=hljs-number >0.63</span>)^<span class=hljs-number >2</span> <span class=hljs-keyword >where</span> Bk is the proportion of black people by town
            - LSTAT    % lower status of the population
            - MEDV     Median value of owner-occupied homes <span class=hljs-keyword >in</span> $<span class=hljs-number >1000</span>&#x27;s
    
        :<span class=hljs-built_in >Missing</span> Attribute Values: None
    
        :Creator: Harrison, D. and Rubinfeld, D.L.
    
    This is a copy of UCI ML housing dataset.
    https://archive.ics.uci.edu/ml/machine-learning-databases/housing/
    
    
    This dataset was taken from the StatLib library which is maintained at Carnegie Mellon University.
    
    The Boston house-price data of Harrison, D. and Rubinfeld, D.L. &#x27;Hedonic
    prices and the demand <span class=hljs-keyword >for</span> clean air&#x27;, J. Environ. Economics &amp; Management,
    vol<span class=hljs-number >.5</span>, <span class=hljs-number >81</span>-<span class=hljs-number >102</span>, <span class=hljs-number >1978.</span>   Used <span class=hljs-keyword >in</span> Belsley, Kuh &amp; Welsch, &#x27;Regression diagnostics
    ...&#x27;, Wiley, <span class=hljs-number >1980.</span>   N.B. Various transformations are used <span class=hljs-keyword >in</span> the table on
    pages <span class=hljs-number >244</span>-<span class=hljs-number >261</span> of the latter.
    
    The Boston house-price data has been used <span class=hljs-keyword >in</span> many machine learning papers that address regression
    problems.   
         
    .. topic:: References
    
       - Belsley, Kuh &amp; Welsch, &#x27;Regression diagnostics: Identifying Influential Data and Sources of Collinearity&#x27;, Wiley, <span class=hljs-number >1980.</span> <span class=hljs-number >244</span>-<span class=hljs-number >261.</span>
       - Quinlan,R. (<span class=hljs-number >1993</span>). Combining Instance-Based and Model-Based Learning. In Proceedings on the Tenth International Conference of Machine Learning, <span class=hljs-number >236</span>-<span class=hljs-number >243</span>, University of Massachusetts, Amherst. Morgan Kaufmann.</code></pre> <pre><code class="python hljs"><span class=hljs-comment >#feature_names変数の中身を確認</span>
<span class=hljs-comment >#カラム名</span>
<span class=hljs-built_in >print</span>(boston[<span class=hljs-string >&#x27;feature_names&#x27;</span>])</code></pre> <p>&#91;&#39;CRIM&#39; &#39;ZN&#39; &#39;INDUS&#39; &#39;CHAS&#39; &#39;NOX&#39; &#39;RM&#39; &#39;AGE&#39; &#39;DIS&#39; &#39;RAD&#39; &#39;TAX&#39; &#39;PTRATIO&#39; &#39;B&#39; &#39;LSTAT&#39;&#93;</p> <pre><code class="python hljs"><span class=hljs-comment >#data変数(説明変数)の中身を確認</span>
<span class=hljs-built_in >print</span>(boston[<span class=hljs-string >&#x27;data&#x27;</span>])</code></pre> <p>&#91;&#91;6.3200e-03 1.8000e&#43;01 2.3100e&#43;00 ... 1.5300e&#43;01 3.9690e&#43;02 4.9800e&#43;00&#93; &#91;2.7310e-02 0.0000e&#43;00 7.0700e&#43;00 ... 1.7800e&#43;01 3.9690e&#43;02 9.1400e&#43;00&#93; &#91;2.7290e-02 0.0000e&#43;00 7.0700e&#43;00 ... 1.7800e&#43;01 3.9283e&#43;02 4.0300e&#43;00&#93; ... &#91;6.0760e-02 0.0000e&#43;00 1.1930e&#43;01 ... 2.1000e&#43;01 3.9690e&#43;02 5.6400e&#43;00&#93; &#91;1.0959e-01 0.0000e&#43;00 1.1930e&#43;01 ... 2.1000e&#43;01 3.9345e&#43;02 6.4800e&#43;00&#93; &#91;4.7410e-02 0.0000e&#43;00 1.1930e&#43;01 ... 2.1000e&#43;01 3.9690e&#43;02 7.8800e&#43;00&#93;&#93;</p> <pre><code class="python hljs"><span class=hljs-comment >#target変数(目的変数)の中身を確認</span>
<span class=hljs-built_in >print</span>(boston[<span class=hljs-string >&#x27;target&#x27;</span>])</code></pre> <p>&#91;24. 21.6 34.7 33.4 36.2 28.7 22.9 27.1 16.5 18.9 15. 18.9 21.7 20.4 18.2 19.9 23.1 17.5 20.2 18.2 13.6 19.6 15.2 14.5 15.6 13.9 16.6 14.8 18.4 21. 12.7 14.5 13.2 13.1 13.5 18.9 20. 21. 24.7 30.8 34.9 26.6 25.3 24.7 21.2 19.3 20. 16.6 14.4 19.4 19.7 20.5 25. 23.4 18.9 35.4 24.7 31.6 23.3 19.6 18.7 16. 22.2 25. 33. 23.5 19.4 22. 17.4 20.9 24.2 21.7 22.8 23.4 24.1 21.4 20. 20.8 21.2 20.3 28. 23.9 24.8 22.9 23.9 26.6 22.5 22.2 23.6 28.7 22.6 22. 22.9 25. 20.6 28.4 21.4 38.7 43.8 33.2 27.5 26.5 18.6 19.3 20.1 19.5 19.5 20.4 19.8 19.4 21.7 22.8 18.8 18.7 18.5 18.3 21.2 19.2 20.4 19.3 22. 20.3 20.5 17.3 18.8 21.4 15.7 16.2 18. 14.3 19.2 19.6 23. 18.4 15.6 18.1 17.4 17.1 13.3 17.8 14. 14.4 13.4 15.6 11.8 13.8 15.6 14.6 17.8 15.4 21.5 19.6 15.3 19.4 17. 15.6 13.1 41.3 24.3 23.3 27. 50. 50. 50. 22.7 25. 50. 23.8 23.8 22.3 17.4 19.1 23.1 23.6 22.6 29.4 23.2 24.6 29.9 37.2 39.8 36.2 37.9 32.5 26.4 29.6 50. 32. 29.8 34.9 37. 30.5 36.4 31.1 29.1 50. 33.3 30.3 34.6 34.9 32.9 24.1 42.3 48.5 50. 22.6 24.4 22.5 24.4 20. 21.7 19.3 22.4 28.1 23.7 25. 23.3 28.7 21.5 23. 26.7 21.7 27.5 30.1 44.8 50. 37.6 31.6 46.7 31.5 24.3 31.7 41.7 48.3 29. 24. 25.1 31.5 23.7 23.3 22. 20.1 22.2 23.7 17.6 18.5 24.3 20.5 24.5 26.2 24.4 24.8 29.6 42.8 21.9 20.9 44. 50. 36. 30.1 33.8 43.1 48.8 31. 36.5 22.8 30.7 50. 43.5 20.7 21.1 25.2 24.4 35.2 32.4 32. 33.2 33.1 29.1 35.1 45.4 35.4 46. 50. 32.2 22. 20.1 23.2 22.3 24.8 28.5 37.3 27.9 23.9 21.7 28.6 27.1 20.3 22.5 29. 24.8 22. 26.4 33.1 36.1 28.4 33.4 28.2 22.8 20.3 16.1 22.1 19.4 21.6 23.8 16.2 17.8 19.8 23.1 21. 23.8 23.1 20.4 18.5 25. 24.6 23. 22.2 19.3 22.6 19.8 17.1 19.4 22.2 20.7 21.1 19.5 18.5 20.6 19. 18.7 32.7 16.5 23.9 31.2 17.5 17.2 23.1 24.5 26.6 22.9 24.1 18.6 30.1 18.2 20.6 17.8 21.7 22.7 22.6 25. 19.9 20.8 16.8 21.9 27.5 21.9 23.1 50. 50. 50. 50. 50. 13.8 13.8 15. 13.9 13.3 13.1 10.2 10.4 10.9 11.3 12.3 8.8 7.2 10.5 7.4 10.2 11.5 15.1 23.2 9.7 13.8 12.7 13.1 12.5 8.5 5. 6.3 5.6 7.2 12.1 8.3 8.5 5. 11.9 27.9 17.2 27.5 15. 17.2 17.9 16.3 7. 7.2 7.5 10.4 8.8 8.4 16.7 14.2 20.8 13.4 11.7 8.3 10.2 10.9 11. 9.5 14.5 14.1 16.1 14.3 11.7 13.4 9.6 8.7 8.4 12.8 10.5 17.1 18.4 15.4 10.8 11.8 14.9 12.6 14.1 13. 13.4 15.2 16.1 17.8 14.9 14.1 12.7 13.5 14.9 20. 16.4 17.7 19.5 20.2 21.4 19.9 19. 19.1 19.1 20.1 19.9 19.6 23.2 29.8 13.8 13.3 16.7 12. 14.6 21.4 23. 23.7 25. 21.8 20.6 21.2 19.1 20.6 15.2 7. 8.1 13.6 20.1 21.8 24.5 23.1 19.7 18.3 21.2 17.5 16.8 22.4 20.6 23.9 22. 11.9&#93;</p> <h4 id="データフレームの作成"><a href="#データフレームの作成" class=header-anchor >データフレームの作成</a></h4> <pre><code class="python hljs"><span class=hljs-comment >#　説明変数らをDataFrameへ変換</span>
df = DataFrame(data=boston.data, columns = boston.feature_names)

<span class=hljs-comment ># 目的変数をDataFrameへ追加</span>
df[<span class=hljs-string >&#x27;PRICE&#x27;</span>] = np.array(boston.target)

<span class=hljs-comment ># 最初の5行を表示</span>
df.head(<span class=hljs-number >5</span>)</code></pre> <div> <style scoped> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } </style> <table border=1  class=dataframe > <thead> <tr style="text-align: right;"> <th> <th>CRIM <th>ZN <th>INDUS <th>CHAS <th>NOX <th>RM <th>AGE <th>DIS <th>RAD <th>TAX <th>PTRATIO <th>B <th>LSTAT <th>PRICE <tr> <th>0 <td>0.00632 <td>18.0 <td>2.31 <td>0.0 <td>0.538 <td>6.575 <td>65.2 <td>4.0900 <td>1.0 <td>296.0 <td>15.3 <td>396.90 <td>4.98 <td>24.0 <tr> <th>1 <td>0.02731 <td>0.0 <td>7.07 <td>0.0 <td>0.469 <td>6.421 <td>78.9 <td>4.9671 <td>2.0 <td>242.0 <td>17.8 <td>396.90 <td>9.14 <td>21.6 <tr> <th>2 <td>0.02729 <td>0.0 <td>7.07 <td>0.0 <td>0.469 <td>7.185 <td>61.1 <td>4.9671 <td>2.0 <td>242.0 <td>17.8 <td>392.83 <td>4.03 <td>34.7 <tr> <th>3 <td>0.03237 <td>0.0 <td>2.18 <td>0.0 <td>0.458 <td>6.998 <td>45.8 <td>6.0622 <td>3.0 <td>222.0 <td>18.7 <td>394.63 <td>2.94 <td>33.4 <tr> <th>4 <td>0.06905 <td>0.0 <td>2.18 <td>0.0 <td>0.458 <td>7.147 <td>54.2 <td>6.0622 <td>3.0 <td>222.0 <td>18.7 <td>396.90 <td>5.33 <td>36.2 </table> </div> <h4 id="単回帰分析"><a href="#単回帰分析" class=header-anchor >単回帰分析</a></h4> <pre><code class="python hljs"><span class=hljs-comment ># 説明変数</span>
data = df.loc[:, [<span class=hljs-string >&#x27;RM&#x27;</span>]].values
<span class=hljs-comment ># 目的変数</span>
target = df.loc[:, <span class=hljs-string >&#x27;PRICE&#x27;</span>].values
<span class=hljs-comment ># 予測したいケース rm=1</span>
sample = np.array([[<span class=hljs-number >1</span>]])</code></pre> <pre><code class="python hljs"><span class=hljs-comment >#dataリストの表示(1-5)</span>
data[<span class=hljs-number >0</span>:<span class=hljs-number >5</span>]</code></pre> <p>array&#40;&#91;&#91;6.575&#93;, &#91;6.421&#93;, &#91;7.185&#93;, &#91;6.998&#93;, &#91;7.147&#93;&#93;&#41;</p> <pre><code class="python hljs">target[<span class=hljs-number >0</span>:<span class=hljs-number >5</span>]</code></pre>
<p>array&#40;&#91;24. , 21.6, 34.7, 33.4, 36.2&#93;&#41;</p>
<pre><code class="python hljs"><span class=hljs-comment >## sklearnモジュールからLinearRegressionをインポート</span>
<span class=hljs-keyword >from</span> sklearn.linear_model <span class=hljs-keyword >import</span> LinearRegression

<span class=hljs-comment ># オブジェクト生成</span>
model = LinearRegression()
<span class=hljs-comment ># model.get_params()</span>

<span class=hljs-comment ># https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html</span>
<span class=hljs-comment ># コメントアウトされていた以下のコードは、default のパラメータなので、上記と同じ結果になる </span>
<span class=hljs-comment ># fit_intercept を false にすると、切片を使わない=原点を通る直線でフィットする</span>
<span class=hljs-comment ># model = LinearRegression(fit_intercept = True, normalize = False, copy_X = True,  n_jobs = 1)</span>

<span class=hljs-comment ># fit関数でパラメータ推定</span>
model.fit(data, target)

<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;coef: {}&quot;</span>.<span class=hljs-built_in >format</span>(model.coef_))
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;intercept: {}&quot;</span>.<span class=hljs-built_in >format</span>(model.intercept_))

<span class=hljs-comment ># モデルを使って予測</span>
price = model.predict(sample)[<span class=hljs-number >0</span>]
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;price: {}&quot;</span>.<span class=hljs-built_in >format</span>(price))</code></pre>
<p>coef: &#91;9.10210898&#93;
intercept: -34.670620776438554
price: -25.568511795258246</p>
<pre><code class="python hljs"><span class=hljs-comment ># numpy実装の回帰 (とりあえず 1次元前提の実装)</span>
<span class=hljs-keyword >def</span> <span class="hljs-title function_">train</span>(<span class=hljs-params >xs, ys</span>):
    cov = np.cov(xs, ys, ddof=<span class=hljs-number >0</span>)
    a = cov[<span class=hljs-number >0</span>, <span class=hljs-number >1</span>] / cov[<span class=hljs-number >0</span>, <span class=hljs-number >0</span>]
    b = np.mean(ys) - a * np.mean(xs)
    <span class=hljs-keyword >return</span> cov, a, b

<span class=hljs-keyword >def</span> <span class="hljs-title function_">predict</span>(<span class=hljs-params >x,a,b</span>):
    <span class=hljs-keyword >return</span> a * x + b

_,  a1, b1 = train(data[:,<span class=hljs-number >0</span>], target)

<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;coef: {}&quot;</span>.<span class=hljs-built_in >format</span>(a1))
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;intercept: {}&quot;</span>.<span class=hljs-built_in >format</span>(b1))
price = predict(sample,a1,b1)
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;price: {}&quot;</span>.<span class=hljs-built_in >format</span>(price))</code></pre>
<p>coef: 9.102108981180313
intercept: -34.67062077643858
price: &#91;&#91;-25.5685118&#93;&#93;</p>
<p>どちらの実装でも同等の結果が出ているようだが、価格がマイナスになってしまった。</p>
<h4 id="重回帰分析2変数"><a href="#重回帰分析2変数" class=header-anchor >重回帰分析&#40;2変数&#41;</a></h4>
<pre><code class="python hljs"><span class=hljs-comment ># 説明変数</span>
data2 = df.loc[:, [<span class=hljs-string >&#x27;CRIM&#x27;</span>, <span class=hljs-string >&#x27;RM&#x27;</span>]].values
<span class=hljs-comment ># 目的変数</span>
target2 = df.loc[:, <span class=hljs-string >&#x27;PRICE&#x27;</span>].values

<span class=hljs-comment ># 予測したいケース crim = 0.2, rm=7</span>
sample2 = np.array([[<span class=hljs-number >0.2</span>, <span class=hljs-number >7</span>]])</code></pre>
<pre><code class="python hljs"><span class=hljs-comment ># オブジェクト生成</span>
model2 = LinearRegression()

<span class=hljs-comment ># fit関数でパラメータ推定</span>
model2.fit(data2, target2)

<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;coef: {}&quot;</span>.<span class=hljs-built_in >format</span>(model2.coef_))
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;intercept: {}&quot;</span>.<span class=hljs-built_in >format</span>(model2.intercept_))

<span class=hljs-comment ># モデルを使って予測</span>
price = model2.predict(sample2)[<span class=hljs-number >0</span>]
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;predict: {}&quot;</span>.<span class=hljs-built_in >format</span>(price))</code></pre>
<p>coef: &#91;-0.26491325  8.39106825&#93;
intercept: -29.24471945192992
predict: 29.43977562281461</p>
<pre><code class="python hljs"><span class=hljs-comment ># numpy実装の回帰 (N次元の実装)</span>
<span class=hljs-comment ># 普通に行列で微分すればOK</span>
<span class=hljs-keyword >def</span> <span class="hljs-title function_">train</span>(<span class=hljs-params >xs, ys</span>):
    X = np.concatenate([np.ones((xs.shape[<span class=hljs-number >0</span>],<span class=hljs-number >1</span>), dtype=np.float64),xs],<span class=hljs-number >1</span>)
    w = np.dot( np.linalg.pinv(X), ys)
    <span class=hljs-keyword >return</span> w

<span class=hljs-keyword >def</span> <span class="hljs-title function_">predict</span>(<span class=hljs-params >x, w</span>):
    X = np.concatenate([np.ones((x.shape[<span class=hljs-number >0</span>],<span class=hljs-number >1</span>), dtype=np.float64),x],<span class=hljs-number >1</span>)
    <span class=hljs-keyword >return</span> np.dot(X,w)

w2 = train(data2,target)
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;coef: {}&quot;</span>.<span class=hljs-built_in >format</span>(w2[<span class=hljs-number >1</span>:<span class=hljs-number >3</span>]))
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;intercept: {}&quot;</span>.<span class=hljs-built_in >format</span>(w2[<span class=hljs-number >0</span>]))
price = predict(sample2,w2)
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;price: {}&quot;</span>.<span class=hljs-built_in >format</span>(price))</code></pre>
<p>coef: &#91;-0.26491325  8.39106825&#93;
intercept: -29.24471945192995
price: &#91;29.43977562&#93;</p>
<p>単回帰・重回帰どちらでも、似たような結果が出ているので、モデルの検証は scikit-learnの結果を用いて行うので十分そう</p>
<h4 id="モデルの検証"><a href="#モデルの検証" class=header-anchor >モデルの検証</a></h4>
<p>決定係数の定義は、調べてみると</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><mrow><munder><mo>∑</mo><mi>i</mi></munder><mo stretchy=false >(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover accent=true ><msub><mi>y</mi><mi>i</mi></msub><mo>^</mo></mover><msup><mo stretchy=false >)</mo><mn>2</mn></msup></mrow><mrow><munder><mo>∑</mo><mi>i</mi></munder><mo stretchy=false >(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover accent=true ><mi>y</mi><mo>ˉ</mo></mover><msup><mo stretchy=false >)</mo><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex"> R^2 = 1 - \frac{ \sum_i (y_i- \hat{y_i})^2}{ \sum_i (y_i - \bar{y})^2 } </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8641079999999999em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.72777em;vertical-align:-0.08333em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.489528em;vertical-align:-0.9857100000000001em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.5038179999999999em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mop ><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.16195399999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.56778em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.19444em;"><span class=mord >ˉ</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.19444em;"><span></span></span></span></span></span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.6897100000000003em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mop ><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.16195399999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.69444em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.25em;"><span class=mord >^</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.19444em;"><span></span></span></span></span></span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9857100000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<p>らしい。</p>
<p>第二項目に着目してみると、分子分母をデータ数 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> で割ると　MSEを目的変数自体の分散で正規化したような値になっている。</p>
<pre><code class="python hljs"><span class=hljs-comment ># 決定係数</span>
<span class=hljs-built_in >print</span>(<span class=hljs-string >&#x27;単回帰決定係数: %.3f, 重回帰決定係数 : %.3f&#x27;</span> % (model.score(data,target), model2.score(data2,target2)))</code></pre>
<p>単回帰決定係数: 0.484, 重回帰決定係数 : 0.542</p>
<p>オリジナルのノートブックには、単回帰に関する検証しか行われていないので、重回帰でも行う</p>
<pre><code class="python hljs"><span class=hljs-keyword >def</span> <span class="hljs-title function_">evaluate</span>(<span class=hljs-params >data,target</span>):
    <span class=hljs-keyword >from</span> sklearn.model_selection <span class=hljs-keyword >import</span> train_test_split

    <span class=hljs-comment ># 70%を学習用、30%を検証用データにするよう分割</span>
    X_train, X_test, y_train, y_test = train_test_split(data, target, test_size = <span class=hljs-number >0.3</span>, random_state = <span class=hljs-number >666</span>)

    <span class=hljs-comment ># matplotlibをインポート</span>
    <span class=hljs-keyword >import</span> matplotlib.pyplot <span class=hljs-keyword >as</span> plt
    <span class=hljs-comment ># Jupyterを利用していたら、以下のおまじないを書くとnotebook上に図が表示</span>
    %matplotlib inline

    <span class=hljs-comment ># 学習用データでパラメータ推定</span>
    model.fit(X_train, y_train)
    <span class=hljs-comment ># 作成したモデルから予測（学習用、検証用モデル使用）</span>
    y_train_pred = model.predict(X_train)
    y_test_pred = model.predict(X_test)

    <span class=hljs-comment ># 学習用、検証用それぞれで残差をプロット</span>
    plt.scatter(y_train_pred, y_train_pred - y_train, c = <span class=hljs-string >&#x27;blue&#x27;</span>, marker = <span class=hljs-string >&#x27;o&#x27;</span>, label = <span class=hljs-string >&#x27;Train Data&#x27;</span>)
    plt.scatter(y_test_pred, y_test_pred - y_test, c = <span class=hljs-string >&#x27;lightgreen&#x27;</span>, marker = <span class=hljs-string >&#x27;s&#x27;</span>, label = <span class=hljs-string >&#x27;Test Data&#x27;</span>)
    plt.xlabel(<span class=hljs-string >&#x27;Predicted Values&#x27;</span>)
    plt.ylabel(<span class=hljs-string >&#x27;Residuals&#x27;</span>)
    <span class=hljs-comment ># 凡例を左上に表示</span>
    plt.legend(loc = <span class=hljs-string >&#x27;upper left&#x27;</span>)
    <span class=hljs-comment ># y = 0に直線を引く</span>
    plt.hlines(y = <span class=hljs-number >0</span>, xmin = -<span class=hljs-number >10</span>, xmax = <span class=hljs-number >50</span>, lw = <span class=hljs-number >2</span>, color = <span class=hljs-string >&#x27;red&#x27;</span>)
    plt.xlim([<span class=hljs-number >10</span>, <span class=hljs-number >50</span>])
    plt.ylim([-<span class=hljs-number >40</span>, <span class=hljs-number >40</span>])
    
    plt.show()

    <span class=hljs-comment ># 平均二乗誤差を評価するためのメソッドを呼び出し</span>
    <span class=hljs-keyword >from</span> sklearn.metrics <span class=hljs-keyword >import</span> mean_squared_error
    <span class=hljs-comment ># 学習用、検証用データに関して平均二乗誤差を出力</span>
    <span class=hljs-built_in >print</span>(<span class=hljs-string >&#x27;MSE Train : %.3f, Test : %.3f&#x27;</span> % (mean_squared_error(y_train, y_train_pred), mean_squared_error(y_test, y_test_pred)))
    <span class=hljs-comment ># 学習用、検証用データに関してR^2を出力</span>
    <span class=hljs-built_in >print</span>(<span class=hljs-string >&#x27;R^2 Train : %.3f, Test : %.3f&#x27;</span> % (model.score(X_train, y_train), model.score(X_test, y_test)))</code></pre>
<pre><code class="python hljs"><span class=hljs-comment >## 単回帰の場合</span>
evaluate(data,target)</code></pre>
<p><img src="/assets/skl_regression_files/skl_regression_27_0.svg" alt=svg  /></p>
<p>MSE Train : 44.983, Test : 40.412
R^2 Train : 0.500, Test : 0.434</p>
<pre><code class="python hljs"><span class=hljs-comment >## 重回帰の場合</span>
evaluate(data2,target)</code></pre>
<p><img src="/assets/skl_regression_files/skl_regression_28_0.svg" alt=svg  /></p>
<p>MSE Train : 40.586, Test : 34.377
R^2 Train : 0.549, Test : 0.518</p>
<pre><code class="python hljs"><span class=hljs-comment ># 別の変数でも試してみる</span>
evaluate(df.loc[:, [<span class=hljs-string >&#x27;RM&#x27;</span>,<span class=hljs-string >&#x27;LSTAT&#x27;</span>]].values,target)</code></pre>
<p><img src="/assets/skl_regression_files/skl_regression_29_0.svg" alt=svg  /></p>
<p>MSE Train : 32.228, Test : 26.711
R^2 Train : 0.642, Test : 0.626
<h2 id="非線形回帰"><a href="#非線形回帰" class=header-anchor >非線形回帰 </a></h2>
<h3 id="動画講義メモ要点のまとめ__2"><a href="#動画講義メモ要点のまとめ__2" class=header-anchor >動画講義メモ&#40;要点のまとめ&#41;</a></h3>
<ul>
<li><p>モデルの形</p>
<ul>
<li><p>線形回帰 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mo>∑</mo><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex"> y = \sum w_i x_i </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.00001em;vertical-align:-0.25001em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> で、<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex"> x_i </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> の代わりに 非線形関数 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mi>i</mi></msub><mo stretchy=false >(</mo><mi mathvariant=bold-italic >x</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\phi_i (\bm{x})</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">ϕ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span><span class=mclose >)</span></span></span></span> を使う。</p>
<ul>
<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn><mo separator=true >,</mo><msub><mi>w</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\phi_0 = 1, w_0 =1 </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal">ϕ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span></p>

<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex"> w </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span> については線形 &#40;linear-in-parameter&#41; のまま</p>

<li><p>-&gt; 二乗誤差に対する解としてパラメータは求められるってことね</p>

<li><p>旧動画では、これを基底関数法と呼んでいた</p>

</ul>

</ul>

<li><p>未学習&#40;underfitting&#41;・過学習&#40;overfitting&#41;について</p>
<ul>
<li><p>多項式近似の例:  4次以上はフィッティング具合ほとんどかわらない</p>
<ul>
<li><p>左のグラフ&#40;1,2次ぐらい&#41; -&gt; 未学習</p>

<li><p>真ん中&#40;4次ぐらい&#41; -&gt; 望ましい状態</p>

<li><p>右のグラフ&#40;もっと次数をあげた&#41; -&gt; 過学習</p>

</ul>

<li><p>訓練誤差とテスト誤差を比較することで、判断ができる</p>
<ul>
<li><p>cf. 2018年の DL 論文で、過学習可と思いきや、ずっと学習続けてると、またロスが下がり始める現象が報告されていた&#40;double descent&#41;</p>

</ul>

</ul>

<li><p>過学習の対策</p>
<ol>
<li><p>学習データを増やす</p>

<li><p>不要な基底関数を削除して表現力を抑止 </p>

</ol>
<ul>
<li><p>情報量基準などを使う</p>

<li><p>愚直にやると、組合せ爆発を起こすので大変</p>

</ul>
<ol start=3 >
<li><p>正則化法を利用して表現力を抑止</p>

</ol>
<ul>
<li><p>モデルの複雑さに伴って、その値が大きくなるようなペナルティを関数に課す</p>
<ul>
<li><p>今回の場合は重みパラメータの大きさ</p>
<ul>
<li><p>4次まで誤差を十分小さくできており、7次以上の項による誤差低減効果はほぼない。この状態で、正則化を行えば、7次以上の重みパラネータが小さく抑えられるはず。</p>

</ul>

<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi mathvariant=normal >.</mi><mtext> </mtext><mi>M</mi><mi>S</mi><mi>E</mi><mo>+</mo><mi>λ</mi><mi>R</mi><mo stretchy=false >(</mo><mi mathvariant=bold-italic >w</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> min. \  MSE + \lambda R(\bm{w}) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class=mord >.</span><span class=mspace > </span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">λ</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class=mopen >(</span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=mclose >)</span></span></span></span> を解けば良い。&#40; <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy=false >(</mo><mi mathvariant=bold-italic >w</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">R(\bm{w})</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class=mopen >(</span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=mclose >)</span></span></span></span> が正則化項&#41;</p>
<ul>
<li><p>KKT条件によって、<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi mathvariant=normal >.</mi><mtext> </mtext><mrow><mi mathvariant=normal >M</mi><mi mathvariant=normal >S</mi><mi mathvariant=normal >E</mi></mrow><mtext> </mtext><mi>s</mi><mi mathvariant=normal >.</mi><mi>t</mi><mi mathvariant=normal >.</mi><mtext> </mtext><mi>R</mi><mo stretchy=false >(</mo><mi mathvariant=bold-italic >w</mi><mo stretchy=false >)</mo><mo>≤</mo><mi>r</mi></mrow><annotation encoding="application/x-tex"> min. \ \mathrm{MSE} \ s.t. \ R(\bm{w}) \le r </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class=mord >.</span><span class=mspace > </span><span class=mord ><span class="mord mathrm">M</span><span class="mord mathrm">S</span><span class="mord mathrm">E</span></span><span class=mspace > </span><span class="mord mathnormal">s</span><span class=mord >.</span><span class="mord mathnormal">t</span><span class=mord >.</span><span class=mspace > </span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class=mopen >(</span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> を一つの目的関数の最小化問題に変換</p>
<ul>
<li><p>今回の場合、必ずしも上記不等式制約を満たす必要はない&#40;なるべく小さくすればいいだけ&#41;なので上記の議論で問題ない</p>

<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold-italic >w</mi></mrow><annotation encoding="application/x-tex">\bm{w}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.44444em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span></span></span></span> によらないので目的関数からは削除されてる </p>

</ul>

</ul>

</ul>

<li><p>正則化項の例</p>
<ul>
<li><p>Ridge推定量　- 正則化項 にL2ノルムを使う &#40;パラメータを0に近づける&#41;</p>

<li><p>Lasso推定量  - 正則化項 にL1ノルムを使う &#40;スパース推定&#41; </p>

</ul>

<li><p>正則化項にかかるパラメータは hyper parameter 　</p>

</ul>

<li><p>モデル選択</p>
<ul>
<li><p>評価するときには、学習に使ってないデータ&#40;検証データ&#41;に対する評価値を見る</p>

<li><p>ホールドアウト法</p>
<ul>
<li><p>学習に使うデータと、検証に使うデータを固定する</p>
<ul>
<li><p>大量にデータが手元にあるときはこれをやることがおおい</p>

</ul>

<li><p>注意点 : </p>
<ul>
<li><p>検証用データに &quot;はずれ値&quot;が入ってしまうと、はずれ値にフィットするモデルが選ばれる、ということが起きる</p>

</ul>

</ul>

<li><p>交差検証法 &#40;クロスバリデーション&#41; </p>
<ul>
<li><p>データを学習用と評価用に分割するのだが、その分割の仕方をローテーションする。例えば、5分割したうちの1つが検証、残りが学習、みたいな</p>

<li><p>1つのモデルに対して、 5回の評価が行われる。精度の平均値 CV値で評価する</p>

<li><p>Q&amp;A 精度ってどうやって計算するの? -&gt; 基本的には 学習時のloss をそのまま使う</p>

<li><p>基本的には交差検証法の方の値を報告する</p>

</ul>

</ul>

<li><p>ハイパーパラメータの調整をどうしよう? という話　</p>
<ul>
<li><p>グリッドサーチは 実装の練習はしてもいいと思うけど、実践的にはあまり使わない。</p>

<li><p>ベイズ最適化&#40;BO&#41;が最近だとよく使われる? </p>
<ul>
<li><p>PFN の optunaなど</p>

</ul>

</ul>

</ul>
<h3 id="ハンズオン"><a href="#ハンズオン" class=header-anchor >ハンズオン</a></h3></p>
<pre><code class="python hljs"><span class=hljs-comment ># Local実行のため、Google ドライブのマウントは行わない</span>
<span class=hljs-comment ># from google.colab import drive</span>
<span class=hljs-comment ># drive.mount(&#x27;/content/drive&#x27;)</span></code></pre>
<pre><code class="python hljs"><span class=hljs-keyword >import</span> numpy <span class=hljs-keyword >as</span> np
<span class=hljs-keyword >import</span> matplotlib.pyplot <span class=hljs-keyword >as</span> plt
<span class=hljs-keyword >import</span> seaborn <span class=hljs-keyword >as</span> sns

%matplotlib inline

<span class=hljs-comment >#seaborn設定</span>
sns.<span class=hljs-built_in >set</span>()
<span class=hljs-comment >#背景変更</span>
sns.set_style(<span class=hljs-string >&quot;darkgrid&quot;</span>, {<span class=hljs-string >&#x27;grid.linestyle&#x27;</span>: <span class=hljs-string >&#x27;--&#x27;</span>})
<span class=hljs-comment >#大きさ(スケール変更)</span>
sns.set_context(<span class=hljs-string >&quot;paper&quot;</span>)</code></pre>
<pre><code class="python hljs">n=<span class=hljs-number >100</span>
<span class=hljs-keyword >def</span> <span class="hljs-title function_">true_func</span>(<span class=hljs-params >x</span>):
    z = <span class=hljs-number >1</span>-<span class=hljs-number >48</span>*x+<span class=hljs-number >218</span>*x**<span class=hljs-number >2</span>-<span class=hljs-number >315</span>*x**<span class=hljs-number >3</span>+<span class=hljs-number >145</span>*x**<span class=hljs-number >4</span>
    <span class=hljs-keyword >return</span> z 

<span class=hljs-keyword >def</span> <span class="hljs-title function_">linear_func</span>(<span class=hljs-params >x</span>):
    z = x
    <span class=hljs-keyword >return</span> z</code></pre>
<pre><code class="python hljs"><span class=hljs-comment ># 真の関数からノイズを伴うデータを生成</span>

<span class=hljs-comment ># 真の関数からデータ生成</span>
data = np.random.rand(n).astype(np.float32)
data = np.sort(data)
target = true_func(data)

<span class=hljs-comment ># 　ノイズを加える</span>
noise = <span class=hljs-number >0.5</span> * np.random.randn(n) 
target = target  + noise

<span class=hljs-comment ># ノイズ付きデータを描画</span>
plt.scatter(data, target)
plt.title(<span class=hljs-string >&#x27;NonLinear Regression&#x27;</span>)
<span class=hljs-comment ># plt.legend(loc=2)</span></code></pre>
<p>Text&#40;0.5, 1.0, &#39;NonLinear Regression&#39;&#41;</p>
<p><img src="/assets/skl_nonlinear_regression_files/skl_nonlinear_regression_4_1.svg" alt=svg  /></p>
<p>線形回帰では十分にフィットできない&#40;未学習の状態&#41;。</p>
<pre><code class="python hljs"><span class=hljs-keyword >from</span> sklearn.linear_model <span class=hljs-keyword >import</span> LinearRegression

clf = LinearRegression()
data = data.reshape(-<span class=hljs-number >1</span>,<span class=hljs-number >1</span>)
target = target.reshape(-<span class=hljs-number >1</span>,<span class=hljs-number >1</span>)
clf.fit(data, target)

p_lin = clf.predict(data)

plt.scatter(data, target, label=<span class=hljs-string >&#x27;data&#x27;</span>)
plt.plot(data, p_lin, color=<span class=hljs-string >&#x27;darkorange&#x27;</span>, marker=<span class=hljs-string >&#x27;&#x27;</span>, linestyle=<span class=hljs-string >&#x27;-&#x27;</span>, linewidth=<span class=hljs-number >1</span>, markersize=<span class=hljs-number >6</span>, label=<span class=hljs-string >&#x27;linear regression&#x27;</span>)
plt.legend(loc=<span class=hljs-number >2</span>)
<span class=hljs-built_in >print</span>(clf.score(data, target))</code></pre>
<p>0.40814627626298416</p>
<p><img src="/assets/skl_nonlinear_regression_files/skl_nonlinear_regression_6_1.svg" alt=svg  /></p>
<h4 id="多項式回帰"><a href="#多項式回帰" class=header-anchor >多項式回帰</a></h4>
<p>回帰モデルの形は、</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>w</mi><mi>n</mi></msub><msup><mi>x</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex"> f(x) = \sum_{n=0}^{N-1} w_n x^n </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:3.0954490000000003em;vertical-align:-1.267113em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.8283360000000004em;"><span style="top:-1.882887em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.267113em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>
<p>入力 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> から <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mi>n</mi></msub><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>=</mo><msup><mi>x</mi><mi>n</mi></msup><mo separator=true >,</mo><mi>n</mi><mo>=</mo><mn>0</mn><mo separator=true >,</mo><mn>1</mn><mo separator=true >,</mo><mn>2</mn><mo separator=true >,</mo><mo>…</mo></mrow><annotation encoding="application/x-tex">\phi_n(x) = x^n, n=0,1,2,\ldots</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">ϕ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.858832em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >2</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner >…</span></span></span></span> を計算しこれを <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> 次元ベクトルの説明変数だと思って、重回帰を行えばよい。 動画講義のスライド同様の結果が得られている</p>
<pre><code class="python hljs"><span class=hljs-keyword >from</span> sklearn.preprocessing <span class=hljs-keyword >import</span> PolynomialFeatures
<span class=hljs-keyword >from</span> sklearn.pipeline <span class=hljs-keyword >import</span> Pipeline
deg = [<span class=hljs-number >1</span>,<span class=hljs-number >2</span>,<span class=hljs-number >3</span>,<span class=hljs-number >4</span>,<span class=hljs-number >5</span>,<span class=hljs-number >6</span>,<span class=hljs-number >7</span>,<span class=hljs-number >8</span>,<span class=hljs-number >9</span>,<span class=hljs-number >10</span>]

plt.figure(figsize=(<span class=hljs-number >8</span>,<span class=hljs-number >5</span>))
plt.scatter(data, target, label=<span class=hljs-string >&#x27;data&#x27;</span>)
plt.title(<span class=hljs-string >&quot;polinomial regression&quot;</span>)
<span class=hljs-keyword >for</span> d <span class=hljs-keyword >in</span> deg:
    regr = Pipeline([
        (<span class=hljs-string >&#x27;poly&#x27;</span>, PolynomialFeatures(degree=d)),
        (<span class=hljs-string >&#x27;linear&#x27;</span>, LinearRegression())
    ])
    regr.fit(data, target)
    <span class=hljs-comment ># make predictions</span>
    p_poly = regr.predict(data)
    <span class=hljs-comment ># plot regression result</span>
    plt.plot(data, p_poly, label=<span class=hljs-string >&#x27;degree %d&#x27;</span> % (d))
plt.legend(loc=<span class=hljs-string >&quot;lower right&quot;</span>)</code></pre>
<p>&lt;matplotlib.legend.Legend at 0x7f749c2b7f40&gt;</p>
<p><img src="/assets/skl_nonlinear_regression_files/skl_nonlinear_regression_8_1.svg" alt=svg  /></p>
<h4 id="ガウシアン基底_正則化項"><a href="#ガウシアン基底_正則化項" class=header-anchor >ガウシアン基底 &#43; 正則化項</a></h4>
<p>次はRBFカーネル&#40;ガウシアン基底&#41;を使う。&#40;RBFカーネルにも色々あるらしいが、scikit-learnの関数を追っかけていくとガウシアンだと分かる&#41;</p>
<p>つまり fit 時に与えたデータ <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub><mo separator=true >,</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=true >,</mo><mo>…</mo><mo separator=true >,</mo><msub><mi>x</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex"> x_0, x_1,\ldots, x_{N-1}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.638891em;vertical-align:-0.208331em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner >…</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> に対して、</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>w</mi><mi>i</mi></msub><mi>exp</mi><mo>⁡</mo><mo fence=true >(</mo><mo>−</mo><mi>γ</mi><mo stretchy=false >(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mi>i</mi></msub><msup><mo stretchy=false >)</mo><mn>2</mn></msup><mo fence=true >)</mo></mrow><annotation encoding="application/x-tex">
f(x) =\sum_{i=0}^{N-1} w_i \exp\bigl(-\gamma (x-x_i)^2\bigr) 
</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:3.1060050000000006em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.8283360000000004em;"><span style="top:-1.872331em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.277669em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mop >exp</span><span class=mopen ><span class="delimsizing size1">(</span></span><span class=mord >−</span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.2141179999999998em;vertical-align:-0.35001em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mclose ><span class="delimsizing size1">)</span></span></span></span></span></span>
<p>で回帰を行うということ。</p>
<p>回帰の方式は、Ridge回帰ということで、評価関数は</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>J</mi><mo stretchy=false >(</mo><mi mathvariant=normal >w</mi><mo stretchy=false >)</mo><mo>=</mo><munder><mo>∑</mo><mi>i</mi></munder><mo fence=true >(</mo><mi>y</mi><mo>−</mo><mi>f</mi><mo stretchy=false >(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=false >)</mo><msup><mo fence=true >)</mo><mn>2</mn></msup><mo>+</mo><mi>α</mi><munder><mo>∑</mo><mi>i</mi></munder><msubsup><mi>w</mi><mi>i</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex"> J(\mathrm{w}) = \sum_i \bigl( y - f(x_i) \bigr)^2 + \alpha \sum_i w_i^2  </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class=mopen >(</span><span class=mord ><span class="mord mathrm" style="margin-right:0.01389em;">w</span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.327674em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0500050000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.277669em;"><span></span></span></span></span></span><span class=mopen ><span class="delimsizing size1">(</span></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.404018em;vertical-align:-0.35001em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class=mclose ><span class=mclose ><span class="delimsizing size1">)</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:1.054008em;"><span style="top:-3.3029em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.327674em;vertical-align:-1.277669em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0500050000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.277669em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span>
<p>となる。</p>
<p>まずは、sklearn の KernelRidge を使った簡単な実装で、</p>
<ul>
<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\gamma=1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> &#40;デフォルト値&#41;</p>

<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>l</mi><mi>p</mi><mi>h</mi><mi>a</mi><mo>=</mo><mn>0.0002</mn></mrow><annotation encoding="application/x-tex">alpha=0.0002</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span><span class=mord >.</span><span class=mord >0</span><span class=mord >0</span><span class=mord >0</span><span class=mord >2</span></span></span></span></p>

</ul>
<p>の場合。</p>
<pre><code class="python hljs"><span class=hljs-keyword >from</span> sklearn.kernel_ridge <span class=hljs-keyword >import</span> KernelRidge

clf = KernelRidge(alpha=<span class=hljs-number >0.0002</span>, kernel=<span class=hljs-string >&#x27;rbf&#x27;</span>)
clf.fit(data, target)
p_kridge = clf.predict(data)</code></pre>
<p>rbf_kernel&#40;&#41; 関数によって、<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >X</mi><mo>→</mo><mi mathvariant=normal >Φ</mi><mo stretchy=false >(</mo><mi mathvariant=normal >X</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> \mathrm{X} \rightarrow \Phi(\mathrm{X})</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord ><span class="mord mathrm">X</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >→</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >Φ</span><span class=mopen >(</span><span class=mord ><span class="mord mathrm">X</span></span><span class=mclose >)</span></span></span></span> の変換ができるので、多項式回帰と同様に 線形回帰との組み合わせで実装することもできる。 以下は、</p>
<ul>
<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>30</mn></mrow><annotation encoding="application/x-tex">\alpha=30</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >3</span><span class=mord >0</span></span></span></span> </p>

<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>=</mo><mn>50</mn></mrow><annotation encoding="application/x-tex">\gamma=50</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >5</span><span class=mord >0</span></span></span></span></p>

</ul>
<p>の場合。はじめのモデルと比べてペナルティを強くかけている分、係数が0に集まっていることが分かる</p>
<pre><code class="python hljs"><span class=hljs-keyword >from</span> sklearn.metrics.pairwise <span class=hljs-keyword >import</span> rbf_kernel
<span class=hljs-keyword >from</span> sklearn.linear_model <span class=hljs-keyword >import</span> Ridge

<span class=hljs-comment ># 学習</span>
kx = rbf_kernel(X=data, Y=data, gamma=<span class=hljs-number >50</span>)
clf2 = Ridge(alpha=<span class=hljs-number >30</span>)
clf2.fit(kx, target)
p_ridge = clf2.predict(kx)

<span class=hljs-comment ># plot　</span>
plt.scatter(data, target,label=<span class=hljs-string >&#x27;data&#x27;</span>)
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-built_in >len</span>(kx)):
    <span class=hljs-keyword >if</span> i == <span class=hljs-number >0</span>:
        plt.plot(data, kx[i], color=<span class=hljs-string >&#x27;black&#x27;</span>, linestyle=<span class=hljs-string >&#x27;-&#x27;</span>, linewidth=<span class=hljs-number >1</span>, markersize=<span class=hljs-number >3</span>, label=<span class=hljs-string >&#x27;rbf kernels for each data&#x27;</span>, alpha=<span class=hljs-number >0.2</span>)
    <span class=hljs-keyword >else</span>:
        plt.plot(data, kx[i], color=<span class=hljs-string >&#x27;black&#x27;</span>, linestyle=<span class=hljs-string >&#x27;-&#x27;</span>, linewidth=<span class=hljs-number >1</span>, markersize=<span class=hljs-number >3</span>, alpha=<span class=hljs-number >0.2</span>)

plt.plot(data, p_ridge, color=<span class=hljs-string >&#x27;green&#x27;</span>, linestyle=<span class=hljs-string >&#x27;-&#x27;</span>, linewidth=<span class=hljs-number >1</span>, markersize=<span class=hljs-number >3</span>,label=<span class=hljs-string >&#x27;ridge regression #2 (alpha=30,gamma=50)&#x27;</span>)
plt.plot(data, p_kridge, color=<span class=hljs-string >&#x27;orange&#x27;</span>, linestyle=<span class=hljs-string >&#x27;-&#x27;</span>, linewidth=<span class=hljs-number >1</span>, markersize=<span class=hljs-number >3</span>,label=<span class=hljs-string >&#x27;ridge regression #1 (alpha=0.0002,gamma=1)&#x27;</span>)
plt.legend()
plt.show()
<span class=hljs-comment ># score</span>
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;ridge regression #1 : %f&quot;</span> % (clf.score(data,target)))
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;ridge regression #2 : %f&quot;</span> % (clf2.score(kx, target)))

<span class=hljs-comment ># weight coeff histogram</span>

plt.hist([clf.dual_coef_[:,<span class=hljs-number >0</span>], clf2.coef_[<span class=hljs-number >0</span>,:]],label=[<span class=hljs-string >&#x27;ridge regression 1&#x27;</span>,<span class=hljs-string >&#x27;ridge regression 2&#x27;</span>], bins=<span class=hljs-number >10</span>)
plt.title(<span class=hljs-string >&quot;coef. histgram&quot;</span>)
plt.legend()</code></pre>
<p><img src="/assets/skl_nonlinear_regression_files/skl_nonlinear_regression_12_0.svg" alt=svg  /></p>
<p>ridge regression #1 : 0.857598
ridge regression #2 : 0.836881





&lt;matplotlib.legend.Legend at 0x7f7497a3d190&gt;</p>
<p><img src="/assets/skl_nonlinear_regression_files/skl_nonlinear_regression_12_3.svg" alt=svg  /></p>
<p>つぎに Lasso 回帰の効果を確認する。ハンズオンに最初から入力されていた <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>l</mi><mi>p</mi><mi>h</mi><mi>a</mi><mo>=</mo><mn>10000</mn></mrow><annotation encoding="application/x-tex">alpha=10000</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span><span class=mord >0</span><span class=mord >0</span><span class=mord >0</span><span class=mord >0</span></span></span></span> はペナルティが強すぎてほとんど、誤差が減らない。 トライアル&amp;エラーで <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>l</mi><mi>p</mi><mi>h</mi><mi>a</mi><mo>=</mo><mn>0.002</mn></mrow><annotation encoding="application/x-tex">alpha=0.002</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span><span class=mord >.</span><span class=mord >0</span><span class=mord >0</span><span class=mord >2</span></span></span></span> がそれなりに fit することを見つけた。</p>
<p>実際に学習された係数を確認してみると、100のうち 4つの重みのみが非ゼロとなった。スパース推定ができていそう。</p>
<pre><code class="python hljs"><span class=hljs-comment >#Lasso</span>
<span class=hljs-keyword >from</span> sklearn.metrics.pairwise <span class=hljs-keyword >import</span> rbf_kernel
<span class=hljs-keyword >from</span> sklearn.linear_model <span class=hljs-keyword >import</span> Lasso

kx = rbf_kernel(X=data, Y=data, gamma=<span class=hljs-number >5</span>)

lasso_clf = Lasso(alpha=<span class=hljs-number >0.002</span>, max_iter=<span class=hljs-number >50000</span>)
lasso_clf.fit(kx, target)
p_lasso = lasso_clf.predict(kx)

lasso_clf2 = Lasso(alpha=<span class=hljs-number >10000</span>, max_iter=<span class=hljs-number >50000</span>)
lasso_clf2.fit(kx, target)
p_lasso2 = lasso_clf2.predict(kx)

<span class=hljs-comment ># plot</span>
plt.scatter(data, target)
plt.plot(data, p_lasso, label=<span class=hljs-string >&quot;alpha=0.002&quot;</span>)
plt.plot(data, p_lasso2,label=<span class=hljs-string >&quot;alpha=10000&quot;</span>)
plt.title(<span class=hljs-string >&quot;Lasso Regression&quot;</span>)
plt.legend()
plt.show()

<span class=hljs-comment ># score</span>
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;alpha=0.002 :%f&quot;</span> % (lasso_clf.score(kx, target)))
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;alpha=10000 :%f&quot;</span> % (lasso_clf2.score(kx, target)))

<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;weight for the model with alpha=0.002&quot;</span>)
<span class=hljs-built_in >print</span>(lasso_clf.coef_)</code></pre>
<p><img src="/assets/skl_nonlinear_regression_files/skl_nonlinear_regression_14_0.svg" alt=svg  /></p>
<pre><code class="julia hljs">alpha=<span class=hljs-number >0.002</span> :<span class=hljs-number >0.848822</span>
    alpha=<span class=hljs-number >10000</span> :-<span class=hljs-number >0.000000</span>
    weight <span class=hljs-keyword >for</span> the model with alpha=<span class=hljs-number >0.002</span>
    [-<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>
     -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >2.4409611</span>
     -<span class=hljs-number >7.19585</span>    -<span class=hljs-number >1.6620084</span>  -<span class=hljs-number >4.9211154</span>  -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>
     -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>
     -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>
     -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>
     -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>
     -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>          <span class=hljs-number >0.</span>
      <span class=hljs-number >0.</span>          <span class=hljs-number >0.</span>          <span class=hljs-number >0.</span>          <span class=hljs-number >0.</span>          <span class=hljs-number >0.</span>          <span class=hljs-number >0.</span>
      <span class=hljs-number >0.</span>          <span class=hljs-number >0.</span>          <span class=hljs-number >0.</span>          <span class=hljs-number >0.</span>          <span class=hljs-number >0.</span>          <span class=hljs-number >0.</span>
      <span class=hljs-number >0.</span>          <span class=hljs-number >0.</span>          <span class=hljs-number >0.</span>          <span class=hljs-number >0.</span>          <span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>
     -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>
     -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>
     -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>
     -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>
     -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>         -<span class=hljs-number >7.282311</span>
     -<span class=hljs-number >6.780508</span>   -<span class=hljs-number >0.03432941</span> -<span class=hljs-number >0.</span>         -<span class=hljs-number >0.</span>        ]</code></pre>
<h4 id="サポートベクトル回帰svr"><a href="#サポートベクトル回帰svr" class=header-anchor >サポートベクトル回帰&#40;SVR&#41;</a></h4>
<p>名前だけ見ると、これは後に学習する サポートベクトルマシンを回帰問題に応用したもの？ <a href="https://datachemeng.com/supportvectorregression/">調べてみると</a></p>
<ul>
<li><p>モデル <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span></span> は基底関数法と同じ</p>

<li><p>L2ノルムをペナルティにもつ</p>

<li><p>誤差関数が二乗誤差和でなく <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>max</mi><mo>⁡</mo><mo stretchy=false >(</mo><mn>0</mn><mo separator=true >,</mo><mi mathvariant=normal >∣</mi><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>−</mo><mi>y</mi><mi mathvariant=normal >∣</mi><mo>−</mo><mi>ϵ</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\max(0, |f(x) - y|-\epsilon)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mop >max</span><span class=mopen >(</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mord >∣</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϵ</span><span class=mclose >)</span></span></span></span>  </p>

</ul>
<p>らしい。ハンズオンに元々入力されていた <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>a</mi><mi>m</mi><mi>m</mi><mi>a</mi><mo>=</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">gamma=0.1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">a</span><span class="mord mathnormal">m</span><span class="mord mathnormal">m</span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span><span class=mord >.</span><span class=mord >1</span></span></span></span> ではうまくフィットしなかったため、 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>a</mi><mi>m</mi><mi>m</mi><mi>a</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">gamma=1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">a</span><span class="mord mathnormal">m</span><span class="mord mathnormal">m</span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span>で学習。 </p>
<pre><code class="python hljs"><span class=hljs-keyword >from</span> sklearn <span class=hljs-keyword >import</span> model_selection, preprocessing, linear_model, svm

<span class=hljs-comment ># SVR-rbf</span>
clf_svr = svm.SVR(kernel=<span class=hljs-string >&#x27;rbf&#x27;</span>, C=<span class=hljs-number >1e3</span>, gamma=<span class=hljs-number >1</span>, epsilon=<span class=hljs-number >0.1</span>)
clf_svr.fit(data, target[:,<span class=hljs-number >0</span>])
y_rbf = clf_svr.fit(data, target[:,<span class=hljs-number >0</span>]).predict(data)

clf_svr2 = svm.SVR(kernel=<span class=hljs-string >&#x27;rbf&#x27;</span>, C=<span class=hljs-number >1e3</span>, gamma=<span class=hljs-number >0.1</span>, epsilon=<span class=hljs-number >0.1</span>)
clf_svr2.fit(data, target[:,<span class=hljs-number >0</span>])
y_rbf2 = clf_svr2.fit(data, target[:,<span class=hljs-number >0</span>]).predict(data)


<span class=hljs-comment ># plot</span>
plt.scatter(data, target, color=<span class=hljs-string >&#x27;darkorange&#x27;</span>, label=<span class=hljs-string >&#x27;data&#x27;</span>)
plt.title(<span class=hljs-string >&quot;Support Vector Regression (RBF)&quot;</span>)
plt.plot(data, y_rbf, label=<span class=hljs-string >&#x27;gamma=1&#x27;</span>)
plt.plot(data, y_rbf2, label=<span class=hljs-string >&#x27;gamma=0.1&#x27;</span>)

plt.legend()
plt.show()</code></pre>
<p><img src="/assets/skl_nonlinear_regression_files/skl_nonlinear_regression_16_0.svg" alt=svg  /></p>
<h4 id="多層パーセプトロンによる回帰"><a href="#多層パーセプトロンによる回帰" class=header-anchor >多層パーセプトロンによる回帰</a></h4>
<p>Kerasによる回帰の例も示されている。が、これはきっと Stage3移行で改めて勉強するので、実行して結果を確認する程度にする</p>
<pre><code class="python hljs"><span class=hljs-keyword >from</span> sklearn.model_selection <span class=hljs-keyword >import</span> train_test_split
x_train, x_test, y_train, y_test = train_test_split(data, target, test_size=<span class=hljs-number >0.1</span>, random_state=<span class=hljs-number >0</span>)</code></pre>
<pre><code class="python hljs">!mkdir -p ./out/checkpoints 
!mkdir -p ./out/tensorBoard</code></pre>
<pre><code class="python hljs"><span class=hljs-keyword >from</span> keras.callbacks <span class=hljs-keyword >import</span> EarlyStopping, TensorBoard, ModelCheckpoint

cb_cp = ModelCheckpoint(<span class=hljs-string >&#x27;./out/checkpoints/weights.{epoch:02d}-{val_loss:.2f}.hdf5&#x27;</span>, verbose=<span class=hljs-number >1</span>, save_weights_only=<span class=hljs-literal >True</span>)
cb_tf  = TensorBoard(log_dir=<span class=hljs-string >&#x27;./out/tensorBoard&#x27;</span>, histogram_freq=<span class=hljs-number >0</span>)</code></pre>
<pre><code class="python hljs"><span class=hljs-keyword >def</span> <span class="hljs-title function_">relu_reg_model</span>():
    model = Sequential()
    model.add(Dense(<span class=hljs-number >10</span>, input_dim=<span class=hljs-number >1</span>, activation=<span class=hljs-string >&#x27;relu&#x27;</span>))
    model.add(Dense(<span class=hljs-number >1000</span>, activation=<span class=hljs-string >&#x27;relu&#x27;</span>))
    model.add(Dense(<span class=hljs-number >1000</span>, activation=<span class=hljs-string >&#x27;relu&#x27;</span>))
    model.add(Dense(<span class=hljs-number >1000</span>, activation=<span class=hljs-string >&#x27;relu&#x27;</span>))
    model.add(Dense(<span class=hljs-number >1000</span>, activation=<span class=hljs-string >&#x27;relu&#x27;</span>))
    model.add(Dense(<span class=hljs-number >1000</span>, activation=<span class=hljs-string >&#x27;relu&#x27;</span>))
    model.add(Dense(<span class=hljs-number >1000</span>, activation=<span class=hljs-string >&#x27;relu&#x27;</span>))
    model.add(Dense(<span class=hljs-number >1000</span>, activation=<span class=hljs-string >&#x27;relu&#x27;</span>))
    model.add(Dense(<span class=hljs-number >1000</span>, activation=<span class=hljs-string >&#x27;linear&#x27;</span>))
<span class=hljs-comment >#     model.add(Dense(100, activation=&#x27;relu&#x27;))</span>
<span class=hljs-comment >#     model.add(Dense(100, activation=&#x27;relu&#x27;))</span>
<span class=hljs-comment >#     model.add(Dense(100, activation=&#x27;relu&#x27;))</span>
<span class=hljs-comment >#     model.add(Dense(100, activation=&#x27;relu&#x27;))</span>
    model.add(Dense(<span class=hljs-number >1</span>))

    model.<span class=hljs-built_in >compile</span>(loss=<span class=hljs-string >&#x27;mean_squared_error&#x27;</span>, optimizer=<span class=hljs-string >&#x27;adam&#x27;</span>)
    <span class=hljs-keyword >return</span> model</code></pre>
<pre><code class="python hljs"><span class=hljs-keyword >from</span> keras.models <span class=hljs-keyword >import</span> Sequential
<span class=hljs-keyword >from</span> keras.layers <span class=hljs-keyword >import</span> Input, Dense, Dropout, BatchNormalization
<span class=hljs-keyword >from</span> keras.wrappers.scikit_learn <span class=hljs-keyword >import</span> KerasRegressor

<span class=hljs-comment ># use data split and fit to run the model</span>
estimator = KerasRegressor(build_fn=relu_reg_model, epochs=<span class=hljs-number >100</span>, batch_size=<span class=hljs-number >5</span>, verbose=<span class=hljs-number >1</span>)

history = estimator.fit(x_train, y_train, callbacks=[cb_cp, cb_tf], validation_data=(x_test, y_test))</code></pre>
<p>出力は抜粋&#40;本当は1エポック毎出力されているのだが&#41;</p>
<pre><code class="julia hljs">Epoch <span class=hljs-number >1</span>/<span class=hljs-number >100</span>
    <span class=hljs-number >18</span>/<span class=hljs-number >18</span> [==============================] - <span class=hljs-number >1</span>s <span class=hljs-number >25</span>ms/step - loss: <span class=hljs-number >1.6244</span> - val_loss: <span class=hljs-number >1.5469</span>

    ...

    Epoch <span class=hljs-number >00009</span>: saving model to ./out/checkpoints/weights<span class=hljs-number >.09</span>-<span class=hljs-number >1.04</span>.hdf5
    Epoch <span class=hljs-number >10</span>/<span class=hljs-number >100</span>
    <span class=hljs-number >18</span>/<span class=hljs-number >18</span> [==============================] - <span class=hljs-number >0</span>s <span class=hljs-number >11</span>ms/step - loss: <span class=hljs-number >1.0322</span> - val_loss: <span class=hljs-number >0.8556</span>
    
    ...
    
    Epoch <span class=hljs-number >00049</span>: saving model to ./out/checkpoints/weights<span class=hljs-number >.49</span>-<span class=hljs-number >0.47</span>.hdf5
    Epoch <span class=hljs-number >50</span>/<span class=hljs-number >100</span>
    <span class=hljs-number >18</span>/<span class=hljs-number >18</span> [==============================] - <span class=hljs-number >0</span>s <span class=hljs-number >11</span>ms/step - loss: <span class=hljs-number >0.3095</span> - val_loss: <span class=hljs-number >0.4469</span>

    ...

    Epoch <span class=hljs-number >00099</span>: saving model to ./out/checkpoints/weights<span class=hljs-number >.99</span>-<span class=hljs-number >0.49</span>.hdf5
    Epoch <span class=hljs-number >100</span>/<span class=hljs-number >100</span>
    <span class=hljs-number >18</span>/<span class=hljs-number >18</span> [==============================] - <span class=hljs-number >0</span>s <span class=hljs-number >12</span>ms/step - loss: <span class=hljs-number >0.2995</span> - val_loss: <span class=hljs-number >0.3197</span>
    
    Epoch <span class=hljs-number >00100</span>: saving model to ./out/checkpoints/weights<span class=hljs-number >.100</span>-<span class=hljs-number >0.32</span>.hdf5</code></pre>
<pre><code class="python hljs">y_pred = estimator.predict(x_train)</code></pre>
<p>18/18 &#91;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#93; - 0s 3ms/step</p>
<pre><code class="python hljs">plt.title(<span class=hljs-string >&#x27;NonLiner Regressions via DL by ReLU&#x27;</span>)
plt.plot(data, target, <span class=hljs-string >&#x27;o&#x27;</span>)
plt.plot(data, true_func(data), <span class=hljs-string >&#x27;.&#x27;</span>)
plt.plot(x_train, y_pred, <span class=hljs-string >&quot;o&quot;</span>, label=<span class=hljs-string >&#x27;predicted: deep learning&#x27;</span>)
<span class=hljs-comment >#plt.legend(loc=2)</span></code></pre>
<p>&#91;&lt;matplotlib.lines.Line2D at 0x7f746052cf70&gt;&#93;</p>
<p><img src="/assets/skl_nonlinear_regression_files/skl_nonlinear_regression_24_1.svg" alt=svg  /></p>
<pre><code class="python hljs">plt.figure(figsize=(<span class=hljs-number >8</span>,<span class=hljs-number >5</span>))
plt.title(<span class=hljs-string >&#x27;compare all regression models&#x27;</span>)
x=np.linspace(<span class=hljs-number >0</span>,<span class=hljs-number >1</span>,num=<span class=hljs-number >100</span>)
plt.plot(x, true_func(x),label=<span class=hljs-string >&quot;true function&quot;</span>)

plt.plot(x_train, y_pred, <span class=hljs-string >&quot;o&quot;</span>, label=<span class=hljs-string >&#x27;DL&#x27;</span>)
plt.plot(data, y_rbf ,label=<span class=hljs-string >&quot;SVR(RBF)&quot;</span>)
plt.plot(data, p_lasso ,label=<span class=hljs-string >&quot;Lasso(RBF)&quot;</span>)
plt.plot(data, p_kridge ,label=<span class=hljs-string >&quot;Ridge(RBF)&quot;</span>)
plt.legend(loc=<span class=hljs-number >2</span>)
plt.show()

<span class=hljs-comment >#plt.plot(data, clf ,label=&quot;Polinomial&quot;)</span>


<span class=hljs-comment >#plt.legend(loc=2)</span></code></pre>
<p><img src="/assets/skl_nonlinear_regression_files/skl_nonlinear_regression_25_0.svg" alt=svg  /></p>
<p>
<h2 id="ロジスティック回帰"><a href="#ロジスティック回帰" class=header-anchor >ロジスティック回帰</a></h2>
<h3 id="動画講義メモ要点のまとめ__3"><a href="#動画講義メモ要点のまとめ__3" class=header-anchor >動画講義メモ&#40;要点のまとめ&#41;</a></h3>
<ul>
<li><p>参考: google AI blog の記事</p>
<ul>
<li><p>DNNじゃなくてあえてlogistic 回帰使いました</p>

<li><p><a href="https://ai.googleblog.com/2017/02/using-machine-learning-to-predict.html">using ML to Predict Parking Difficulty &#40;2017年 2月&#41;</a></p>

</ul>

</ul>
<ul>
<li><p>分類問題に対するアプローチ</p>
<ol>
<li><p>識別的アプローチ</p>

</ol>
<ul>
<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><msub><mi>C</mi><mi>k</mi></msub><mi mathvariant=normal >∣</mi><mi>x</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> p(C_k | x ) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord >∣</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span></span> を直接モデル化する方法</p>
<ul>
<li><p>logistic 回帰は、これ。</p>

</ul>

<li><p>識別関数をつかう方法</p>
<ul>
<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">f(x) &gt;  0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&gt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> なら <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">C = 1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">f(x) &lt; 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> なら <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">C = 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> みたいな</p>

<li><p>SVMはこれ</p>

</ul>

</ul>
<ol start=2 >
<li><p>生成的アプローチ</p>

</ol>
<ul>
<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><msub><mi>C</mi><mi>k</mi></msub><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> p(C_k) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span> と <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy=false >(</mo><mi>x</mi><mi mathvariant=normal >∣</mi><msub><mi>C</mi><mi>k</mi></msub><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> P(x|C_k)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mord >∣</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span> を model化して、その後 Bayesの定理を用いて、<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><msub><mi>C</mi><mi>k</mi></msub><mi mathvariant=normal >∣</mi><mi>x</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> p(C_k | x ) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord >∣</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span></span> を求める</p>
<ul>
<li><p>ハズレ値の検出をもとめたり、生成モデルをつくれたりする</p>

</ul>

<li><p>ロジスティック回帰での使い方</p>
<ul>
<li><p>一般に実数全体をとり得る入力の線形結合に sigmoid 関数をかけて値域を0~1にすることで確率とみなせるようにしている</p>

<li><p>確率が0.5以上ならば、1, 未満なら、0と予測</p>

</ul>

<li><p>なんでわざわざ確率にする? -&gt; 判断の保留などが可能</p>
<ul>
<li><p>識別関数だと、識別結果をそのまま使用するしかない</p>

</ul>

</ul>

<li><p>最尤推定: ベルヌーイ分布のパラメータ推定</p>
<ul>
<li><p>データ-&gt; ベールヌーイ分布の計算</p>
<ul>
<li><p>1回の試行 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy=false >(</mo><mi>y</mi><mo stretchy=false >)</mo><mo>=</mo><msup><mi>p</mi><mi>y</mi></msup><mo stretchy=false >(</mo><mn>1</mn><mo>−</mo><mi>p</mi><msup><mo stretchy=false >)</mo><mrow><mn>1</mn><mo>−</mo><mi>y</mi></mrow></msup></mrow><annotation encoding="application/x-tex"> P(y) = p^y (1-p)^{1-y} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">p</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span></span></span></span></span></p>

<li><p>n回の試行で、<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo separator=true >,</mo><mi mathvariant=normal >.</mi><mi mathvariant=normal >.</mi><mo separator=true >,</mo><msub><mi>y</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">y_1,..,y_n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >.</span><span class=mord >.</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> が同時に起こる確率 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy=false >(</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator=true >,</mo><mi mathvariant=normal >.</mi><mi mathvariant=normal >.</mi><mo separator=true >,</mo><msub><mi>y</mi><mi>n</mi></msub><mo separator=true >;</mo><mi>p</mi><mo stretchy=false >)</mo><mo>=</mo><msubsup><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>i</mi><mo>=</mo><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msubsup><msup><mi>p</mi><msub><mi>y</mi><mi>i</mi></msub></msup><mo stretchy=false >(</mo><mn>1</mn><mo>−</mo><mi>p</mi><msup><mo stretchy=false >)</mo><mrow><mn>1</mn><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex">P(y_1,..,y_n;p)=  \prod_{i=0}^{i=n-1} p^{y_i} (1-p)^{1-y_i} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >.</span><span class=mord >.</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >;</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.264274em;vertical-align:-0.29971000000000003em;"></span><span class=mop ><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∏</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.964564em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">p</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>

</ul>

<li><p>パラメータである p を データ <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo separator=true >,</mo><mi mathvariant=normal >.</mi><mi mathvariant=normal >.</mi><mo separator=true >,</mo><msub><mi>y</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">y_1,..,y_n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >.</span><span class=mord >.</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> から推定したい。</p>
<ul>
<li><p>pを色々変えて、<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo separator=true >,</mo><mi mathvariant=normal >.</mi><mi mathvariant=normal >.</mi><mo separator=true >,</mo><msub><mi>y</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">y_1,..,y_n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >.</span><span class=mord >.</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> が得られる確率が最大になるような <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span> を求める-&gt;最尤推定</p>

</ul>

<li><p>ロジスティク回帰モデルの最尤推定</p>
<ul>
<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy=false >(</mo><mi>Y</mi><mo>=</mo><msub><mi>y</mi><mn>1</mn></msub><mi mathvariant=normal >∣</mi><msub><mi mathvariant=bold-italic >x</mi><mn>1</mn></msub><mo stretchy=false >)</mo><mo>=</mo><msubsup><mi>p</mi><mn>1</mn><msub><mi>y</mi><mn>1</mn></msub></msubsup><mo stretchy=false >(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mn>1</mn></msub><msup><mo stretchy=false >)</mo><mrow><mn>1</mn><mo>−</mo><msub><mi>y</mi><mn>1</mn></msub></mrow></msup></mrow><annotation encoding="application/x-tex">P(Y=y_1 | \bm{x}_1 ) =p_1^{y_1} (1-p_1)^{1-y_1} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord >∣</span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.048608em;vertical-align:-0.266308em;"></span><span class=mord ><span class="mord mathnormal">p</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.7823em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.1809080000000005em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.266308em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.064108em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">p</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li><p>確率はロジスティック回帰 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>=</mo><mi>σ</mi><mo stretchy=false >(</mo><msup><mi mathvariant=bold-italic >w</mi><mi>T</mi></msup><msub><mi mathvariant=bold-italic >x</mi><mn>1</mn></msub><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> p_1 = \sigma(\bm{w}^T \bm{x}_1)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal">p</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class=mopen >(</span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span> で計算できるので、尤度が最大になる <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold-italic >w</mi></mrow><annotation encoding="application/x-tex"> \bm{w} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.44444em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span></span></span></span> を探す問題</p>

</ul>

</ul>

</ul>

<li><p>更新式の導出: ひたすら微分。もう何度もやったのでここでは省略. </p>
<ul>
<li><p>対数尤度を使う理由</p>
<ul>
<li><p>微分の計算が簡単ってのは、正直どうでもいい &#40;それならそう書かないでくれ&#41;</p>

<li><p>尤度 : 確率を何度も掛け算する -&gt; 桁落ちの可能性</p>

</ul>

<li><p>微分のchane ルールを理解して使いこなすことが重要</p>

</ul>

<li><p>確率的勾配法</p>
<ul>
<li><p>Iteration によってデータを入れ替えることで、パラメータ更新の勾配方向をある程度不規則にして、初期値依存制を低減する効果を狙う</p>

<li><p>ただし、ロジスティック回帰なら単峰制なので局所最適に陥る心配はないのだが</p>

<li><p><a href="http://ibis.t.u-tokyo.ac.jp/suzuki/lecture/2018/kyoto/Kyoto_02.pdf">p.70 の参考文献</a></p>
<ul>
<li><p>層を深くすること近似できる関数の自由度がどう増えていくか? とか興味深いがそもそも、どんな意図で貼られているんだろう?</p>

</ul>

</ul>

<li><p>モデルの評価</p>
<ul>
<li><p>混合行列でマトリックスを使って整理.</p>
<ul>
<li><p>行 &#61; モデルの予測結果の Positive/Negative</p>

<li><p>列 &#61; 検証データの Positive/Negative </p>

<li><p>対角成分が 正解&#40;True&#41;, 非対角成分が不正解&#40;False&#41;となる</p>

</ul>

<li><p>FalsePotsitve と FalseNegativeとを分けて評価する</p>
<ul>
<li><p>Link: http://ibisforest.org/index.php?F&#37;E5&#37;80&#37;A4</p>

<li><p>検証データ中の Posi/Nega のバランスが取れてないとき何をみてるかわからなくなる</p>
<ul>
<li><p>間違い方によって何が嫌かが違う</p>

</ul>

<li><p>再現率&#40;Recall&#41;: Positiveデータに対する正答率 &#61; TP/&#40;TP&#43;FN&#41;</p>
<ul>
<li><p>過剰検出を許容して、ヌケモレのなさを重視する評価</p>

</ul>

<li><p>適合率&#40;Precision&#41;: モデルがPositiveと予測したものに対する正答率 &#61; TP/&#40;TP&#43;FP&#41;</p>
<ul>
<li><p>見逃しを許容して、慎重な検出を評価する</p>

</ul>

<li><p>F値 : Recall と Precision の調和平均</p>
<ul>
<li><p>どっちにも振れない微妙なタスクにつかう?</p>

</ul>

<li><p>現場でよくやるのは、上記3つ全部並べておくこと </p>

</ul>

</ul>

</ul>
<h3 id="ハンズオン__2"><a href="#ハンズオン__2" class=header-anchor >ハンズオン</a></h3></p>
<h4 id="データ読み込み_前処理"><a href="#データ読み込み_前処理" class=header-anchor >データ読み込み &amp; 前処理</a></h4>
<pre><code class="python hljs"><span class=hljs-comment ># from google.colab import drive</span>
<span class=hljs-comment ># drive.mount(&#x27;/content/drive&#x27;)</span></code></pre>
<pre><code class="python hljs"><span class=hljs-comment >#from モジュール名 import クラス名（もしくは関数名や変数名）</span>
<span class=hljs-keyword >import</span> pandas <span class=hljs-keyword >as</span> pd
<span class=hljs-keyword >from</span> pandas <span class=hljs-keyword >import</span> DataFrame
<span class=hljs-keyword >import</span> numpy <span class=hljs-keyword >as</span> np
<span class=hljs-keyword >import</span> matplotlib.pyplot <span class=hljs-keyword >as</span> plt
<span class=hljs-keyword >import</span> seaborn <span class=hljs-keyword >as</span> sns

<span class=hljs-comment >#matplotlibをinlineで表示するためのおまじない (plt.show()しなくていい)</span>
%matplotlib inline</code></pre>
<pre><code class="python hljs"><span class=hljs-comment ># titanic data csvファイルの読み込み</span>
titanic_df = pd.read_csv(<span class=hljs-string >&#x27;../data/titanic_train.csv&#x27;</span>)

<span class=hljs-comment ># ファイルの先頭部を表示し、データセットを確認する</span>
titanic_df.head(<span class=hljs-number >5</span>)</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border=1  class=dataframe >
  <thead>
    <tr style="text-align: right;">
      <th>
      <th>PassengerId
      <th>Survived
      <th>Pclass
      <th>Name
      <th>Sex
      <th>Age
      <th>SibSp
      <th>Parch
      <th>Ticket
      <th>Fare
      <th>Cabin
      <th>Embarked
    
  
  
    <tr>
      <th>0
      <td>1
      <td>0
      <td>3
      <td>Braund, Mr. Owen Harris
      <td>male
      <td>22.0
      <td>1
      <td>0
      <td>A/5 21171
      <td>7.2500
      <td>NaN
      <td>S
    
    <tr>
      <th>1
      <td>2
      <td>1
      <td>1
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...
      <td>female
      <td>38.0
      <td>1
      <td>0
      <td>PC 17599
      <td>71.2833
      <td>C85
      <td>C
    
    <tr>
      <th>2
      <td>3
      <td>1
      <td>3
      <td>Heikkinen, Miss. Laina
      <td>female
      <td>26.0
      <td>0
      <td>0
      <td>STON/O2. 3101282
      <td>7.9250
      <td>NaN
      <td>S
    
    <tr>
      <th>3
      <td>4
      <td>1
      <td>1
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)
      <td>female
      <td>35.0
      <td>1
      <td>0
      <td>113803
      <td>53.1000
      <td>C123
      <td>S
    
    <tr>
      <th>4
      <td>5
      <td>0
      <td>3
      <td>Allen, Mr. William Henry
      <td>male
      <td>35.0
      <td>0
      <td>0
      <td>373450
      <td>8.0500
      <td>NaN
      <td>S
    
  
</table>
</div>

<pre><code class="python hljs"><span class=hljs-comment >#予測に不要と考えるカラムをドロップ (本当はここの情報もしっかり使うべきだと思っています)</span>
titanic_df.drop([<span class=hljs-string >&#x27;PassengerId&#x27;</span>, <span class=hljs-string >&#x27;Name&#x27;</span>, <span class=hljs-string >&#x27;Ticket&#x27;</span>, <span class=hljs-string >&#x27;Cabin&#x27;</span>], axis=<span class=hljs-number >1</span>, inplace=<span class=hljs-literal >True</span>)

<span class=hljs-comment >#一部カラムをドロップしたデータを表示</span>
<span class=hljs-comment ># titanic_df.head()</span>

<span class=hljs-comment >#nullを含んでいる行を表示</span>
titanic_df[titanic_df.isnull().<span class=hljs-built_in >any</span>(<span class=hljs-number >1</span>)].head(<span class=hljs-number >10</span>)</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border=1  class=dataframe >
  <thead>
    <tr style="text-align: right;">
      <th>
      <th>Survived
      <th>Pclass
      <th>Sex
      <th>Age
      <th>SibSp
      <th>Parch
      <th>Fare
      <th>Embarked
    
  
  
    <tr>
      <th>5
      <td>0
      <td>3
      <td>male
      <td>NaN
      <td>0
      <td>0
      <td>8.4583
      <td>Q
    
    <tr>
      <th>17
      <td>1
      <td>2
      <td>male
      <td>NaN
      <td>0
      <td>0
      <td>13.0000
      <td>S
    
    <tr>
      <th>19
      <td>1
      <td>3
      <td>female
      <td>NaN
      <td>0
      <td>0
      <td>7.2250
      <td>C
    
    <tr>
      <th>26
      <td>0
      <td>3
      <td>male
      <td>NaN
      <td>0
      <td>0
      <td>7.2250
      <td>C
    
    <tr>
      <th>28
      <td>1
      <td>3
      <td>female
      <td>NaN
      <td>0
      <td>0
      <td>7.8792
      <td>Q
    
    <tr>
      <th>29
      <td>0
      <td>3
      <td>male
      <td>NaN
      <td>0
      <td>0
      <td>7.8958
      <td>S
    
    <tr>
      <th>31
      <td>1
      <td>1
      <td>female
      <td>NaN
      <td>1
      <td>0
      <td>146.5208
      <td>C
    
    <tr>
      <th>32
      <td>1
      <td>3
      <td>female
      <td>NaN
      <td>0
      <td>0
      <td>7.7500
      <td>Q
    
    <tr>
      <th>36
      <td>1
      <td>3
      <td>male
      <td>NaN
      <td>0
      <td>0
      <td>7.2292
      <td>C
    
    <tr>
      <th>42
      <td>0
      <td>3
      <td>male
      <td>NaN
      <td>0
      <td>0
      <td>7.8958
      <td>C
    
  
</table>
</div>

<pre><code class="python hljs"><span class=hljs-comment >#Ageカラムのnullを中央値で補完</span>
titanic_df[<span class=hljs-string >&#x27;AgeFill&#x27;</span>] = titanic_df[<span class=hljs-string >&#x27;Age&#x27;</span>].fillna(titanic_df[<span class=hljs-string >&#x27;Age&#x27;</span>].mean())

<span class=hljs-comment >#再度nullを含んでいる行を表示 (Ageのnullは補完されている)</span>
titanic_df[titanic_df.isnull().<span class=hljs-built_in >any</span>(<span class=hljs-number >1</span>)]

<span class=hljs-comment >#titanic_df.dtypes</span></code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border=1  class=dataframe >
  <thead>
    <tr style="text-align: right;">
      <th>
      <th>Survived
      <th>Pclass
      <th>Sex
      <th>Age
      <th>SibSp
      <th>Parch
      <th>Fare
      <th>Embarked
      <th>AgeFill
    
  
  
    <tr>
      <th>5
      <td>0
      <td>3
      <td>male
      <td>NaN
      <td>0
      <td>0
      <td>8.4583
      <td>Q
      <td>29.699118
    
    <tr>
      <th>17
      <td>1
      <td>2
      <td>male
      <td>NaN
      <td>0
      <td>0
      <td>13.0000
      <td>S
      <td>29.699118
    
    <tr>
      <th>19
      <td>1
      <td>3
      <td>female
      <td>NaN
      <td>0
      <td>0
      <td>7.2250
      <td>C
      <td>29.699118
    
    <tr>
      <th>26
      <td>0
      <td>3
      <td>male
      <td>NaN
      <td>0
      <td>0
      <td>7.2250
      <td>C
      <td>29.699118
    
    <tr>
      <th>28
      <td>1
      <td>3
      <td>female
      <td>NaN
      <td>0
      <td>0
      <td>7.8792
      <td>Q
      <td>29.699118
    
    <tr>
      <th>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
    
    <tr>
      <th>859
      <td>0
      <td>3
      <td>male
      <td>NaN
      <td>0
      <td>0
      <td>7.2292
      <td>C
      <td>29.699118
    
    <tr>
      <th>863
      <td>0
      <td>3
      <td>female
      <td>NaN
      <td>8
      <td>2
      <td>69.5500
      <td>S
      <td>29.699118
    
    <tr>
      <th>868
      <td>0
      <td>3
      <td>male
      <td>NaN
      <td>0
      <td>0
      <td>9.5000
      <td>S
      <td>29.699118
    
    <tr>
      <th>878
      <td>0
      <td>3
      <td>male
      <td>NaN
      <td>0
      <td>0
      <td>7.8958
      <td>S
      <td>29.699118
    
    <tr>
      <th>888
      <td>0
      <td>3
      <td>female
      <td>NaN
      <td>1
      <td>2
      <td>23.4500
      <td>S
      <td>29.699118
    
  
</table>
<p>179 rows × 9 columns</p>
</div>

<h4 id="実装チケット価格から生死を判別"><a href="#実装チケット価格から生死を判別" class=header-anchor >実装&#40;チケット価格から生死を判別&#41;</a></h4>
<pre><code class="python hljs"><span class=hljs-comment >#運賃だけのリストを作成</span>
data1 = titanic_df.loc[:, [<span class=hljs-string >&quot;Fare&quot;</span>]].values

<span class=hljs-comment >#生死フラグのみのリストを作成</span>
label1 =  titanic_df.loc[:,[<span class=hljs-string >&quot;Survived&quot;</span>]].values</code></pre>
<pre><code class="python hljs"><span class=hljs-keyword >from</span> sklearn.linear_model <span class=hljs-keyword >import</span> LogisticRegression

<span class=hljs-comment ># 学習</span>
model=LogisticRegression()
model.fit(data1, label1[:,<span class=hljs-number >0</span>])

<span class=hljs-comment ># 学習結果の出力</span>
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;モデルパラメータ&quot;</span>)
<span class=hljs-built_in >print</span> (model.intercept_)
<span class=hljs-built_in >print</span> (model.coef_)

<span class=hljs-comment ># 試しにいくつか予測 : 運賃 61USD, 62USD の間で生死の確率が逆転する</span>
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;運賃 61USD&quot;</span>)
<span class=hljs-built_in >print</span>( model.predict([[<span class=hljs-number >61</span>]]))
<span class=hljs-built_in >print</span>( model.predict_proba([[<span class=hljs-number >61</span>]]))

<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;運賃 62USD&quot;</span>)
<span class=hljs-built_in >print</span>( model.predict([[<span class=hljs-number >62</span>]]))
<span class=hljs-built_in >print</span>( model.predict_proba([[<span class=hljs-number >62</span>]]))</code></pre>
<pre><code class="julia hljs">モデルパラメータ
    [-<span class=hljs-number >0.94131796</span>]
    [[<span class=hljs-number >0.01519666</span>]]
    運賃 <span class=hljs-number >61</span>USD
    [<span class=hljs-number >0</span>]
    [[<span class=hljs-number >0.50358033</span> <span class=hljs-number >0.49641967</span>]]
    運賃 <span class=hljs-number >62</span>USD
    [<span class=hljs-number >1</span>]
    [[<span class=hljs-number >0.49978123</span> <span class=hljs-number >0.50021877</span>]]</code></pre>
<pre><code class="python hljs"><span class=hljs-comment >## 可視化 (おまけ程度なので飛ばします、だそう)</span>
X_test_value = model.decision_function(data1) 

<span class=hljs-comment ># # 決定関数値（絶対値が大きいほど識別境界から離れている）</span>
<span class=hljs-comment ># X_test_value = model.decision_function(X_test) </span>
<span class=hljs-comment ># # 決定関数値をシグモイド関数で確率に変換</span>
<span class=hljs-comment ># X_test_prob = normal_sigmoid(X_test_value) </span>

w_0 = model.intercept_[<span class=hljs-number >0</span>]
w_1 = model.coef_[<span class=hljs-number >0</span>,<span class=hljs-number >0</span>]

<span class=hljs-keyword >def</span> <span class="hljs-title function_">sigmoid</span>(<span class=hljs-params >x</span>):
    <span class=hljs-keyword >return</span> <span class=hljs-number >1</span> / (<span class=hljs-number >1</span>+np.exp(-(w_1*x+w_0)))

x_range = np.linspace(-<span class=hljs-number >1</span>, <span class=hljs-number >500</span>, <span class=hljs-number >3000</span>)

plt.figure(figsize=(<span class=hljs-number >9</span>,<span class=hljs-number >5</span>))

plt.plot(data1, model.predict_proba(data1)[:,<span class=hljs-number >0</span>], <span class=hljs-string >&#x27;o&#x27;</span>, label=<span class=hljs-string >&quot;predicted prob. (survive)&quot;</span>)
plt.plot(data1, model.predict_proba(data1)[:,<span class=hljs-number >1</span>], <span class=hljs-string >&#x27;o&#x27;</span>, label=<span class=hljs-string >&quot;predicted prob. (not survive)&quot;</span>)
plt.plot(x_range, sigmoid(x_range), <span class=hljs-string >&#x27;--&#x27;</span>, label=<span class=hljs-string >&quot;sigmoid function with param&quot;</span>)
plt.legend()
plt.show()</code></pre>
<p><img src="/assets/skl_logistic_regression_files/skl_logistic_regression_10_1.svg" alt=svg  /></p>
<h4 id="実装2変数から生死を判別"><a href="#実装2変数から生死を判別" class=header-anchor >実装&#40;2変数から生死を判別&#41;</a></h4>
<p>ただ変数を増やすだけでなく、特徴量エンジニアリングを経験するのがポイント</p>
<pre><code class="python hljs"><span class=hljs-comment >#AgeFillの欠損値を埋めたので</span>
<span class=hljs-comment >#titanic_df = titanic_df.drop([&#x27;Age&#x27;], axis=1)</span>

<span class=hljs-comment ># &#x27;Gender&#x27; の male,female を それぞれ 0,1 に置き換え</span>
titanic_df[<span class=hljs-string >&#x27;Gender&#x27;</span>] = titanic_df[<span class=hljs-string >&#x27;Sex&#x27;</span>].<span class=hljs-built_in >map</span>({<span class=hljs-string >&#x27;female&#x27;</span>: <span class=hljs-number >0</span>, <span class=hljs-string >&#x27;male&#x27;</span>: <span class=hljs-number >1</span>}).astype(<span class=hljs-built_in >int</span>)
titanic_df.head(<span class=hljs-number >3</span>)</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border=1  class=dataframe >
  <thead>
    <tr style="text-align: right;">
      <th>
      <th>Survived
      <th>Pclass
      <th>Sex
      <th>Age
      <th>SibSp
      <th>Parch
      <th>Fare
      <th>Embarked
      <th>AgeFill
      <th>Gender
    
  
  
    <tr>
      <th>0
      <td>0
      <td>3
      <td>male
      <td>22.0
      <td>1
      <td>0
      <td>7.2500
      <td>S
      <td>22.0
      <td>1
    
    <tr>
      <th>1
      <td>1
      <td>1
      <td>female
      <td>38.0
      <td>1
      <td>0
      <td>71.2833
      <td>C
      <td>38.0
      <td>0
    
    <tr>
      <th>2
      <td>1
      <td>3
      <td>female
      <td>26.0
      <td>0
      <td>0
      <td>7.9250
      <td>S
      <td>26.0
      <td>0
    
  
</table>
</div>

<pre><code class="python hljs"><span class=hljs-comment ># Pclass と Gender を足し合わせた新たな特徴量 &#x27;Pclass_Gender&#x27; をつくｒ</span>
titanic_df[<span class=hljs-string >&#x27;Pclass_Gender&#x27;</span>] = titanic_df[<span class=hljs-string >&#x27;Pclass&#x27;</span>] + titanic_df[<span class=hljs-string >&#x27;Gender&#x27;</span>]
titanic_df.head()</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border=1  class=dataframe >
  <thead>
    <tr style="text-align: right;">
      <th>
      <th>Survived
      <th>Pclass
      <th>Sex
      <th>Age
      <th>SibSp
      <th>Parch
      <th>Fare
      <th>Embarked
      <th>AgeFill
      <th>Gender
      <th>Pclass_Gender
    
  
  
    <tr>
      <th>0
      <td>0
      <td>3
      <td>male
      <td>22.0
      <td>1
      <td>0
      <td>7.2500
      <td>S
      <td>22.0
      <td>1
      <td>4
    
    <tr>
      <th>1
      <td>1
      <td>1
      <td>female
      <td>38.0
      <td>1
      <td>0
      <td>71.2833
      <td>C
      <td>38.0
      <td>0
      <td>1
    
    <tr>
      <th>2
      <td>1
      <td>3
      <td>female
      <td>26.0
      <td>0
      <td>0
      <td>7.9250
      <td>S
      <td>26.0
      <td>0
      <td>3
    
    <tr>
      <th>3
      <td>1
      <td>1
      <td>female
      <td>35.0
      <td>1
      <td>0
      <td>53.1000
      <td>S
      <td>35.0
      <td>0
      <td>1
    
    <tr>
      <th>4
      <td>0
      <td>3
      <td>male
      <td>35.0
      <td>0
      <td>0
      <td>8.0500
      <td>S
      <td>35.0
      <td>1
      <td>4
    
  
</table>
</div>

<pre><code class="python hljs"><span class=hljs-comment ># 不要になった特徴量を drop</span>
titanic_df = titanic_df.drop([<span class=hljs-string >&#x27;Pclass&#x27;</span>, <span class=hljs-string >&#x27;Sex&#x27;</span>, <span class=hljs-string >&#x27;Gender&#x27;</span>,<span class=hljs-string >&#x27;Age&#x27;</span>], axis=<span class=hljs-number >1</span>)
titanic_df.head()</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border=1  class=dataframe >
  <thead>
    <tr style="text-align: right;">
      <th>
      <th>Survived
      <th>SibSp
      <th>Parch
      <th>Fare
      <th>Embarked
      <th>AgeFill
      <th>Pclass_Gender
    
  
  
    <tr>
      <th>0
      <td>0
      <td>1
      <td>0
      <td>7.2500
      <td>S
      <td>22.0
      <td>4
    
    <tr>
      <th>1
      <td>1
      <td>1
      <td>0
      <td>71.2833
      <td>C
      <td>38.0
      <td>1
    
    <tr>
      <th>2
      <td>1
      <td>0
      <td>0
      <td>7.9250
      <td>S
      <td>26.0
      <td>3
    
    <tr>
      <th>3
      <td>1
      <td>1
      <td>0
      <td>53.1000
      <td>S
      <td>35.0
      <td>1
    
    <tr>
      <th>4
      <td>0
      <td>0
      <td>0
      <td>8.0500
      <td>S
      <td>35.0
      <td>4
    
  
</table>
</div>

<pre><code class="python hljs"><span class=hljs-comment >#　使用する2変数だけのリストを作成</span>
data2 = titanic_df.loc[:, [<span class=hljs-string >&quot;AgeFill&quot;</span>, <span class=hljs-string >&quot;Pclass_Gender&quot;</span>]].values

<span class=hljs-comment >#生死フラグのみのリストを作成</span>
label2 =  titanic_df.loc[:,[<span class=hljs-string >&quot;Survived&quot;</span>]].values</code></pre>
<pre><code class="python hljs"><span class=hljs-comment ># skleanr 実装</span>

<span class=hljs-comment ># 学習</span>
model2 = LogisticRegression()
model2.fit(data2, label2[:,<span class=hljs-number >0</span>])

<span class=hljs-comment ># 予測　</span>
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;10歳でPclass_Gender=1&quot;</span>)
<span class=hljs-built_in >print</span>(model2.predict([[<span class=hljs-number >10</span>,<span class=hljs-number >1</span>]]))
<span class=hljs-built_in >print</span>(model2.predict_proba([[<span class=hljs-number >10</span>,<span class=hljs-number >1</span>]]))

<span class=hljs-comment ># 予測</span>
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;10歳でPclass_Gender=4&quot;</span>)
<span class=hljs-built_in >print</span>(model2.predict([[<span class=hljs-number >10</span>,<span class=hljs-number >4</span>]]))
<span class=hljs-built_in >print</span>(model2.predict_proba([[<span class=hljs-number >10</span>,<span class=hljs-number >4</span>]]))</code></pre>
<p>10歳でPclass_Gender&#61;1
&#91;1&#93;
&#91;&#91;0.03754749 0.96245251&#93;&#93;
10歳でPclass_Gender&#61;4
&#91;0&#93;
&#91;&#91;0.78415473 0.21584527&#93;&#93;</p>
<pre><code class="python hljs"><span class=hljs-comment ># numpy 実装</span>
<span class=hljs-keyword >def</span> <span class="hljs-title function_">add_one</span>(<span class=hljs-params >x</span>):
    <span class=hljs-keyword >return</span> np.concatenate([np.ones(<span class=hljs-built_in >len</span>(x))[:, <span class=hljs-literal >None</span>], x], axis=<span class=hljs-number >1</span>)

<span class=hljs-comment ># overflow,underflow 対策 のため素直な実装はしない</span>
<span class=hljs-keyword >def</span> <span class="hljs-title function_">sigmoid</span>(<span class=hljs-params >x</span>):
    <span class=hljs-keyword >return</span> (np.tanh(x/<span class=hljs-number >2</span>) + <span class=hljs-number >1</span>)/<span class=hljs-number >2</span>

<span class=hljs-comment ># うまく収束しているかどうか確認するための loss計算</span>
<span class=hljs-keyword >def</span> <span class="hljs-title function_">loss</span>(<span class=hljs-params >X,y,w</span>):
    yhat = sigmoid(np.dot(X,w))
    <span class=hljs-comment ># これだと、yhat = 0,1の時にエラーがでる。</span>
    <span class=hljs-comment ># temp = y * np.log(yhat) + (1-y) * np.log(1-yhat)</span>
    temp = np.log( (<span class=hljs-number >1</span>-y)-(-<span class=hljs-number >1</span>)**y * yhat)
    <span class=hljs-keyword >return</span> -<span class=hljs-built_in >sum</span>(temp)/<span class=hljs-built_in >len</span>(temp)

<span class=hljs-comment ># バッチの共役勾配法</span>
<span class=hljs-keyword >def</span> <span class="hljs-title function_">sgd</span>(<span class=hljs-params >X_train, y_train, max_iter, eta</span>):
    <span class=hljs-comment ># w = np.random.rand(X_train.shape[1])</span>
    w = np.zeros(X_train.shape[<span class=hljs-number >1</span>])
    <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(max_iter):
        <span class=hljs-keyword >if</span> i % <span class=hljs-number >100000</span> == <span class=hljs-number >0</span>:
            <span class=hljs-built_in >print</span>(loss(X_train, y_train, w))
        w_prev = np.copy(w)
        yhat = sigmoid(np.dot(X_train, w))
        w -= eta * np.dot(X_train.T, (yhat - y_train))
        <span class=hljs-comment >#if np.allclose(w, w_prev):</span>
        <span class=hljs-comment >#    return w</span>
    <span class=hljs-keyword >return</span> w

<span class=hljs-comment ># ヒューリスティックにパラメータチューニング</span>
max_iter=<span class=hljs-number >2000000</span> 
eta = <span class=hljs-number >0.000001</span>
w = sgd(add_one(data2), label2[:,<span class=hljs-number >0</span>], max_iter, eta)</code></pre>
<pre><code class="julia hljs"><span class=hljs-number >0.6931471805599373</span>
    <span class=hljs-number >0.5079276216927482</span>
    <span class=hljs-number >0.4905915541820542</span>
    <span class=hljs-number >0.4862090047552061</span>
    <span class=hljs-number >0.48489864641172786</span>
    <span class=hljs-number >0.48447258191832004</span>
    <span class=hljs-number >0.48432764482843516</span>
    <span class=hljs-number >0.48427706879224364</span>
    <span class=hljs-number >0.48425915804405467</span>
    <span class=hljs-number >0.48425275998902756</span>
    <span class=hljs-number >0.4842504626951552</span>
    <span class=hljs-number >0.4842496352899579</span>
    <span class=hljs-number >0.4842493367393749</span>
    <span class=hljs-number >0.4842492288953244</span>
    <span class=hljs-number >0.48424918991352967</span>
    <span class=hljs-number >0.4842491758173902</span>
    <span class=hljs-number >0.48424917071889134</span>
    <span class=hljs-number >0.484249168874524</span>
    <span class=hljs-number >0.4842491682072763</span>
    <span class=hljs-number >0.4842491679658649</span></code></pre>
<pre><code class="python hljs"><span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;numpy実装で得られたパラメータ&quot;</span>)
<span class=hljs-built_in >print</span>(w)

<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;sklearn実装で得られたパラメータ&quot;</span>)
<span class=hljs-built_in >print</span>(model2.intercept_)
<span class=hljs-built_in >print</span>(model2.coef_)</code></pre>
<pre><code class="julia hljs">numpy実装で得られたパラメータ
    [ <span class=hljs-number >5.27828007</span> -<span class=hljs-number >0.04669006</span> -<span class=hljs-number >1.52804692</span>]
    sklearn実装で得られたパラメータ
    [<span class=hljs-number >5.2174269</span>]
    [[-<span class=hljs-number >0.04622413</span> -<span class=hljs-number >1.51130754</span>]]</code></pre>
<pre><code class="python hljs">titanic_df.head(<span class=hljs-number >3</span>)</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border=1  class=dataframe >
  <thead>
    <tr style="text-align: right;">
      <th>
      <th>Survived
      <th>SibSp
      <th>Parch
      <th>Fare
      <th>Embarked
      <th>AgeFill
      <th>Pclass_Gender
    
  
  
    <tr>
      <th>0
      <td>0
      <td>1
      <td>0
      <td>7.2500
      <td>S
      <td>22.0
      <td>4
    
    <tr>
      <th>1
      <td>1
      <td>1
      <td>0
      <td>71.2833
      <td>C
      <td>38.0
      <td>1
    
    <tr>
      <th>2
      <td>1
      <td>0
      <td>0
      <td>7.9250
      <td>S
      <td>26.0
      <td>3
    
  
</table>
</div>

<p>特徴量空間上にサンプルと、決定境界をプロットしてみよう。</p>
<p>ロジスティック回帰の場合、確率0.5が境界。</p>
<p><span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mtable rowspacing=0.15999999999999992em  columnalign="right center left" columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msup><mi mathvariant=bold-italic >w</mi><mi>T</mi></msup><mi mathvariant=bold-italic >x</mi><mo>+</mo><msub><mi>w</mi><mn>0</mn></msub></mrow></msup></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mo>&gt;</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><msup><mi>e</mi><mrow><msup><mi mathvariant=bold-italic >w</mi><mi>T</mi></msup><mi mathvariant=bold-italic >x</mi><mo>+</mo><msub><mi>w</mi><mn>0</mn></msub></mrow></msup></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mo>&lt;</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><msup><mi mathvariant=bold-italic >w</mi><mi>T</mi></msup><mi mathvariant=bold-italic >x</mi><mo>+</mo><msub><mi>w</mi><mn>0</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mo>&lt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{rcl}
\frac{1}{1+e^{\boldsymbol{w}^T \boldsymbol{x} + w_0}} &amp;&gt; \frac{1}{2} \\
e^{\boldsymbol{w}^T \boldsymbol{x} + w_0} &amp;&lt; 1 \\
\boldsymbol{w}^T \boldsymbol{x} + w_0 &amp;&lt; 0
\end{array}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:3.995045em;vertical-align:-1.7475225000000005em;"></span><span class=mord ><span class=mtable ><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-r ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.2475224999999996em;"><span style="top:-4.4087795em;"><span class=pstrut  style="height:3.0063649999999997em;"></span><span class=mord ><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.845108em;"><span style="top:-2.4760899999999997em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:1.0198714285714288em;"><span style="top:-3.0198714285714288em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.698092857142857em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.02778em;">w</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.97733em;"><span style="top:-2.97733em;margin-right:0.1em;"><span class=pstrut  style="height:2.6833299999999998em;"></span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight">x</span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3447999999999998em;margin-left:-0.02691em;margin-right:0.1em;"><span class=pstrut  style="height:2.64444em;"></span><span class="mord mtight">0</span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.29964em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.5822410000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.820173499999999em;"><span class=pstrut  style="height:3.0063649999999997em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">e</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:1.006365em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.02778em;">w</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9190928571428572em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight">x</span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.02691em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-1.6188424999999993em;"><span class=pstrut  style="height:3.0063649999999997em;"></span><span class=mord ><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.7475225000000005em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.2475224999999996em;"><span style="top:-4.4087795em;"><span class=pstrut  style="height:3.0063649999999997em;"></span><span class=mord ><span class=mrel >&gt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.820173499999999em;"><span class=pstrut  style="height:3.0063649999999997em;"></span><span class=mord ><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >1</span></span></span><span style="top:-1.6188424999999993em;"><span class=pstrut  style="height:3.0063649999999997em;"></span><span class=mord ><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.7475225000000005em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span></span></span></span></span></span></span> が決定境界になる。</p>
<pre><code class="python hljs"><span class=hljs-keyword >from</span> matplotlib.colors <span class=hljs-keyword >import</span> ListedColormap

np.random.seed = <span class=hljs-number >0</span>
h = <span class=hljs-number >0.02</span>
xmin, xmax = -<span class=hljs-number >5</span>, <span class=hljs-number >85</span>
ymin, ymax = <span class=hljs-number >0.5</span>, <span class=hljs-number >4.5</span>
index_survived = titanic_df[titanic_df[<span class=hljs-string >&quot;Survived&quot;</span>]==<span class=hljs-number >0</span>].index
index_notsurvived = titanic_df[titanic_df[<span class=hljs-string >&quot;Survived&quot;</span>]==<span class=hljs-number >1</span>].index

xx, yy = np.meshgrid(np.arange(xmin, xmax, h), np.arange(ymin, ymax, h))
Z = model2.predict_proba(np.c_[xx.ravel(), yy.ravel()])[:, <span class=hljs-number >1</span>]
Z = Z.reshape(xx.shape)

fig, ax = plt.subplots()
levels = np.linspace(<span class=hljs-number >0</span>, <span class=hljs-number >1.0</span>)
cm = plt.cm.RdBu
cm_bright = ListedColormap([<span class=hljs-string >&#x27;#FF0000&#x27;</span>, <span class=hljs-string >&#x27;#0000FF&#x27;</span>])
<span class=hljs-comment >#contour = ax.contourf(xx, yy, Z, cmap=cm, levels=levels, alpha=0.5)</span>

sc = ax.scatter(titanic_df.loc[index_survived, <span class=hljs-string >&#x27;AgeFill&#x27;</span>],
                titanic_df.loc[index_survived, <span class=hljs-string >&#x27;Pclass_Gender&#x27;</span>]+(np.random.rand(<span class=hljs-built_in >len</span>(index_survived))-<span class=hljs-number >0.5</span>)*<span class=hljs-number >0.1</span>,
                color=<span class=hljs-string >&#x27;r&#x27;</span>, label=<span class=hljs-string >&#x27;Not Survived&#x27;</span>, alpha=<span class=hljs-number >0.3</span>)
sc = ax.scatter(titanic_df.loc[index_notsurvived, <span class=hljs-string >&#x27;AgeFill&#x27;</span>],
                titanic_df.loc[index_notsurvived, <span class=hljs-string >&#x27;Pclass_Gender&#x27;</span>]+(np.random.rand(<span class=hljs-built_in >len</span>(index_notsurvived))-<span class=hljs-number >0.5</span>)*<span class=hljs-number >0.1</span>,
                color=<span class=hljs-string >&#x27;b&#x27;</span>, label=<span class=hljs-string >&#x27;Survived&#x27;</span>, alpha=<span class=hljs-number >0.3</span>)

ax.set_xlabel(<span class=hljs-string >&#x27;AgeFill&#x27;</span>)
ax.set_ylabel(<span class=hljs-string >&#x27;Pclass_Gender&#x27;</span>)
ax.set_xlim(xmin, xmax)
ax.set_ylim(ymin, ymax)
<span class=hljs-comment >#fig.colorbar(contour)</span>

<span class=hljs-comment ># 決定境界</span>
x1 = xmin
x2 = xmax
y1 = -<span class=hljs-number >1</span>*(model2.intercept_[<span class=hljs-number >0</span>]+model2.coef_[<span class=hljs-number >0</span>][<span class=hljs-number >0</span>]*xmin)/model2.coef_[<span class=hljs-number >0</span>][<span class=hljs-number >1</span>]
y2 = -<span class=hljs-number >1</span>*(model2.intercept_[<span class=hljs-number >0</span>]+model2.coef_[<span class=hljs-number >0</span>][<span class=hljs-number >0</span>]*xmax)/model2.coef_[<span class=hljs-number >0</span>][<span class=hljs-number >1</span>]
ax.plot([x1, x2] ,[y1, y2], <span class=hljs-string >&#x27;g--&#x27;</span>, label=<span class=hljs-string >&quot;decision boundary(sklearn)&quot;</span>)

y1 = -<span class=hljs-number >1</span>*(w[<span class=hljs-number >0</span>]+w[<span class=hljs-number >1</span>]*xmin)/w[<span class=hljs-number >2</span>]
y2 = -<span class=hljs-number >1</span>*(w[<span class=hljs-number >0</span>]+w[<span class=hljs-number >1</span>]*xmax)/w[<span class=hljs-number >2</span>]
ax.plot([x1, x2] ,[y1, y2], <span class=hljs-string >&#x27;y--&#x27;</span>, label=<span class=hljs-string >&quot;decision boundary(numpy)&quot;</span>)

<span class=hljs-comment ># ax.legend(bbox_to_anchor=(1.4, 1.03))</span>
ax.legend(bbox_to_anchor=(<span class=hljs-number >1.0</span>, <span class=hljs-number >1.0</span>))</code></pre>
<p><img src="/assets/skl_logistic_regression_files/skl_logistic_regression_21_1.svg" alt=svg  /></p>
<h4 id="モデル評価"><a href="#モデル評価" class=header-anchor >モデル評価</a></h4>
<p>ここでは sklearn, seaborn などを使ったモデル評価の方法をいくつか使ってみる。 可視化はおまけ、ということなので、何をやってるか簡単に理解するにとどめておく。</p>
<ul>
<li><p>confusion matrix や、Recall, Precision などはビデオ講義で学んだ</p>

<li><p>seaborn の <a href="https://seaborn.pydata.org/generated/seaborn.pointplot.html?highlight&#61;pointplot">point plot</a> では <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> で指定したクラス分類それぞれに付いて、<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> の点推定・信頼区間をプロットする. </p>
<ul>
<li><p>今回 estimator には何も指定していないので 母平均の推定を行っている</p>

</ul>

<li><p>seaborn の <a href="https://seaborn.pydata.org/generated/seaborn.lmplot.html">lmplot</a> は、回帰&#43;その結果の可視化をしてくれるもの。</p>
<ul>
<li><p>今回は logistic に True を指定しているため、ロジスティック回帰を行うが、線形回帰や多項式回帰なども行えるようだ。</p>

<li><p>hue,col の指定は そのままでは回帰に使えない, カテゴリ変数を扱うためのもの? グラフを分けたり、色を分けたりする. &#40;この機能を使うことをさして faceted と言っているもよう&#41;</p>

<li><p>薄い範囲は信頼区間&#40;デフォルト95&#37;&#41;を示すようだ。</p>

</ul>

</ul>
<pre><code class="python hljs"><span class=hljs-comment ># データの分割 (本来は同じデータセットを分割しなければいけない。(簡易的に別々に分割している)</span>
<span class=hljs-keyword >from</span> sklearn.model_selection <span class=hljs-keyword >import</span> train_test_split
traindata1, testdata1, trainlabel1, testlabel1 = train_test_split(data1, label1, test_size=<span class=hljs-number >0.2</span>)
traindata2, testdata2, trainlabel2, testlabel2 = train_test_split(data2, label2, test_size=<span class=hljs-number >0.2</span>)

<span class=hljs-comment ># 学習</span>
eval_model1=LogisticRegression()
predictor_eval1=eval_model1.fit(traindata1, trainlabel1[:,<span class=hljs-number >0</span>]).predict(testdata1)

eval_model2=LogisticRegression()
predictor_eval2=eval_model2.fit(traindata2, trainlabel2[:,<span class=hljs-number >0</span>]).predict(testdata2)

<span class=hljs-comment ># 評価</span>
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;&quot;</span>)
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;score:&quot;</span>)
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;(model 1, train) = %f&quot;</span> % (eval_model1.score(traindata1, trainlabel1)))
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;(model 1, test)  = %f&quot;</span> % (eval_model1.score(testdata1,testlabel1)))
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;(model 2, train)  = %f&quot;</span> % (eval_model2.score(traindata2, trainlabel2)))
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;(model 1, test)  = %f&quot;</span> % (eval_model2.score(testdata2,testlabel2)))

<span class=hljs-keyword >from</span> sklearn <span class=hljs-keyword >import</span> metrics
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;&quot;</span>)
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;metrics:&quot;</span>)
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;model1&quot;</span>)
<span class=hljs-built_in >print</span>(metrics.classification_report(testlabel1, predictor_eval1))
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;model2&quot;</span>)
<span class=hljs-built_in >print</span>(metrics.classification_report(testlabel2, predictor_eval2))</code></pre>
<pre><code class="julia hljs">score:
    (model <span class=hljs-number >1</span>, train) = <span class=hljs-number >0.653090</span>
    (model <span class=hljs-number >1</span>, test)  = <span class=hljs-number >0.715084</span>
    (model <span class=hljs-number >2</span>, train)  = <span class=hljs-number >0.761236</span>
    (model <span class=hljs-number >1</span>, test)  = <span class=hljs-number >0.821229</span>
    
    metrics:
    model1
                  precision    recall  f1-score   support
    
               <span class=hljs-number >0</span>       <span class=hljs-number >0.70</span>      <span class=hljs-number >0.97</span>      <span class=hljs-number >0.81</span>       <span class=hljs-number >113</span>
               <span class=hljs-number >1</span>       <span class=hljs-number >0.86</span>      <span class=hljs-number >0.27</span>      <span class=hljs-number >0.41</span>        <span class=hljs-number >66</span>
    
        accuracy                           <span class=hljs-number >0.72</span>       <span class=hljs-number >179</span>
       <span class=hljs-keyword >macro</span> avg       <span class=hljs-number >0.78</span>      <span class=hljs-number >0.62</span>      <span class=hljs-number >0.61</span>       <span class=hljs-number >179</span>
    weighted avg       <span class=hljs-number >0.76</span>      <span class=hljs-number >0.72</span>      <span class=hljs-number >0.67</span>       <span class=hljs-number >179</span>
    
    model2
                  precision    recall  f1-score   support
    
               <span class=hljs-number >0</span>       <span class=hljs-number >0.82</span>      <span class=hljs-number >0.91</span>      <span class=hljs-number >0.86</span>       <span class=hljs-number >108</span>
               <span class=hljs-number >1</span>       <span class=hljs-number >0.83</span>      <span class=hljs-number >0.69</span>      <span class=hljs-number >0.75</span>        <span class=hljs-number >71</span>
    
        accuracy                           <span class=hljs-number >0.82</span>       <span class=hljs-number >179</span>
       <span class=hljs-keyword >macro</span> avg       <span class=hljs-number >0.82</span>      <span class=hljs-number >0.80</span>      <span class=hljs-number >0.81</span>       <span class=hljs-number >179</span>
    weighted avg       <span class=hljs-number >0.82</span>      <span class=hljs-number >0.82</span>      <span class=hljs-number >0.82</span>       <span class=hljs-number >179</span></code></pre>
<pre><code class="python hljs"><span class=hljs-keyword >def</span> <span class="hljs-title function_">plot_confusion_matrix</span>(<span class=hljs-params >cm,title</span>):
    fig = plt.figure(figsize = (<span class=hljs-number >7</span>,<span class=hljs-number >7</span>))
    plt.title(title)
    sns.heatmap(
        cm,
        vmin=<span class=hljs-literal >None</span>,
        vmax=<span class=hljs-literal >None</span>,
        cmap=<span class=hljs-string >&quot;Blues&quot;</span>,
        center=<span class=hljs-literal >None</span>,
        robust=<span class=hljs-literal >False</span>,
        annot=<span class=hljs-literal >True</span>, fmt=<span class=hljs-string >&#x27;.2g&#x27;</span>,
        annot_kws=<span class=hljs-literal >None</span>,
        linewidths=<span class=hljs-number >0</span>,
        linecolor=<span class=hljs-string >&#x27;white&#x27;</span>,
        cbar=<span class=hljs-literal >True</span>,
        cbar_kws=<span class=hljs-literal >None</span>,
        cbar_ax=<span class=hljs-literal >None</span>,
        square=<span class=hljs-literal >True</span>, ax=<span class=hljs-literal >None</span>, 
        <span class=hljs-comment >#xticklabels=columns,</span>
        <span class=hljs-comment >#yticklabels=columns,</span>
        mask=<span class=hljs-literal >None</span>)
    <span class=hljs-keyword >return</span> 


<span class=hljs-keyword >from</span> sklearn.metrics <span class=hljs-keyword >import</span> confusion_matrix
confusion_matrix1=confusion_matrix(testlabel1, predictor_eval1)
confusion_matrix2=confusion_matrix(testlabel2, predictor_eval2)


plot_confusion_matrix(confusion_matrix1, <span class=hljs-string >&quot;model1&quot;</span>)
plot_confusion_matrix(confusion_matrix2, <span class=hljs-string >&quot;model2&quot;</span>)</code></pre>
<p><img src="/assets/skl_logistic_regression_files/skl_logistic_regression_24_0.svg" alt=svg  /></p>
<p><img src="/assets/skl_logistic_regression_files/skl_logistic_regression_24_1.svg" alt=svg  /></p>
<pre><code class="python hljs"><span class=hljs-comment >#Paired categorical plots</span>

<span class=hljs-keyword >import</span> seaborn <span class=hljs-keyword >as</span> sns
sns.<span class=hljs-built_in >set</span>(style=<span class=hljs-string >&quot;whitegrid&quot;</span>)

<span class=hljs-comment ># Load the example Titanic dataset</span>
titanic = sns.load_dataset(<span class=hljs-string >&quot;titanic&quot;</span>)

<span class=hljs-comment ># Set up a grid to plot survival probability against several variables</span>
g = sns.PairGrid(titanic, y_vars=<span class=hljs-string >&quot;survived&quot;</span>,
                 x_vars=[<span class=hljs-string >&quot;class&quot;</span>, <span class=hljs-string >&quot;sex&quot;</span>, <span class=hljs-string >&quot;who&quot;</span>, <span class=hljs-string >&quot;alone&quot;</span>],
                 size=<span class=hljs-number >5</span>, aspect=<span class=hljs-number >.5</span>)

<span class=hljs-comment ># Draw a seaborn pointplot onto each Axes</span>
g.<span class=hljs-built_in >map</span>(sns.pointplot, color=sns.xkcd_rgb[<span class=hljs-string >&quot;plum&quot;</span>])
g.<span class=hljs-built_in >set</span>(ylim=(<span class=hljs-number >0</span>, <span class=hljs-number >1</span>))
sns.despine(fig=g.fig, left=<span class=hljs-literal >True</span>)

plt.show()</code></pre>
<p>実際には warning が表示されていたが、割愛。ローカルPC内のパスが含まれていたため</p>
<p><img src="/assets/skl_logistic_regression_files/skl_logistic_regression_25_1.svg" alt=svg  /></p>
<pre><code class="python hljs"><span class=hljs-comment >#Faceted logistic regression</span>

<span class=hljs-keyword >import</span> seaborn <span class=hljs-keyword >as</span> sns
sns.<span class=hljs-built_in >set</span>(style=<span class=hljs-string >&quot;darkgrid&quot;</span>)

<span class=hljs-comment ># Load the example titanic dataset</span>
df = sns.load_dataset(<span class=hljs-string >&quot;titanic&quot;</span>)

<span class=hljs-comment ># Make a custom palette with gendered colors</span>
pal = <span class=hljs-built_in >dict</span>(male=<span class=hljs-string >&quot;#6495ED&quot;</span>, female=<span class=hljs-string >&quot;#F08080&quot;</span>)

<span class=hljs-comment ># Show the survival proability as a function of age and sex</span>
g = sns.lmplot(x=<span class=hljs-string >&quot;age&quot;</span>, y=<span class=hljs-string >&quot;survived&quot;</span>, col=<span class=hljs-string >&quot;sex&quot;</span>, hue=<span class=hljs-string >&quot;sex&quot;</span>, data=df,
               palette=pal, y_jitter=<span class=hljs-number >.02</span>, logistic=<span class=hljs-literal >True</span>)
g.<span class=hljs-built_in >set</span>(xlim=(<span class=hljs-number >0</span>, <span class=hljs-number >80</span>), ylim=(-<span class=hljs-number >.05</span>, <span class=hljs-number >1.05</span>))
plt.show()</code></pre>
<p><img src="/assets/skl_logistic_regression_files/skl_logistic_regression_26_0.svg" alt=svg  />
<h2 id="主成分分析_pca"><a href="#主成分分析_pca" class=header-anchor >主成分分析 &#40;PCA&#41; </a></h2>
<h3 id="動画講義メモ要点のまとめ__4"><a href="#動画講義メモ要点のまとめ__4" class=header-anchor >動画講義メモ&#40;要点のまとめ&#41;</a></h3>
<ul>
<li><p>次元圧縮&#40;変量の個数を減らす&#41;のに使われる方法</p>
<ul>
<li><p>線形変換によって、<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> 個の <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span> 次元のデータを <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi></mrow><annotation encoding="application/x-tex">J</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span></span></span></span>次元にしたい</p>
<ul>
<li><p>データ行列から、データを引いた <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent=true ><mi>X</mi><mo>ˉ</mo></mover><mo>:</mo><mo>=</mo><mi>X</mi><mo>−</mo><mover accent=true ><mi>x</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{X} := X - \bar{x}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8201099999999999em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span><span style="top:-3.25233em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.16666em;"><span class=mord >ˉ</span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >:</span></span><span class=base ><span class=strut  style="height:0.36687em;vertical-align:0em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.56778em;vertical-align:0em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.56778em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.22222em;"><span class=mord >ˉ</span></span></span></span></span></span></span></span></span></span> として、 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant=bold-italic >s</mi><mi>j</mi></msub><mo>=</mo><mover accent=true ><mi>X</mi><mo>ˉ</mo></mover><msub><mi mathvariant=bold-italic >a</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\bm{s}_j = \bar{X} \bm{a}_j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.730548em;vertical-align:-0.286108em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">s</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.106218em;vertical-align:-0.286108em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8201099999999999em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span><span style="top:-3.25233em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.16666em;"><span class=mord >ˉ</span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> が 各データの <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 次元めの値となる。</p>

</ul>

<li><p>変換前後のデータの散らばり具合を維持できれば、データの情報量が減らないと考える</p>
<ul>
<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant=bold-italic >a</mi><mi>j</mi></msub><mi>j</mi><mo>=</mo><mn>1</mn><mo separator=true >,</mo><mn>2</mn><mo separator=true >,</mo><mo>…</mo><mo separator=true >,</mo><mi>J</mi></mrow><annotation encoding="application/x-tex">\bm{a}_j j=1,2,\ldots, J</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.9456279999999999em;vertical-align:-0.286108em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >2</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner >…</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span></span></span></span> は、元のデータの広がりが大きい方向。</p>

<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant=bold-italic >a</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\bm{a}_j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.730548em;vertical-align:-0.286108em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> の見つけ方</p>
<ul>
<li><p>目的関数: 変換後の分散最大化</p>
<ul>
<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo><mi mathvariant=normal >arg max</mi><mo>⁡</mo></mo><mi>a</mi></msub><mo>=</mo><msubsup><mi mathvariant=bold-italic >a</mi><mi>j</mi><mi>T</mi></msubsup><mi>V</mi><mi>a</mi><mi>r</mi><mo stretchy=false >(</mo><mover accent=true ><mi>X</mi><mo>ˉ</mo></mover><mo stretchy=false >)</mo><msub><mi mathvariant=bold-italic >a</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\argmax_{a} = \bm{a}_j^T Var(\bar{X}) \bm{a}_j </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6747em;vertical-align:-0.24414em;"></span><span class=mop ><span class=mop ><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right:0.01389em;">g</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.057252em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.24414em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.236103em;vertical-align:-0.394772em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-2.441336em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.394772em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mopen >(</span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8201099999999999em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span><span style="top:-3.25233em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.16666em;"><span class=mord >ˉ</span></span></span></span></span></span></span><span class=mclose >)</span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></p>

</ul>

<li><p>制約条件: ノルム一定の制約で解の任意制を取り除く</p>
<ul>
<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant=bold-italic >a</mi><mi>j</mi><mi>T</mi></msubsup><msub><mi mathvariant=bold-italic >a</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\bm{a}_j^T \bm{a}_j =1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.236103em;vertical-align:-0.394772em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-2.441336em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.394772em;"><span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span></p>

</ul>

<li><p>ラグランジュ未定乗数法をつかって解く -&gt; 解: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>a</mi><mi>r</mi><mo stretchy=false >(</mo><mover accent=true ><mi>X</mi><mo>ˉ</mo></mover><mo stretchy=false >)</mo><msub><mi mathvariant=bold-italic >a</mi><mi>j</mi></msub><mo>=</mo><mi>λ</mi><msub><mi mathvariant=bold-italic >a</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">Var(\bar{X}) \bm{a}_j = \lambda \bm{a}_j </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.106218em;vertical-align:-0.286108em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mopen >(</span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8201099999999999em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span><span style="top:-3.25233em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.16666em;"><span class=mord >ˉ</span></span></span></span></span></span></span><span class=mclose >)</span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord mathnormal">λ</span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li><p>取り出すべき軸の方向は、固有ベクトルの方向</p>

<li><p>射影先の分散は固有値と一致</p>

</ul>

</ul>

<li><p>寄与率 : 圧縮前後の情報のロスを定量化したもの</p>
<ul>
<li><p>第 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 成分の寄与率は、 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>k</mi></msub><mo>=</mo><mfrac><msub><mi>λ</mi><mi>k</mi></msub><mrow><msubsup><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></msubsup><msub><mi>λ</mi><mi>m</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">c_k = \frac{\lambda_k}{\sum_{m=1}^{M} \lambda_m}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">c</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.5566399999999998em;vertical-align:-0.654672em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.9019679999999999em;"><span style="top:-2.570335em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8852357142857143em;"><span style="top:-2.1785614285714283em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.8971428571428572em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.32143857142857146em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mtight"><span class="mord mathnormal mtight">λ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.41586em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.654672em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>

<li><p>第 1 ~ <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 主成分までの累積寄与率は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>k</mi></msub><mo>=</mo><mfrac><mrow><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></msubsup><msub><mi>λ</mi><mi>j</mi></msub></mrow><mrow><msubsup><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></msubsup><msub><mi>λ</mi><mi>m</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex"> r_k = \frac{\sum_{j=1}^{J}\lambda_j}{\sum_{m=1}^{M} \lambda_m}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.9302640000000002em;vertical-align:-0.654672em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.275592em;"><span style="top:-2.570335em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8852357142857143em;"><span style="top:-2.1785614285714283em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.8971428571428572em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.32143857142857146em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mtight"><span class="mord mathnormal mtight">λ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.632227em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.9190928571428572em;"><span style="top:-2.1785614285714283em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.09618em;">J</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.46032428571428574em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mtight"><span class="mord mathnormal mtight">λ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.654672em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>

</ul>

</ul>

</ul>

</ul>
</p>
<h3 id="ハンズオン__3"><a href="#ハンズオン__3" class=header-anchor >ハンズオン</a></h3>
<p>https://ohke.hateblo.jp/entry/2017/08/11/230000 を参考に利用した、乳がんデータセットの主成分分析</p>
<pre><code class="python hljs"><span class=hljs-keyword >import</span> pandas <span class=hljs-keyword >as</span> pd
<span class=hljs-keyword >from</span> sklearn.model_selection <span class=hljs-keyword >import</span> train_test_split
<span class=hljs-keyword >from</span> sklearn.preprocessing <span class=hljs-keyword >import</span> StandardScaler
<span class=hljs-keyword >from</span> sklearn.linear_model <span class=hljs-keyword >import</span> LogisticRegressionCV
<span class=hljs-keyword >from</span> sklearn.metrics <span class=hljs-keyword >import</span> confusion_matrix
<span class=hljs-keyword >from</span> sklearn.decomposition <span class=hljs-keyword >import</span> PCA
<span class=hljs-keyword >import</span> matplotlib.pyplot <span class=hljs-keyword >as</span> plt
%matplotlib inline</code></pre>
<pre><code class="python hljs">cancer_df = pd.read_csv(<span class=hljs-string >&#x27;../data/cancer.csv&#x27;</span>)
<span class=hljs-built_in >print</span>(<span class=hljs-string >&#x27;cancer df shape: {}&#x27;</span>.<span class=hljs-built_in >format</span>(cancer_df.shape))</code></pre>
<p>cancer df shape: &#40;569, 33&#41;</p>
<pre><code class="python hljs">cancer_df</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border=1  class=dataframe >
  <thead>
    <tr style="text-align: right;">
      <th>
      <th>id
      <th>diagnosis
      <th>radius_mean
      <th>texture_mean
      <th>perimeter_mean
      <th>area_mean
      <th>smoothness_mean
      <th>compactness_mean
      <th>concavity_mean
      <th>concave points_mean
      <th>...
      <th>texture_worst
      <th>perimeter_worst
      <th>area_worst
      <th>smoothness_worst
      <th>compactness_worst
      <th>concavity_worst
      <th>concave points_worst
      <th>symmetry_worst
      <th>fractal_dimension_worst
      <th>Unnamed: 32
    
  
  
    <tr>
      <th>0
      <td>842302
      <td>M
      <td>17.99
      <td>10.38
      <td>122.80
      <td>1001.0
      <td>0.11840
      <td>0.27760
      <td>0.30010
      <td>0.14710
      <td>...
      <td>17.33
      <td>184.60
      <td>2019.0
      <td>0.16220
      <td>0.66560
      <td>0.7119
      <td>0.2654
      <td>0.4601
      <td>0.11890
      <td>NaN
    
    <tr>
      <th>1
      <td>842517
      <td>M
      <td>20.57
      <td>17.77
      <td>132.90
      <td>1326.0
      <td>0.08474
      <td>0.07864
      <td>0.08690
      <td>0.07017
      <td>...
      <td>23.41
      <td>158.80
      <td>1956.0
      <td>0.12380
      <td>0.18660
      <td>0.2416
      <td>0.1860
      <td>0.2750
      <td>0.08902
      <td>NaN
    
    <tr>
      <th>2
      <td>84300903
      <td>M
      <td>19.69
      <td>21.25
      <td>130.00
      <td>1203.0
      <td>0.10960
      <td>0.15990
      <td>0.19740
      <td>0.12790
      <td>...
      <td>25.53
      <td>152.50
      <td>1709.0
      <td>0.14440
      <td>0.42450
      <td>0.4504
      <td>0.2430
      <td>0.3613
      <td>0.08758
      <td>NaN
    
    <tr>
      <th>3
      <td>84348301
      <td>M
      <td>11.42
      <td>20.38
      <td>77.58
      <td>386.1
      <td>0.14250
      <td>0.28390
      <td>0.24140
      <td>0.10520
      <td>...
      <td>26.50
      <td>98.87
      <td>567.7
      <td>0.20980
      <td>0.86630
      <td>0.6869
      <td>0.2575
      <td>0.6638
      <td>0.17300
      <td>NaN
    
    <tr>
      <th>4
      <td>84358402
      <td>M
      <td>20.29
      <td>14.34
      <td>135.10
      <td>1297.0
      <td>0.10030
      <td>0.13280
      <td>0.19800
      <td>0.10430
      <td>...
      <td>16.67
      <td>152.20
      <td>1575.0
      <td>0.13740
      <td>0.20500
      <td>0.4000
      <td>0.1625
      <td>0.2364
      <td>0.07678
      <td>NaN
    
    <tr>
      <th>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
    
    <tr>
      <th>564
      <td>926424
      <td>M
      <td>21.56
      <td>22.39
      <td>142.00
      <td>1479.0
      <td>0.11100
      <td>0.11590
      <td>0.24390
      <td>0.13890
      <td>...
      <td>26.40
      <td>166.10
      <td>2027.0
      <td>0.14100
      <td>0.21130
      <td>0.4107
      <td>0.2216
      <td>0.2060
      <td>0.07115
      <td>NaN
    
    <tr>
      <th>565
      <td>926682
      <td>M
      <td>20.13
      <td>28.25
      <td>131.20
      <td>1261.0
      <td>0.09780
      <td>0.10340
      <td>0.14400
      <td>0.09791
      <td>...
      <td>38.25
      <td>155.00
      <td>1731.0
      <td>0.11660
      <td>0.19220
      <td>0.3215
      <td>0.1628
      <td>0.2572
      <td>0.06637
      <td>NaN
    
    <tr>
      <th>566
      <td>926954
      <td>M
      <td>16.60
      <td>28.08
      <td>108.30
      <td>858.1
      <td>0.08455
      <td>0.10230
      <td>0.09251
      <td>0.05302
      <td>...
      <td>34.12
      <td>126.70
      <td>1124.0
      <td>0.11390
      <td>0.30940
      <td>0.3403
      <td>0.1418
      <td>0.2218
      <td>0.07820
      <td>NaN
    
    <tr>
      <th>567
      <td>927241
      <td>M
      <td>20.60
      <td>29.33
      <td>140.10
      <td>1265.0
      <td>0.11780
      <td>0.27700
      <td>0.35140
      <td>0.15200
      <td>...
      <td>39.42
      <td>184.60
      <td>1821.0
      <td>0.16500
      <td>0.86810
      <td>0.9387
      <td>0.2650
      <td>0.4087
      <td>0.12400
      <td>NaN
    
    <tr>
      <th>568
      <td>92751
      <td>B
      <td>7.76
      <td>24.54
      <td>47.92
      <td>181.0
      <td>0.05263
      <td>0.04362
      <td>0.00000
      <td>0.00000
      <td>...
      <td>30.37
      <td>59.16
      <td>268.6
      <td>0.08996
      <td>0.06444
      <td>0.0000
      <td>0.0000
      <td>0.2871
      <td>0.07039
      <td>NaN
    
  
</table>
<p>569 rows × 33 columns</p>
</div>

<pre><code class="python hljs">cancer_df.drop(<span class=hljs-string >&#x27;Unnamed: 32&#x27;</span>, axis=<span class=hljs-number >1</span>, inplace=<span class=hljs-literal >True</span>)
cancer_df</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border=1  class=dataframe >
  <thead>
    <tr style="text-align: right;">
      <th>
      <th>id
      <th>diagnosis
      <th>radius_mean
      <th>texture_mean
      <th>perimeter_mean
      <th>area_mean
      <th>smoothness_mean
      <th>compactness_mean
      <th>concavity_mean
      <th>concave points_mean
      <th>...
      <th>radius_worst
      <th>texture_worst
      <th>perimeter_worst
      <th>area_worst
      <th>smoothness_worst
      <th>compactness_worst
      <th>concavity_worst
      <th>concave points_worst
      <th>symmetry_worst
      <th>fractal_dimension_worst
    
  
  
    <tr>
      <th>0
      <td>842302
      <td>M
      <td>17.99
      <td>10.38
      <td>122.80
      <td>1001.0
      <td>0.11840
      <td>0.27760
      <td>0.30010
      <td>0.14710
      <td>...
      <td>25.380
      <td>17.33
      <td>184.60
      <td>2019.0
      <td>0.16220
      <td>0.66560
      <td>0.7119
      <td>0.2654
      <td>0.4601
      <td>0.11890
    
    <tr>
      <th>1
      <td>842517
      <td>M
      <td>20.57
      <td>17.77
      <td>132.90
      <td>1326.0
      <td>0.08474
      <td>0.07864
      <td>0.08690
      <td>0.07017
      <td>...
      <td>24.990
      <td>23.41
      <td>158.80
      <td>1956.0
      <td>0.12380
      <td>0.18660
      <td>0.2416
      <td>0.1860
      <td>0.2750
      <td>0.08902
    
    <tr>
      <th>2
      <td>84300903
      <td>M
      <td>19.69
      <td>21.25
      <td>130.00
      <td>1203.0
      <td>0.10960
      <td>0.15990
      <td>0.19740
      <td>0.12790
      <td>...
      <td>23.570
      <td>25.53
      <td>152.50
      <td>1709.0
      <td>0.14440
      <td>0.42450
      <td>0.4504
      <td>0.2430
      <td>0.3613
      <td>0.08758
    
    <tr>
      <th>3
      <td>84348301
      <td>M
      <td>11.42
      <td>20.38
      <td>77.58
      <td>386.1
      <td>0.14250
      <td>0.28390
      <td>0.24140
      <td>0.10520
      <td>...
      <td>14.910
      <td>26.50
      <td>98.87
      <td>567.7
      <td>0.20980
      <td>0.86630
      <td>0.6869
      <td>0.2575
      <td>0.6638
      <td>0.17300
    
    <tr>
      <th>4
      <td>84358402
      <td>M
      <td>20.29
      <td>14.34
      <td>135.10
      <td>1297.0
      <td>0.10030
      <td>0.13280
      <td>0.19800
      <td>0.10430
      <td>...
      <td>22.540
      <td>16.67
      <td>152.20
      <td>1575.0
      <td>0.13740
      <td>0.20500
      <td>0.4000
      <td>0.1625
      <td>0.2364
      <td>0.07678
    
    <tr>
      <th>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
      <td>...
    
    <tr>
      <th>564
      <td>926424
      <td>M
      <td>21.56
      <td>22.39
      <td>142.00
      <td>1479.0
      <td>0.11100
      <td>0.11590
      <td>0.24390
      <td>0.13890
      <td>...
      <td>25.450
      <td>26.40
      <td>166.10
      <td>2027.0
      <td>0.14100
      <td>0.21130
      <td>0.4107
      <td>0.2216
      <td>0.2060
      <td>0.07115
    
    <tr>
      <th>565
      <td>926682
      <td>M
      <td>20.13
      <td>28.25
      <td>131.20
      <td>1261.0
      <td>0.09780
      <td>0.10340
      <td>0.14400
      <td>0.09791
      <td>...
      <td>23.690
      <td>38.25
      <td>155.00
      <td>1731.0
      <td>0.11660
      <td>0.19220
      <td>0.3215
      <td>0.1628
      <td>0.2572
      <td>0.06637
    
    <tr>
      <th>566
      <td>926954
      <td>M
      <td>16.60
      <td>28.08
      <td>108.30
      <td>858.1
      <td>0.08455
      <td>0.10230
      <td>0.09251
      <td>0.05302
      <td>...
      <td>18.980
      <td>34.12
      <td>126.70
      <td>1124.0
      <td>0.11390
      <td>0.30940
      <td>0.3403
      <td>0.1418
      <td>0.2218
      <td>0.07820
    
    <tr>
      <th>567
      <td>927241
      <td>M
      <td>20.60
      <td>29.33
      <td>140.10
      <td>1265.0
      <td>0.11780
      <td>0.27700
      <td>0.35140
      <td>0.15200
      <td>...
      <td>25.740
      <td>39.42
      <td>184.60
      <td>1821.0
      <td>0.16500
      <td>0.86810
      <td>0.9387
      <td>0.2650
      <td>0.4087
      <td>0.12400
    
    <tr>
      <th>568
      <td>92751
      <td>B
      <td>7.76
      <td>24.54
      <td>47.92
      <td>181.0
      <td>0.05263
      <td>0.04362
      <td>0.00000
      <td>0.00000
      <td>...
      <td>9.456
      <td>30.37
      <td>59.16
      <td>268.6
      <td>0.08996
      <td>0.06444
      <td>0.0000
      <td>0.0000
      <td>0.2871
      <td>0.07039
    
  
</table>
<p>569 rows × 32 columns</p>
</div>

<pre><code class="python hljs"><span class=hljs-comment ># ・diagnosis: 診断結果 (良性がB / 悪性がM)</span>
<span class=hljs-comment ># ・説明変数は 3列以降、目的変数を2列目としロジスティック回帰で分類</span>

<span class=hljs-comment ># 目的変数の抽出</span>
y = cancer_df.diagnosis.apply(<span class=hljs-keyword >lambda</span> d: <span class=hljs-number >1</span> <span class=hljs-keyword >if</span> d == <span class=hljs-string >&#x27;M&#x27;</span> <span class=hljs-keyword >else</span> <span class=hljs-number >0</span>)

<span class=hljs-comment ># 説明変数の抽出</span>
X = cancer_df.loc[:, <span class=hljs-string >&#x27;radius_mean&#x27;</span>:]</code></pre>
<p>まずは、すべての説明変数を用いたロジスティック回帰で分類問題をといてみる。_ 検証スコア97で分類できた。</p>
<pre><code class="python hljs"><span class=hljs-comment ># 学習用とテスト用でデータを分離</span>
X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=<span class=hljs-number >0</span>)

<span class=hljs-comment ># 標準化</span>
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)
X_test_scaled = scaler.transform(X_test)

<span class=hljs-comment ># ロジスティック回帰で学習</span>
<span class=hljs-comment >#  https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegressionCV.html</span>
<span class=hljs-comment ># cv : 指定した cross validator によって、hyper parameter を自動で選択</span>
<span class=hljs-comment >#  int値が指定されたときは、指定された分割数で、 k-fold cross validation を行う. </span>
logistic = LogisticRegressionCV(cv=<span class=hljs-number >10</span>, random_state=<span class=hljs-number >0</span>, max_iter=<span class=hljs-number >200</span>) <span class=hljs-comment ># 100回だと収束条件を満たす前に終わってしまったようなので増やした　</span>
logistic.fit(X_train_scaled, y_train)

<span class=hljs-comment ># 検証</span>
<span class=hljs-built_in >print</span>(<span class=hljs-string >&#x27;Train score: {:.3f}&#x27;</span>.<span class=hljs-built_in >format</span>(logistic.score(X_train_scaled, y_train)))
<span class=hljs-built_in >print</span>(<span class=hljs-string >&#x27;Test score: {:.3f}&#x27;</span>.<span class=hljs-built_in >format</span>(logistic.score(X_test_scaled, y_test)))
<span class=hljs-built_in >print</span>(<span class=hljs-string >&#x27;Confustion matrix:\n{}&#x27;</span>.<span class=hljs-built_in >format</span>(confusion_matrix(y_true=y_test, y_pred=logistic.predict(X_test_scaled))))</code></pre>
<p>Train score: 0.988
Test score: 0.972
Confustion matrix:
&#91;&#91;89  1&#93;
 &#91; 3 50&#93;&#93;</p>
<p>つぎに、PCAによる次元圧縮を行った上で精度を落とさずに分類問題を解けるか? やってみる 各主成分の寄与率は下図の通り。第四主成分くらいまでで、寄与率8割になるので、そのあたりがいいところか?</p>
<pre><code class="python hljs">pca = PCA(n_components=<span class=hljs-number >30</span>)
pca.fit(X_train_scaled)
plt.bar([n <span class=hljs-keyword >for</span> n <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-number >1</span>, <span class=hljs-built_in >len</span>(pca.explained_variance_ratio_)+<span class=hljs-number >1</span>)], pca.explained_variance_ratio_)</code></pre>
<p>&lt;BarContainer object of 30 artists&gt;</p>
<p><img src="/assets/skl_pca_files/skl_pca_13_1.svg" alt=svg  /></p>
<p>次元圧縮後の特徴量空間上でのサンプルの分布を直接みることも可能だ。 わかりやすさのために、第二主成分までを使ってやってみる。 &#40; numpy 実装を試してみたが、sklearnと同様の結果になることが確認できた。&#41;</p>
<pre><code class="python hljs"><span class=hljs-comment ># PCA</span>
<span class=hljs-comment ># 次元数2まで圧縮</span>
pca = PCA(n_components=<span class=hljs-number >2</span>)
X_train_pca = pca.fit_transform(X_train_scaled)
<span class=hljs-built_in >print</span>(<span class=hljs-string >&#x27;X_train_pca shape: {}&#x27;</span>.<span class=hljs-built_in >format</span>(X_train_pca.shape))
<span class=hljs-comment ># X_train_pca shape: (426, 2)</span>

<span class=hljs-comment ># 寄与率</span>
<span class=hljs-built_in >print</span>(<span class=hljs-string >&#x27;explained variance ratio: {}&#x27;</span>.<span class=hljs-built_in >format</span>(pca.explained_variance_ratio_))
<span class=hljs-comment ># explained variance ratio: [ 0.43315126  0.19586506]</span>

<span class=hljs-comment ># 散布図にプロット</span>
temp = pd.DataFrame(X_train_pca)
temp[<span class=hljs-string >&#x27;Outcome&#x27;</span>] = y_train.values
b = temp[temp[<span class=hljs-string >&#x27;Outcome&#x27;</span>] == <span class=hljs-number >0</span>]
m = temp[temp[<span class=hljs-string >&#x27;Outcome&#x27;</span>] == <span class=hljs-number >1</span>]
plt.scatter(x=b[<span class=hljs-number >0</span>], y=b[<span class=hljs-number >1</span>], marker=<span class=hljs-string >&#x27;o&#x27;</span>) <span class=hljs-comment ># 良性は○でマーク</span>
plt.scatter(x=m[<span class=hljs-number >0</span>], y=m[<span class=hljs-number >1</span>], marker=<span class=hljs-string >&#x27;^&#x27;</span>) <span class=hljs-comment ># 悪性は△でマーク</span>
plt.xlabel(<span class=hljs-string >&#x27;PC 1&#x27;</span>) <span class=hljs-comment ># 第1主成分をx軸</span>
plt.ylabel(<span class=hljs-string >&#x27;PC 2&#x27;</span>) <span class=hljs-comment ># 第2主成分をy軸</span></code></pre>
<p>X_train_pca shape: &#40;426, 2&#41;
explained variance ratio: &#91;0.43315126 0.19586506&#93;





Text&#40;0, 0.5, &#39;PC 2&#39;&#41;</p>
<p><img src="/assets/skl_pca_files/skl_pca_15_2.svg" alt=svg  /></p>
<pre><code class="python hljs"><span class=hljs-comment ># PCA の numpy 実装をためしてみる</span>
n_components=<span class=hljs-number >2</span>

<span class=hljs-keyword >def</span> <span class="hljs-title function_">get_moments</span>(<span class=hljs-params >X</span>):
    mean = X.mean(axis=<span class=hljs-number >0</span>)
    stan_cov = np.dot((X - mean).T, X - mean) / (<span class=hljs-built_in >len</span>(X) - <span class=hljs-number >1</span>)
    <span class=hljs-keyword >return</span> mean, stan_cov
    
<span class=hljs-keyword >def</span> <span class="hljs-title function_">get_components</span>(<span class=hljs-params >eigenvectors, n_components</span>):
    <span class=hljs-comment ># 固有ベクトル・固有値両方 昇順なので、逆転させるてから、取り出す</span>
    W = eigenvectors[:, ::-<span class=hljs-number >1</span>][:, :n_components]
    <span class=hljs-keyword >return</span> W.T

<span class=hljs-keyword >def</span> <span class="hljs-title function_">transform_by_pca</span>(<span class=hljs-params >X, pca</span>):
    mean = X.mean(axis=<span class=hljs-number >0</span>)
    <span class=hljs-keyword >return</span> np.dot(X-mean, pca)

<span class=hljs-comment >## 実際にやってみる</span>
n_components = <span class=hljs-number >2</span>
mean, stan_cov = get_moments(X_train_scaled)
eigenvalues, eigenvectors = np.linalg.eigh(stan_cov)
components = get_components(eigenvectors, n_components)

X_train_pca_np = transform_by_pca(X_train_scaled, -components.T) <span class=hljs-comment >## sklearn の結果と合わせるために符号を逆にした</span>

<span class=hljs-comment ># 散布図にプロット</span>
temp = pd.DataFrame(X_train_pca_np)
temp[<span class=hljs-string >&#x27;Outcome&#x27;</span>] = y_train.values
b = temp[temp[<span class=hljs-string >&#x27;Outcome&#x27;</span>] == <span class=hljs-number >0</span>]
m = temp[temp[<span class=hljs-string >&#x27;Outcome&#x27;</span>] == <span class=hljs-number >1</span>]
plt.scatter(x=b[<span class=hljs-number >0</span>], y=b[<span class=hljs-number >1</span>], marker=<span class=hljs-string >&#x27;o&#x27;</span>) <span class=hljs-comment ># 良性は○でマーク</span>
plt.scatter(x=m[<span class=hljs-number >0</span>], y=m[<span class=hljs-number >1</span>], marker=<span class=hljs-string >&#x27;^&#x27;</span>) <span class=hljs-comment ># 悪性は△でマーク</span>
plt.xlabel(<span class=hljs-string >&#x27;PC 1&#x27;</span>) <span class=hljs-comment ># 第1主成分をx軸</span>
plt.ylabel(<span class=hljs-string >&#x27;PC 2&#x27;</span>) <span class=hljs-comment ># 第2主成分をy軸</span></code></pre>
<p>Text&#40;0, 0.5, &#39;PC 2&#39;&#41;</p>
<p><img src="/assets/skl_pca_files/skl_pca_16_1.svg" alt=svg  /></p>
<p>さほど時間のかかる計算ではないので、第何主成分まで使うとどれくらいの精度、というのを虱潰しにためしてみる。 実際には問題の要求される精度や、演算量制約にもよるのだが、ざっくり寄与率から判断した第4主成分あたりまで使う、というのは悪くない選択に思われる。</p>
<pre><code class="python hljs"><span class=hljs-keyword >import</span> numpy <span class=hljs-keyword >as</span> np
train_scores = np.zeros(<span class=hljs-number >30</span>) 
test_scores = np.zeros(<span class=hljs-number >30</span>)

<span class=hljs-keyword >for</span> k <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-number >1</span>,<span class=hljs-number >31</span>):
    pca = PCA(n_components=k)
    pca.fit(X_train_scaled)

    X_train_pca = pca.transform(X_train_scaled)
    X_test_pca  = pca.transform(X_test_scaled)

    logistic2 = LogisticRegressionCV(cv=<span class=hljs-number >10</span>, random_state=<span class=hljs-number >0</span>, max_iter=<span class=hljs-number >500</span>) <span class=hljs-comment ># 100回だと収束条件を満たす前に終わってしまったようなので増やした　</span>
    logistic2.fit(X_train_pca, y_train)

    <span class=hljs-comment ># 検証</span>
    train_scores[k-<span class=hljs-number >1</span>] = logistic2.score(X_train_pca, y_train)
    test_scores[k-<span class=hljs-number >1</span>]  = logistic2.score(X_test_pca, y_test)
    <span class=hljs-comment ># print(&#x27;----------------------------&#x27;)</span>
    <span class=hljs-comment ># print(&#x27;n_components: %d&#x27; % ( k ))</span>
    <span class=hljs-comment ># print(&#x27;Train score: {:.3f}&#x27;.format(train_scores[k-1]))</span>
    <span class=hljs-comment ># print(&#x27;Test score: {:.3f}&#x27;.format(test_scores[k-1]))</span>
    <span class=hljs-comment ># print(&#x27;Confustion matrix:\n{}&#x27;.format(confusion_matrix(y_true=y_test, y_pred=logistic2.predict(X_test_pca))))</span></code></pre>
<pre><code class="python hljs">plt.figure(figsize=(<span class=hljs-number >8</span>,<span class=hljs-number >4</span>))
plt.plot(<span class=hljs-built_in >range</span>(<span class=hljs-number >30</span>), train_scores,label=<span class=hljs-string >&quot;train&quot;</span>)
plt.plot(<span class=hljs-built_in >range</span>(<span class=hljs-number >30</span>), test_scores,label=<span class=hljs-string >&quot;test&quot;</span>)
plt.legend()
plt.xlabel(<span class=hljs-string >&quot;the number of components used&quot;</span>)
plt.ylabel(<span class=hljs-string >&quot;score&quot;</span>)
plt.grid()</code></pre>
<p><img src="/assets/skl_pca_files/skl_pca_19_0.svg" alt=svg  />
<h2 id="k-nnmeans_法_レポート提出課題の_アルゴリズム_の単元に該当"><a href="#k-nnmeans_法_レポート提出課題の_アルゴリズム_の単元に該当" class=header-anchor >k-nn/means 法 &#40;レポート提出課題の &quot;アルゴリズム&quot; の単元に該当?&#41;</a></h2>
<h3 id="動画講義メモ要点のまとめ__5"><a href="#動画講義メモ要点のまとめ__5" class=header-anchor >動画講義メモ&#40;要点のまとめ&#41;</a></h3>
<ul>
<li><p>k近傍法  </p>
<ul>
<li><p>分類問題の機械学習手法</p>

<li><p>最近傍のデータをk個撮ってきて、それらがもっとも多く所属するクラスに識別</p>
<ul>
<li><p>ということは、2クラス分類なら、k は奇数にするということか</p>

</ul>

<li><p>k はハイパパラメータ</p>
<ul>
<li><p>k を大きくすると決定境界がなめらかになる&#40;多すぎると過学習気味&#41;</p>

</ul>

</ul>

<li><p>k-平均法&#40;k-means&#41; </p>
<ul>
<li><p>教師なし学習, クラスタリングを行う手法</p>

<li><p>アルゴリズム</p>
<ol>
<li><p>各クラスタについて、中心の初期値を設定</p>

<li><p>各データ点に対して、各クラスタ中心との距離を計算し、最も距離が近いクラスタを割り当てる</p>

<li><p>各クラスたの平均ベクトルを計算しあらたな中心とする</p>

<li><p>収束するまで2,3の処理を繰り返す</p>

</ol>

<li><p>初期値重要</p>
<ul>
<li><p>初期値を変えるとクラスタリング結果も変わりうる</p>
<ul>
<li><p>初期値が離れていたほうがいい?</p>

<li><p>cf. k-means&#43;&#43; &#40;試験でも出たらしい&#41;</p>

</ul>

<li><p>クラスタ数 k を変えてももちろん結果が変わる</p>

</ul>

</ul>

</ul>
<h3 id="ハンズオン__4"><a href="#ハンズオン__4" class=header-anchor >ハンズオン</a></h3></p>
<pre><code class="python hljs"><span class=hljs-keyword >import</span> numpy <span class=hljs-keyword >as</span> np
<span class=hljs-keyword >import</span> pandas <span class=hljs-keyword >as</span> pd
<span class=hljs-keyword >import</span> matplotlib.pyplot <span class=hljs-keyword >as</span> plt
%matplotlib inline
<span class=hljs-keyword >import</span> seaborn <span class=hljs-keyword >as</span> sns
<span class=hljs-keyword >from</span> sklearn.model_selection <span class=hljs-keyword >import</span> train_test_split
<span class=hljs-keyword >from</span> sklearn <span class=hljs-keyword >import</span> metrics
<span class=hljs-keyword >from</span> sklearn.metrics <span class=hljs-keyword >import</span> confusion_matrix

<span class=hljs-keyword >from</span> sklearn <span class=hljs-keyword >import</span> cluster, preprocessing, datasets
<span class=hljs-keyword >from</span> sklearn.cluster <span class=hljs-keyword >import</span> KMeans</code></pre>
<pre><code class="python hljs"><span class=hljs-comment >#https://datahexa.com/kmeans-clustering-with-wine-dataset</span>
wine = datasets.load_wine()
<span class=hljs-built_in >print</span>(wine[<span class=hljs-string >&quot;DESCR&quot;</span>])</code></pre>
<pre><code class="julia hljs">.. _wine_dataset:
    
    Wine recognition dataset
    ------------------------
    
    **Data <span class=hljs-built_in >Set</span> Characteristics:**
    
        :<span class=hljs-built_in >Number</span> of Instances: <span class=hljs-number >178</span> (<span class=hljs-number >50</span> <span class=hljs-keyword >in</span> each of three classes)
        :<span class=hljs-built_in >Number</span> of Attributes: <span class=hljs-number >13</span> numeric, predictive attributes and the class
        :Attribute Information:
     		- Alcohol
     		- Malic acid
     		- Ash
    		- Alcalinity of ash  
     		- Magnesium
    		- Total phenols
     		- Flavanoids
     		- Nonflavanoid phenols
     		- Proanthocyanins
    		- Color intensity
     		- Hue
     		- OD280/OD315 of diluted wines
     		- Proline
    
        - class:
                - class_0
                - class_1
                - class_2
    		
        :Summary Statistics:
        
        ============================= ==== ===== ======= =====
                                       Min   Max   Mean     SD
        ============================= ==== ===== ======= =====
        Alcohol:                      <span class=hljs-number >11.0</span>  <span class=hljs-number >14.8</span>    <span class=hljs-number >13.0</span>   <span class=hljs-number >0.8</span>
        Malic Acid:                   <span class=hljs-number >0.74</span>  <span class=hljs-number >5.80</span>    <span class=hljs-number >2.34</span>  <span class=hljs-number >1.12</span>
        Ash:                          <span class=hljs-number >1.36</span>  <span class=hljs-number >3.23</span>    <span class=hljs-number >2.36</span>  <span class=hljs-number >0.27</span>
        Alcalinity of Ash:            <span class=hljs-number >10.6</span>  <span class=hljs-number >30.0</span>    <span class=hljs-number >19.5</span>   <span class=hljs-number >3.3</span>
        Magnesium:                    <span class=hljs-number >70.0</span> <span class=hljs-number >162.0</span>    <span class=hljs-number >99.7</span>  <span class=hljs-number >14.3</span>
        Total Phenols:                <span class=hljs-number >0.98</span>  <span class=hljs-number >3.88</span>    <span class=hljs-number >2.29</span>  <span class=hljs-number >0.63</span>
        Flavanoids:                   <span class=hljs-number >0.34</span>  <span class=hljs-number >5.08</span>    <span class=hljs-number >2.03</span>  <span class=hljs-number >1.00</span>
        Nonflavanoid Phenols:         <span class=hljs-number >0.13</span>  <span class=hljs-number >0.66</span>    <span class=hljs-number >0.36</span>  <span class=hljs-number >0.12</span>
        Proanthocyanins:              <span class=hljs-number >0.41</span>  <span class=hljs-number >3.58</span>    <span class=hljs-number >1.59</span>  <span class=hljs-number >0.57</span>
        Colour Intensity:              <span class=hljs-number >1.3</span>  <span class=hljs-number >13.0</span>     <span class=hljs-number >5.1</span>   <span class=hljs-number >2.3</span>
        Hue:                          <span class=hljs-number >0.48</span>  <span class=hljs-number >1.71</span>    <span class=hljs-number >0.96</span>  <span class=hljs-number >0.23</span>
        OD280/OD315 of diluted wines: <span class=hljs-number >1.27</span>  <span class=hljs-number >4.00</span>    <span class=hljs-number >2.61</span>  <span class=hljs-number >0.71</span>
        Proline:                       <span class=hljs-number >278</span>  <span class=hljs-number >1680</span>     <span class=hljs-number >746</span>   <span class=hljs-number >315</span>
        ============================= ==== ===== ======= =====
    
        :<span class=hljs-built_in >Missing</span> Attribute Values: None
        :Class Distribution: class_0 (<span class=hljs-number >59</span>), class_1 (<span class=hljs-number >71</span>), class_2 (<span class=hljs-number >48</span>)
        :Creator: R.A. Fisher
        :Donor: Michael Marshall (MARSHALL%PLU<span class=hljs-meta >@io</span>.arc.nasa.gov)
        :Date: July, <span class=hljs-number >1988</span>
    
    This is a copy of UCI ML Wine recognition datasets.
    https://archive.ics.uci.edu/ml/machine-learning-databases/wine/wine.data
    
    The data is the results of a chemical analysis of wines grown <span class=hljs-keyword >in</span> the same
    region <span class=hljs-keyword >in</span> Italy by three different cultivators. There are thirteen different
    measurements taken <span class=hljs-keyword >for</span> different constituents found <span class=hljs-keyword >in</span> the three types of
    wine.
    
    Original Owners: 
    
    Forina, M. et al, PARVUS - 
    An Extendible Package <span class=hljs-keyword >for</span> Data Exploration, Classification and Correlation. 
    Institute of Pharmaceutical and Food Analysis and Technologies,
    Via Brigata Salerno, <span class=hljs-number >16147</span> Genoa, Italy.
    
    Citation:
    
    Lichman, M. (<span class=hljs-number >2013</span>). UCI Machine Learning Repository
    [https://archive.ics.uci.edu/ml]. Irvine, CA: University of California,
    School of Information and Computer Science. 
    
    .. topic:: References
    
      (<span class=hljs-number >1</span>) S. Aeberhard, D. Coomans and O. de Vel, 
      Comparison of Classifiers <span class=hljs-keyword >in</span> High Dimensional Settings, 
      Tech. Rep. no. <span class=hljs-number >92</span>-<span class=hljs-number >02</span>, (<span class=hljs-number >1992</span>), Dept. of Computer Science and Dept. of  
      Mathematics and Statistics, James Cook University of North Queensland. 
      (Also submitted to Technometrics). 
    
      The data was used with many others <span class=hljs-keyword >for</span> comparing various 
      classifiers. The classes are separable, though only RDA 
      has achieved <span class=hljs-number >100</span>% correct classification. 
      (RDA : <span class=hljs-number >100</span>%, QDA <span class=hljs-number >99.4</span>%, LDA <span class=hljs-number >98.9</span>%, <span class=hljs-number >1</span>NN <span class=hljs-number >96.1</span>% (z-transformed data)) 
      (All results <span class=hljs-keyword >using</span> the leave-one-out technique) 
    
      (<span class=hljs-number >2</span>) S. Aeberhard, D. Coomans and O. de Vel, 
      <span class=hljs-string >&quot;THE CLASSIFICATION PERFORMANCE OF RDA&quot;</span> 
      Tech. Rep. no. <span class=hljs-number >92</span>-<span class=hljs-number >01</span>, (<span class=hljs-number >1992</span>), Dept. of Computer Science and Dept. of 
      Mathematics and Statistics, James Cook University of North Queensland. 
      (Also submitted to Journal of Chemometrics).</code></pre>
<pre><code class="python hljs">df = pd.DataFrame(wine.data, columns=wine.feature_names)
df.head()</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border=1  class=dataframe >
  <thead>
    <tr style="text-align: right;">
      <th>
      <th>alcohol
      <th>malic_acid
      <th>ash
      <th>alcalinity_of_ash
      <th>magnesium
      <th>total_phenols
      <th>flavanoids
      <th>nonflavanoid_phenols
      <th>proanthocyanins
      <th>color_intensity
      <th>hue
      <th>od280/od315_of_diluted_wines
      <th>proline
    
  
  
    <tr>
      <th>0
      <td>14.23
      <td>1.71
      <td>2.43
      <td>15.6
      <td>127.0
      <td>2.80
      <td>3.06
      <td>0.28
      <td>2.29
      <td>5.64
      <td>1.04
      <td>3.92
      <td>1065.0
    
    <tr>
      <th>1
      <td>13.20
      <td>1.78
      <td>2.14
      <td>11.2
      <td>100.0
      <td>2.65
      <td>2.76
      <td>0.26
      <td>1.28
      <td>4.38
      <td>1.05
      <td>3.40
      <td>1050.0
    
    <tr>
      <th>2
      <td>13.16
      <td>2.36
      <td>2.67
      <td>18.6
      <td>101.0
      <td>2.80
      <td>3.24
      <td>0.30
      <td>2.81
      <td>5.68
      <td>1.03
      <td>3.17
      <td>1185.0
    
    <tr>
      <th>3
      <td>14.37
      <td>1.95
      <td>2.50
      <td>16.8
      <td>113.0
      <td>3.85
      <td>3.49
      <td>0.24
      <td>2.18
      <td>7.80
      <td>0.86
      <td>3.45
      <td>1480.0
    
    <tr>
      <th>4
      <td>13.24
      <td>2.59
      <td>2.87
      <td>21.0
      <td>118.0
      <td>2.80
      <td>2.69
      <td>0.39
      <td>1.82
      <td>4.32
      <td>1.04
      <td>2.93
      <td>735.0
    
  
</table>
</div>

<pre><code class="python hljs">df.describe()</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border=1  class=dataframe >
  <thead>
    <tr style="text-align: right;">
      <th>
      <th>alcohol
      <th>malic_acid
      <th>ash
      <th>alcalinity_of_ash
      <th>magnesium
      <th>total_phenols
      <th>flavanoids
      <th>nonflavanoid_phenols
      <th>proanthocyanins
      <th>color_intensity
      <th>hue
      <th>od280/od315_of_diluted_wines
      <th>proline
    
  
  
    <tr>
      <th>count
      <td>178.000000
      <td>178.000000
      <td>178.000000
      <td>178.000000
      <td>178.000000
      <td>178.000000
      <td>178.000000
      <td>178.000000
      <td>178.000000
      <td>178.000000
      <td>178.000000
      <td>178.000000
      <td>178.000000
    
    <tr>
      <th>mean
      <td>13.000618
      <td>2.336348
      <td>2.366517
      <td>19.494944
      <td>99.741573
      <td>2.295112
      <td>2.029270
      <td>0.361854
      <td>1.590899
      <td>5.058090
      <td>0.957449
      <td>2.611685
      <td>746.893258
    
    <tr>
      <th>std
      <td>0.811827
      <td>1.117146
      <td>0.274344
      <td>3.339564
      <td>14.282484
      <td>0.625851
      <td>0.998859
      <td>0.124453
      <td>0.572359
      <td>2.318286
      <td>0.228572
      <td>0.709990
      <td>314.907474
    
    <tr>
      <th>min
      <td>11.030000
      <td>0.740000
      <td>1.360000
      <td>10.600000
      <td>70.000000
      <td>0.980000
      <td>0.340000
      <td>0.130000
      <td>0.410000
      <td>1.280000
      <td>0.480000
      <td>1.270000
      <td>278.000000
    
    <tr>
      <th>25%
      <td>12.362500
      <td>1.602500
      <td>2.210000
      <td>17.200000
      <td>88.000000
      <td>1.742500
      <td>1.205000
      <td>0.270000
      <td>1.250000
      <td>3.220000
      <td>0.782500
      <td>1.937500
      <td>500.500000
    
    <tr>
      <th>50%
      <td>13.050000
      <td>1.865000
      <td>2.360000
      <td>19.500000
      <td>98.000000
      <td>2.355000
      <td>2.135000
      <td>0.340000
      <td>1.555000
      <td>4.690000
      <td>0.965000
      <td>2.780000
      <td>673.500000
    
    <tr>
      <th>75%
      <td>13.677500
      <td>3.082500
      <td>2.557500
      <td>21.500000
      <td>107.000000
      <td>2.800000
      <td>2.875000
      <td>0.437500
      <td>1.950000
      <td>6.200000
      <td>1.120000
      <td>3.170000
      <td>985.000000
    
    <tr>
      <th>max
      <td>14.830000
      <td>5.800000
      <td>3.230000
      <td>30.000000
      <td>162.000000
      <td>3.880000
      <td>5.080000
      <td>0.660000
      <td>3.580000
      <td>13.000000
      <td>1.710000
      <td>4.000000
      <td>1680.000000
    
  
</table>
</div>

<pre><code class="python hljs">df.isnull().<span class=hljs-built_in >any</span>()</code></pre>
<pre><code class="julia hljs">alcohol                         False
    malic_acid                      False
    ash                             False
    alcalinity_of_ash               False
    magnesium                       False
    total_phenols                   False
    flavanoids                      False
    nonflavanoid_phenols            False
    proanthocyanins                 False
    color_intensity                 False
    hue                             False
    od280/od315_of_diluted_wines    False
    proline                         False
    dtype: bool</code></pre>
<pre><code class="python hljs">X=wine.data
y=wine.target

X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=<span class=hljs-number >0.3</span>, random_state=<span class=hljs-number >55</span>)</code></pre>
<pre><code class="python hljs"><span class=hljs-keyword >def</span> <span class="hljs-title function_">species_label</span>(<span class=hljs-params >theta</span>):
    <span class=hljs-keyword >if</span> theta == <span class=hljs-number >0</span>:
        <span class=hljs-keyword >return</span> wine.target_names[<span class=hljs-number >0</span>]
    <span class=hljs-keyword >if</span> theta == <span class=hljs-number >1</span>:
        <span class=hljs-keyword >return</span> wine.target_names[<span class=hljs-number >1</span>]
    <span class=hljs-keyword >if</span> theta == <span class=hljs-number >2</span>:
        <span class=hljs-keyword >return</span> wine.target_names[<span class=hljs-number >2</span>]

<span class=hljs-built_in >print</span>(wine.target_names)
y_label = [species_label(theta) <span class=hljs-keyword >for</span> theta <span class=hljs-keyword >in</span> wine.target]
df[<span class=hljs-string >&#x27;species&#x27;</span>]=y_label</code></pre>
<p>&#91;&#39;class_0&#39; &#39;class_1&#39; &#39;class_2&#39;&#93;</p>
<pre><code class="python hljs"><span class=hljs-keyword >def</span> <span class="hljs-title function_">plot_confusion_matrix</span>(<span class=hljs-params >cm,title</span>):
    fig = plt.figure(figsize = (<span class=hljs-number >7</span>,<span class=hljs-number >7</span>))
    plt.title(title)
    sns.heatmap(
        cm,
        vmin=<span class=hljs-literal >None</span>,
        vmax=<span class=hljs-literal >None</span>,
        cmap=<span class=hljs-string >&quot;Blues&quot;</span>,
        center=<span class=hljs-literal >None</span>,
        robust=<span class=hljs-literal >False</span>,
        annot=<span class=hljs-literal >True</span>, fmt=<span class=hljs-string >&#x27;.2g&#x27;</span>,
        annot_kws=<span class=hljs-literal >None</span>,
        linewidths=<span class=hljs-number >0</span>,
        linecolor=<span class=hljs-string >&#x27;white&#x27;</span>,
        cbar=<span class=hljs-literal >True</span>,
        cbar_kws=<span class=hljs-literal >None</span>,
        cbar_ax=<span class=hljs-literal >None</span>,
        square=<span class=hljs-literal >True</span>, ax=<span class=hljs-literal >None</span>, 
        <span class=hljs-comment >#xticklabels=columns,</span>
        <span class=hljs-comment >#yticklabels=columns,</span>
        mask=<span class=hljs-literal >None</span>)
    <span class=hljs-keyword >return</span></code></pre>
<h4 id="k-nn_で分類"><a href="#k-nn_で分類" class=header-anchor >k-nn で分類</a></h4>
<p>k-nn は学習のプロセスは無いが、識別のために事前にクラスが判明しているサンプルが必要。上で分割したデータを使って試してみる。 つまり、X<em>train, y</em>train の情報を用いて、X_test の各サンプルのクラスを判別する。</p>
<pre><code class="python hljs"><span class=hljs-keyword >from</span> scipy <span class=hljs-keyword >import</span> stats

<span class=hljs-keyword >def</span> <span class="hljs-title function_">distance</span>(<span class=hljs-params >x1, x2</span>):
    <span class=hljs-keyword >return</span> np.<span class=hljs-built_in >sum</span>((x1 - x2)**<span class=hljs-number >2</span>, axis=<span class=hljs-number >1</span>)

<span class=hljs-keyword >def</span> <span class="hljs-title function_">knc_predict</span>(<span class=hljs-params >n_neighbors, x_train, y_train, X_test</span>):
    y_pred = np.empty(<span class=hljs-built_in >len</span>(X_test), dtype=y_train.dtype)
    <span class=hljs-keyword >for</span> i, x <span class=hljs-keyword >in</span> <span class=hljs-built_in >enumerate</span>(X_test):
        distances = distance(x, X_train)
        nearest_index = distances.argsort()[:n_neighbors]
        mode, _ = stats.mode(y_train[nearest_index])
        y_pred[i] = mode
    <span class=hljs-keyword >return</span> y_pred

<span class=hljs-comment ># X_train, y_train のデータをつかって y_test の識別を行う</span>
n_neighbors = <span class=hljs-number >3</span>
y_pred = knc_predict(n_neighbors, X_train, y_train, X_test)

<span class=hljs-built_in >print</span>(metrics.classification_report(y_test, y_pred))
plot_confusion_matrix(confusion_matrix(y_test,y_pred),<span class=hljs-string >&quot;knn&quot;</span>)</code></pre>
<pre><code class="julia hljs">precision    recall  f1-score   support
    
               <span class=hljs-number >0</span>       <span class=hljs-number >0.87</span>      <span class=hljs-number >1.00</span>      <span class=hljs-number >0.93</span>        <span class=hljs-number >13</span>
               <span class=hljs-number >1</span>       <span class=hljs-number >0.74</span>      <span class=hljs-number >0.74</span>      <span class=hljs-number >0.74</span>        <span class=hljs-number >23</span>
               <span class=hljs-number >2</span>       <span class=hljs-number >0.69</span>      <span class=hljs-number >0.61</span>      <span class=hljs-number >0.65</span>        <span class=hljs-number >18</span>
    
        accuracy                           <span class=hljs-number >0.76</span>        <span class=hljs-number >54</span>
       <span class=hljs-keyword >macro</span> avg       <span class=hljs-number >0.76</span>      <span class=hljs-number >0.78</span>      <span class=hljs-number >0.77</span>        <span class=hljs-number >54</span>
    weighted avg       <span class=hljs-number >0.75</span>      <span class=hljs-number >0.76</span>      <span class=hljs-number >0.75</span>        <span class=hljs-number >54</span></code></pre>
<p><img src="/assets/skl_kmeans_files/skl_kmeans_10_1.svg" alt=svg  /></p>
<h4 id="k-means_クラスタリング"><a href="#k-means_クラスタリング" class=header-anchor >k-means クラスタリング</a></h4>
<p>k-means クラスタリングは、教師なしのクラスタリング手法として知られるので、まずはデータ全体に対してクラスタリングを試してみた。</p>
<p>numpy 実装、sklearn 実装ともに 同様のクラスタリング結果が得られたようだ &#40;k-means により割り当てられるクラスタの番号が、正解データの class 番号と一致する保証は全くないが、対角成分が最大になるように何度か実行した&#41;</p>
<pre><code class="python hljs"><span class=hljs-comment ># skelearn で　k-means</span>
model = KMeans(n_clusters=<span class=hljs-number >3</span>)
labels = model.fit_predict(X) 

df[<span class=hljs-string >&#x27;species_sklearn&#x27;</span>] = labels
pd.crosstab(df[<span class=hljs-string >&#x27;species_sklearn&#x27;</span>], df[<span class=hljs-string >&#x27;species&#x27;</span>])</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border=1  class=dataframe >
  <thead>
    <tr style="text-align: right;">
      <th>species
      <th>class_0
      <th>class_1
      <th>class_2
    
    <tr>
      <th>species_sklearn
      <th>
      <th>
      <th>
    
  
  
    <tr>
      <th>0
      <td>46
      <td>1
      <td>0
    
    <tr>
      <th>1
      <td>0
      <td>50
      <td>19
    
    <tr>
      <th>2
      <td>13
      <td>20
      <td>29
    
  
</table>
</div>

<pre><code class="python hljs"><span class=hljs-comment ># numpy 実装の k-means</span>
<span class=hljs-comment ># distance 関数は k-nn で定義したものがそのまま使い回せる</span>
<span class=hljs-comment >#  毎イタレーションで 配列を確保して速度的には効率が悪いが目をつぶる</span>

<span class=hljs-keyword >def</span> <span class="hljs-title function_">predict</span>(<span class=hljs-params >x, centers, n_clusters</span>):
    D = np.zeros((<span class=hljs-built_in >len</span>(x), n_clusters))
    <span class=hljs-keyword >for</span> i, x <span class=hljs-keyword >in</span> <span class=hljs-built_in >enumerate</span>(x):
        D[i] = distance(x, centers)
        cluster_index = np.argmin(D, axis=<span class=hljs-number >1</span>)
    <span class=hljs-keyword >return</span> cluster_index

<span class=hljs-keyword >def</span> <span class="hljs-title function_">fit</span>(<span class=hljs-params >x, cluster_index, n_clusters</span>):
    centers = np.zeros( (n_clusters,x.shape[<span class=hljs-number >1</span>]) )
    <span class=hljs-comment ># 3) 各クラスタの平均ベクトル（中心）を計算する</span>
    <span class=hljs-keyword >for</span> k <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(n_clusters):
        index_k = cluster_index == k
        centers[k] = np.mean(x[index_k], axis=<span class=hljs-number >0</span>)
    <span class=hljs-keyword >return</span> centers

n_clusters = <span class=hljs-number >3</span>
iter_max = <span class=hljs-number >100</span>

<span class=hljs-comment ># 1) 各クラスタ中心の初期値を設定する ここでは ランダム</span>
centers = X[np.random.choice(<span class=hljs-built_in >len</span>(X), n_clusters, replace=<span class=hljs-literal >False</span>)]
<span class=hljs-keyword >for</span> _ <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(iter_max):
    prev_centers = np.copy(centers)

    <span class=hljs-comment ># 2) 各データ点に対して、各クラスタ中心との距離を計算し、最も距離が近いクラスタを割り当てる</span>
    cluster_index = predict(X, centers, n_clusters)

    <span class=hljs-comment ># 3) 各クラスタの平均ベクトル（中心）を計算する</span>
    centers = fit(X, cluster_index, n_clusters)

    <span class=hljs-comment ># 4) 収束するまで2, 3の処理を繰り返す    </span>
    <span class=hljs-keyword >if</span> np.allclose(prev_centers, centers):
        <span class=hljs-keyword >break</span>

<span class=hljs-comment ># </span>
df[<span class=hljs-string >&#x27;species_np&#x27;</span>] = predict(X,centers,n_clusters)
pd.crosstab(df[<span class=hljs-string >&#x27;species_np&#x27;</span>], df[<span class=hljs-string >&#x27;species&#x27;</span>])</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border=1  class=dataframe >
  <thead>
    <tr style="text-align: right;">
      <th>species
      <th>class_0
      <th>class_1
      <th>class_2
    
    <tr>
      <th>species_np
      <th>
      <th>
      <th>
    
  
  
    <tr>
      <th>0
      <td>46
      <td>1
      <td>0
    
    <tr>
      <th>1
      <td>0
      <td>50
      <td>19
    
    <tr>
      <th>2
      <td>13
      <td>20
      <td>29
    
  
</table>
</div>

<pre><code class="python hljs"><span class=hljs-comment ># クラスタリング結果の比較</span>
pd.crosstab(df[<span class=hljs-string >&#x27;species_np&#x27;</span>], df[<span class=hljs-string >&#x27;species_sklearn&#x27;</span>])

<span class=hljs-comment ># 各クラスのセントロイド間の ユークリッド距離</span>
<span class=hljs-built_in >print</span>(distance(model.cluster_centers_, centers))</code></pre>
<p>&#91;2.20190800e-28 1.29254120e-26 2.32245581e-28&#93;</p>
<p>ちょっとナンセンスな気もするが、あえて教師あり学習することも可能なのでやってみる。</p>
<pre><code class="python hljs">centers_train = fit(X_train, y_train, n_clusters)
y_pred_kmeans = predict(X_test, centers_train, n_clusters)

<span class=hljs-built_in >print</span>(metrics.classification_report(y_test, y_pred_kmeans))
plot_confusion_matrix(confusion_matrix(y_test,y_pred_kmeans),<span class=hljs-string >&quot;k-means&quot;</span>)</code></pre>
<pre><code class="julia hljs">precision    recall  f1-score   support
    
               <span class=hljs-number >0</span>       <span class=hljs-number >0.86</span>      <span class=hljs-number >0.92</span>      <span class=hljs-number >0.89</span>        <span class=hljs-number >13</span>
               <span class=hljs-number >1</span>       <span class=hljs-number >0.74</span>      <span class=hljs-number >0.87</span>      <span class=hljs-number >0.80</span>        <span class=hljs-number >23</span>
               <span class=hljs-number >2</span>       <span class=hljs-number >0.77</span>      <span class=hljs-number >0.56</span>      <span class=hljs-number >0.65</span>        <span class=hljs-number >18</span>
    
        accuracy                           <span class=hljs-number >0.78</span>        <span class=hljs-number >54</span>
       <span class=hljs-keyword >macro</span> avg       <span class=hljs-number >0.79</span>      <span class=hljs-number >0.78</span>      <span class=hljs-number >0.78</span>        <span class=hljs-number >54</span>
    weighted avg       <span class=hljs-number >0.78</span>      <span class=hljs-number >0.78</span>      <span class=hljs-number >0.77</span>        <span class=hljs-number >54</span></code></pre>
<p><img src="/assets/skl_kmeans_files/skl_kmeans_16_1.svg" alt=svg  />
<h2 id="サポートベクターマシンsvm"><a href="#サポートベクターマシンsvm" class=header-anchor >サポートベクターマシン&#40;SVM&#41;</a></h2>
<h3 id="動画講義メモ要点のまとめ__6"><a href="#動画講義メモ要点のまとめ__6" class=header-anchor >動画講義メモ&#40;要点のまとめ&#41;</a></h3>
<ul>
<li><p>2クラス分類を解くための教師あり学習の手法</p>
<ul>
<li><p>基本の手法</p>
<ul>
<li><p>線形判別を前提に境界面&#40;識別関数&#41;を直接的に求める</p>
<ul>
<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mrow><mi mathvariant=normal >s</mi><mi mathvariant=normal >i</mi><mi mathvariant=normal >g</mi><mi mathvariant=normal >n</mi></mrow><mo stretchy=false >(</mo><msup><mi mathvariant=bold-italic >w</mi><mi>T</mi></msup><mi mathvariant=bold-italic >x</mi><mo>+</mo><mi>b</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> t = \mathrm{sign} ( \bm{w}^T \bm{x} + b)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">s</span><span class="mord mathrm">i</span><span class="mord mathrm" style="margin-right:0.01389em;">g</span><span class="mord mathrm">n</span></span><span class=mopen >(</span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class=mclose >)</span></span></span></span> の取る値 &#43;1,-1 が分類クラスに対応</p>

</ul>

<li><p>問題設定: マージン&#40;境界面と境界面に最も近い点の距離&#41;が最大になるケース汎化性能が高い、という仮定で境界面を決める</p>
<ul>
<li><p>ということは、最終的に最近接点&#40;これをサポートベクターと呼ぶ&#41; のみが学習に必要ということになる</p>

<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold-italic >w</mi><mo separator=true >,</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">\bm{w}, b</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span></span></span></span> について &quot;最小化&quot;すべき目的関数: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mi mathvariant=normal >∣</mi><mi mathvariant=normal >∣</mi><mi mathvariant=bold-italic >w</mi><mi mathvariant=normal >∣</mi><msup><mi mathvariant=normal >∣</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\frac{1}{2} ||\bm{w} ||^{2}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.190108em;vertical-align:-0.345em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord >∣</span><span class=mord >∣</span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=mord >∣</span><span class=mord ><span class=mord >∣</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li><p>マージン最大の時、境界面から各クラスの最近接点までの距離は等しくなる &#40;どちらかに偏ると最大でなくなる&#41;</p>

<li><p>最近接点に対しては、<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub><mo stretchy=false >(</mo><msup><mi mathvariant=bold-italic >w</mi><mi>T</mi></msup><mi mathvariant=bold-italic >x</mi><mo>+</mo><mi>b</mi><mo stretchy=false >)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t_i (\bm{w}^T \bm{x} + b) = 1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> が成立</p>
<ul>
<li><p>右辺1 とすることで、<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold-italic >w</mi><mo separator=true >,</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">\bm{w}, b</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span></span></span></span> のスケールの任意性が取り除かれる</p>

</ul>

<li><p>上記2点から マージンは、<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mrow><mi mathvariant=normal >∣</mi><mi mathvariant=normal >∣</mi><mi mathvariant=bold-italic >w</mi><mi mathvariant=normal >∣</mi><mi mathvariant=normal >∣</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{|| \bm{w} ||}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.365108em;vertical-align:-0.52em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.845108em;"><span style="top:-2.655em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.02778em;">w</span></span></span><span class="mord mtight">∣</span><span class="mord mtight">∣</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> と分かる &#40;境界面の法線ベクトル <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold-italic >w</mi></mrow><annotation encoding="application/x-tex">\bm{w}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.44444em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span></span></span></span> への射影を使う&#41;</p>

<li><p>逆数にすれば最小化問題。問題が解きやすいように 2乗した上で 1/2 しておく </p>

</ul>

<li><p>制約条件: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub><mo stretchy=false >(</mo><msup><mi mathvariant=bold-italic >w</mi><mi>T</mi></msup><msub><mi mathvariant=bold-italic >x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo stretchy=false >)</mo><mo>≥</mo><mn>1</mn><mspace width=1em /><mo stretchy=false >(</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=true >,</mo><mn>2</mn><mo separator=true >,</mo><mo>⋯</mo><mtext> </mtext><mo separator=true >,</mo><mi>n</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> t_{i}(\bm{w}^T\bm{x}_{i} + b) \ge 1 \quad (i=1, 2, \cdots, n)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≥</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:1em;"></span><span class=mopen >(</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >2</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner >⋯</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class=mclose >)</span></span></span></span></p>
<ul>
<li><p>この制約条件は、問題の定義から自明</p>

</ul>

</ul>

<li><p>主問題 &lt;-&gt; 双対問題 &#40;結果だけ&#41;</p>
<ul>
<li><p>上記の問題設定は解きにくいので問題を解きやすい形に変換する。ここでは結果だけしめすと..</p>
<ul>
<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold-italic >a</mi></mrow><annotation encoding="application/x-tex">\bm{a}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.44444em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span></span></span></span> について&quot;最大化&quot; すべき目的関数 : <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent=true ><mi>L</mi><mo>~</mo></mover><mo stretchy=false >(</mo><mi mathvariant=bold-italic >a</mi><mo stretchy=false >)</mo><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>a</mi><mi>i</mi></msub><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>a</mi><mi>i</mi></msub><msub><mi>a</mi><mi>j</mi></msub><msub><mi>t</mi><mi>i</mi></msub><msub><mi>t</mi><mi>j</mi></msub><msubsup><mi mathvariant=bold-italic >x</mi><mi>i</mi><mi>T</mi></msubsup><msub><mi mathvariant=bold-italic >x</mi><mi>i</mi></msub><mo>=</mo><msup><mi mathvariant=bold-italic >a</mi><mi mathvariant=normal >T</mi></msup><mi mathvariant=bold >1</mi><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mi mathvariant=bold-italic >a</mi><mi mathvariant=normal >T</mi></msup><mi>H</mi><mi mathvariant=bold-italic >a</mi></mrow><annotation encoding="application/x-tex">\tilde{L}(\bm{a}) = \sum_{i=1}^{n} a_{i} - \frac{1}{2} \sum_{i=1}^{n} \sum_{j=1}^{n} a_{i} a_{j} t_{i} t_{j} \bm{x}_i^T \bm{x}_i = \bm{a}^{\mathrm{T}} \bm{1} - \frac{1}{2} \bm{a}^{\mathrm{T}} H \bm{a} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.1701899999999998em;vertical-align:-0.25em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9201899999999998em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">L</span></span></span><span style="top:-3.6023300000000003em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.22222em;"><span class=mord >~</span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.104002em;vertical-align:-0.29971000000000003em;"></span><span class=mop ><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.280926em;vertical-align:-0.43581800000000004em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mop ><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mop ><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-2.441336em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.258664em;"><span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.924661em;vertical-align:-0.08333em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">T</span></span></span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class="mord mathbf">1</span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.190108em;vertical-align:-0.345em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">T</span></span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span></span></span></span></p>

<li><p>制約条件: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant=bold-italic >a</mi><mi>T</mi></msup><mi mathvariant=bold-italic >t</mi><mo>=</mo><mn>0</mn><mo separator=true >,</mo><mspace width=1em /><msub><mi>a</mi><mi>i</mi></msub><mo>≥</mo><mn>0</mn><mtext> </mtext><mo stretchy=false >(</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=true >,</mo><mn>2</mn><mo separator=true >,</mo><mo>…</mo><mi>n</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\bm{a}^T \bm{t} = 0, \quad a_i \ge 0 \ (i=1,2,\ldots n) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8413309999999999em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class="mord boldsymbol">t</span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≥</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >0</span><span class=mspace > </span><span class=mopen >(</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >2</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner >…</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class=mclose >)</span></span></span></span></p>

<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold-italic >a</mi></mrow><annotation encoding="application/x-tex">\bm{a}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.44444em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span></span></span></span> と <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold-italic >w</mi><mo separator=true >,</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">\bm{w}, b</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span></span></span></span> の関係: </p>
<ul>
<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold-italic >w</mi><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>a</mi><mi>i</mi></msub><msub><mi>t</mi><mi>i</mi></msub><msub><mi mathvariant=bold-italic >x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex"> \bm{w} = \sum_{i=1}^{n} a_{i} t_{i} \bm{x}_{i}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.44444em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.104002em;vertical-align:-0.29971000000000003em;"></span><span class=mop ><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>

<li><p>境界面に最も近い点 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">s</span></span></span></span> に対して、<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mfrac><mn>1</mn><msub><mi>t</mi><mi>i</mi></msub></mfrac><mo stretchy=false >(</mo><msub><mi>t</mi><mi>s</mi></msub><mo>−</mo><msup><mi mathvariant=bold-italic >w</mi><mi>T</mi></msup><mi><msub><mi mathvariant=bold-italic >x</mi><mi mathvariant=bold-italic >s</mi></msub></mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> b =\frac{1}{t_i} (t_s - \bm{w}^T \bm{x_s})</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.2902079999999998em;vertical-align:-0.44509999999999994em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.845108em;"><span style="top:-2.655em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.44509999999999994em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord boldsymbol mtight">s</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span></p>

</ul>

<li><p>主問題と双対問題の変換は、ラグランジュ, KKT条件 等を用いた議論が必要だが、&quot;要点のまとめ&quot;としては割愛</p>

</ul>

<li><p>数値解法 &#40;ざっくりの理解&#41;</p>
<ul>
<li><p>基本的には勾配法</p>

<li><p>双対問題の目的関数の勾配つかって更新 &#40;最大化&#41;</p>
<ul>
<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold-italic >a</mi><mo>←</mo><mi mathvariant=bold-italic >a</mi><mo>+</mo><msub><mi>η</mi><mn>1</mn></msub><mo stretchy=false >(</mo><mi mathvariant=bold >1</mi><mo>−</mo><mi>H</mi><mi mathvariant=bold-italic >a</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\bm{a} \leftarrow \bm{a} + \eta_{1} (\bm{1} - H \bm{a})</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.44444em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >←</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class=mord ><span class="mord mathbf">1</span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span><span class=mclose >)</span></span></span></span></p>

</ul>

<li><p>等式制約条件の左辺&#61;0になるよう、こっちはこっちで勾配使って更新 &#40;最小化&#41;</p>
<ul>
<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold-italic >a</mi><mo>←</mo><mi mathvariant=bold-italic >a</mi><mo>−</mo><msub><mi>η</mi><mn>2</mn></msub><mo stretchy=false >(</mo><msup><mi mathvariant=bold-italic >a</mi><mi mathvariant=normal >T</mi></msup><mi mathvariant=bold-italic >t</mi><mo stretchy=false >)</mo><mi mathvariant=bold-italic >t</mi></mrow><annotation encoding="application/x-tex">\bm{a} \leftarrow \bm{a} - \eta_{2} (\bm{a}^{\mathrm{T}} \bm{t}) \bm{t}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.44444em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >←</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">T</span></span></span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class="mord boldsymbol">t</span></span></span><span class=mclose >)</span><span class=mord ><span class=mord ><span class="mord boldsymbol">t</span></span></span></span></span></span></p>

</ul>

<li><p>更新の途中で、<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a_i \ge 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7859700000000001em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≥</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> を満たさない場合は、無理やり0に射影する。</p>
<ul>
<li><p>非負制約は凸な集合なので、そんな悪いことは怒らないはず..</p>

</ul>

</ul>

</ul>

</ul>

<li><p>カーネル関数を使って判別関数を曲面にする</p>
<ul>
<li><p>線形判別できない場合も、<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy=false >(</mo><mi mathvariant=bold-italic >x</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\phi(\bm{x})</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class=mopen >(</span><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span><span class=mclose >)</span></span></span></span> と予め変換した別の特徴量空間に飛ばせばうまくいく?</p>
<ul>
<li><p>パット思いつくのは 単位円が境界となっているような場合? <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mi>ϕ</mi><mo stretchy=false >(</mo><mi mathvariant=bold-italic >x</mi><mo stretchy=false >)</mo><mo>=</mo><msubsup><mi>x</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>x</mi><mn>2</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">r = \phi(\bm{x}) = x_1^2 + x_2^2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class=mopen >(</span><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.0622159999999998em;vertical-align:-0.24810799999999997em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.0622159999999998em;vertical-align:-0.24810799999999997em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.24810799999999997em;"><span></span></span></span></span></span></span></span></span></span> と原点からの距離に変換してあげれば、<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex"> r = 1 </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> というめちゃくちゃシンプルな直線で判別できる</p>

<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi><mover accent=true ><mi mathvariant=bold-italic >x</mi><mo>~</mo></mover></mi><mi>i</mi></msub><mo>=</mo><mi>ϕ</mi><mo stretchy=false >(</mo><msub><mi mathvariant=bold-italic >x</mi><mi>i</mi></msub><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\bm{\tilde{x}}_i = \phi(\bm{x}_i)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85788em;vertical-align:-0.15em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.70788em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord boldsymbol">x</span></span></span><span style="top:-3.36344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.2875em;"><span class="mord mathbf">~</span></span></span></span></span></span></span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class=mopen >(</span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span> と変換してあげれば、定式化は基本のSVMと同じになるはず     </p>

</ul>

<li><p>式を展開していくと、必ず <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy=false >(</mo><msub><mi mathvariant=bold-italic >x</mi><mi>i</mi></msub><msup><mo stretchy=false >)</mo><mi>T</mi></msup><mi>ϕ</mi><mo stretchy=false >(</mo><msub><mi mathvariant=bold-italic >x</mi><mi>j</mi></msub><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\phi(\bm{x}_i)^T \phi(\bm{x}_j)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.1274389999999999em;vertical-align:-0.286108em;"></span><span class="mord mathnormal">ϕ</span><span class=mopen >(</span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">ϕ</span><span class=mopen >(</span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span> とまとまった形で現れる。これを 2サンプル間の類似度を計算する&quot;カーネル関数&quot; として使う。</p>
<ul>
<li><p>カーネルのサイズは、<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">ϕ</span></span></span></span> の次元数によらず、サンプル数で演算量が抑えられる</p>

<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\phi(x)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span></span> の設計・計算経由することなく、直接カーネル関数を扱える</p>
<ul>
<li><p>RBFカーネルに対応する <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>h</mi><mi>i</mi></mrow><annotation encoding="application/x-tex">phi</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span></span></span></span> は無限次元&#33; </p>

</ul>

</ul>

</ul>

<li><p>ソフトマージンSVM</p>
<ul>
<li><p>境界面できれいに2クラス分類できないときに、はみ出てしまうサンプルがあることを許容する</p>

<li><p>はみ出し具合: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ξ</mi><mi>i</mi></msub><mo>=</mo><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >x</mi></mrow><mo stretchy=false >(</mo><mn>1</mn><mo>−</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy=false >(</mo><msup><mi mathvariant=bold-italic >w</mi><mi>T</mi></msup><msub><mi mathvariant=bold-italic >x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo stretchy=false >)</mo><mo separator=true >,</mo><mn>0</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\xi_i = \mathrm{max} ( 1 - t_i (\bm{w}^T \bm{x}_i + b), 0 )</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.04601em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span><span class=mopen >(</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class=mclose >)</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >0</span><span class=mclose >)</span></span></span></span> として これをペナルティ項として元の目的関数に加える</p>

<li><p>元の問題設定:</p>
<ul>
<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>min</mtext><mrow><mi mathvariant=bold-italic >w</mi><mo separator=true >,</mo><mi>b</mi></mrow></msub><mspace width=2em /><mfrac><mn>1</mn><mn>2</mn></mfrac><mi mathvariant=normal >∣</mi><mi mathvariant=normal >∣</mi><mi mathvariant=bold-italic >w</mi><mi mathvariant=normal >∣</mi><msup><mi mathvariant=normal >∣</mi><mn>2</mn></msup><mo>+</mo><mi>C</mi><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>ξ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\text{min}_{\bm{w}, b} \qquad \frac{1}{2} || \bm{w} ||^{2} + C \sum_{i=1}^{n} \xi_{i}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.190108em;vertical-align:-0.345em;"></span><span class=mord ><span class="mord text"><span class=mord >min</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.02778em;">w</span></span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:2em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord >∣</span><span class=mord >∣</span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=mord >∣</span><span class=mord ><span class=mord >∣</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.104002em;vertical-align:-0.29971000000000003em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mop ><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.04601em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li><p>ペナルティ項の重み係数 C はハイパパラメータ</p>

</ul>

<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>subject to</mtext><mspace width=2em /><msub><mi>t</mi><mi>i</mi></msub><mo stretchy=false >(</mo><msup><mi mathvariant=bold-italic >w</mi><mi>T</mi></msup><msub><mi mathvariant=bold-italic >x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo stretchy=false >)</mo><mo>≥</mo><mn>1</mn><mo>−</mo><msub><mi>ξ</mi><mi>i</mi></msub><mspace width=1em /><mo stretchy=false >(</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=true >,</mo><mn>2</mn><mo separator=true >,</mo><mo>⋯</mo><mtext> </mtext><mo separator=true >,</mo><mi>n</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\text{subject to} \qquad  t_{i}(\bm{w}^T \bm{x}_{i} + b) \ge 1 - \xi_{i} \quad (i=1, 2, \cdots, n)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mord text"><span class=mord >subject to</span></span><span class=mspace  style="margin-right:2em;"></span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≥</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.72777em;vertical-align:-0.08333em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.04601em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:1em;"></span><span class=mopen >(</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >2</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner >⋯</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class=mclose >)</span></span></span></span></p>

</ul>

<li><p>双対問題</p>
<ul>
<li><p>基本は通常のSVMと同じ。ただし、</p>

<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">a</span></span></span></span> の非負制約が <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><msub><mi mathvariant=bold-italic >a</mi><mi>i</mi></msub><mo>≤</mo><mi>C</mi><mspace width=1em /><mo stretchy=false >(</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=true >,</mo><mn>2</mn><mo separator=true >,</mo><mo>…</mo><mo separator=true >,</mo><mi>n</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">0 \le \bm{a}_i \le C \quad (i=1,2,\ldots,n) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.78041em;vertical-align:-0.13597em;"></span><span class=mord >0</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.7859700000000001em;vertical-align:-0.15em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mspace  style="margin-right:1em;"></span><span class=mopen >(</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >2</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner >…</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class=mclose >)</span></span></span></span> になる</p>

</ul>

</ul>

</ul>

</ul>
<h3 id="ハンズオン__5"><a href="#ハンズオン__5" class=header-anchor >ハンズオン</a></h3></p>
<pre><code class="python hljs">%matplotlib inline
<span class=hljs-keyword >import</span> numpy <span class=hljs-keyword >as</span> np
<span class=hljs-keyword >import</span> matplotlib.pyplot <span class=hljs-keyword >as</span> plt</code></pre>
<h4 id="線形分離可能なケース"><a href="#線形分離可能なケース" class=header-anchor >線形分離可能なケース</a></h4>
<pre><code class="python hljs"><span class=hljs-keyword >def</span> <span class="hljs-title function_">fit</span>(<span class=hljs-params >X_train, t, n_iter=<span class=hljs-number >500</span>,  eta1=<span class=hljs-number >0.01</span>, eta2=<span class=hljs-number >0.001</span>, C=<span class=hljs-number >0</span></span>):
    K = X_train.dot(X_train.T) 
    H = np.outer(t, t) * K
    n_samples = <span class=hljs-built_in >len</span>(t)

    a = np.ones(n_samples) <span class=hljs-comment ># 初期値</span>
    <span class=hljs-keyword >for</span> _ <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(n_iter):
        grad = <span class=hljs-number >1</span> - H.dot(a)

        <span class=hljs-comment ># 基本の更新式</span>
        a += eta1 * grad
        <span class=hljs-comment ># 制約部分</span>
        a -= eta2 * a.dot(t) * t
        <span class=hljs-comment ># 未定定数 a が全部0以上というのは凸なので、</span>
        <span class=hljs-comment ># 無理やり射影してもまあ悪いことにはならない</span>
        <span class=hljs-keyword >if</span> C == <span class=hljs-number >0</span>:
            a = np.where(a &gt; <span class=hljs-number >0</span>, a, <span class=hljs-number >0</span>) 
        <span class=hljs-keyword >elif</span> C&gt;<span class=hljs-number >0</span>: <span class=hljs-comment ># ソフトマージンのときはここだけ違う</span>
            a = np.clip(a, <span class=hljs-number >0</span>, C)


    <span class=hljs-comment ># w,b を求める</span>
    index = a &gt; <span class=hljs-number >1e-6</span> <span class=hljs-comment ># epsilon</span>
    support_vectors = X_train[index]
    support_vector_t = t[index]
    support_vector_a = a[index]

    term2 = K[index][:, index].dot(support_vector_a * support_vector_t)
    b = (support_vector_t - term2).mean()
    
    w = np.zeros(X_train.shape[<span class=hljs-number >1</span>]) 
    <span class=hljs-keyword >for</span> a, sv_t, sv <span class=hljs-keyword >in</span> <span class=hljs-built_in >zip</span>(support_vector_a, support_vector_t, support_vectors):
        w += a * sv_t * sv

    <span class=hljs-keyword >return</span> w, b, support_vectors

<span class=hljs-keyword >def</span> <span class="hljs-title function_">predict</span>(<span class=hljs-params >X,w,b</span>):
    y_project = np.zeros(<span class=hljs-built_in >len</span>(X))
    <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-built_in >len</span>(X)):
         y_project[i] = w.dot(X[i]) + b
    <span class=hljs-keyword >return</span> np.sign(y_project), y_project</code></pre>
<pre><code class="python hljs"><span class=hljs-comment ># (2,2) と (-2,-2) の周辺にランダムに点を発生させる</span>
<span class=hljs-keyword >def</span> <span class="hljs-title function_">gen_data</span>():
    x0 = np.random.normal(size=<span class=hljs-number >50</span>).reshape(-<span class=hljs-number >1</span>, <span class=hljs-number >2</span>) - <span class=hljs-number >2.</span>
    x1 = np.random.normal(size=<span class=hljs-number >50</span>).reshape(-<span class=hljs-number >1</span>, <span class=hljs-number >2</span>) + <span class=hljs-number >2.</span>
    X_train = np.concatenate([x0, x1])
    ys_train = np.concatenate([np.zeros(<span class=hljs-number >25</span>), np.ones(<span class=hljs-number >25</span>)]).astype(np.<span class=hljs-built_in >int</span>)
    <span class=hljs-keyword >return</span> X_train, ys_train</code></pre>
<pre><code class="python hljs"><span class=hljs-comment ># -------- データ生成</span>
X_train, ys_train = gen_data()
<span class=hljs-comment ># plt.scatter(X_train[:, 0], X_train[:, 1], c=ys_train)</span>
t = np.where(ys_train == <span class=hljs-number >1.0</span>, <span class=hljs-number >1.0</span>, -<span class=hljs-number >1.0</span>)

<span class=hljs-comment ># --------- 学習</span>
w,b,support_vectors = fit(X_train,t)


<span class=hljs-comment ># --------- 学習結果の確認</span>
<span class=hljs-comment ># 領域可視化のために mesh 上の各点を入力データとして生成 </span>
xx0, xx1 = np.meshgrid(np.linspace(-<span class=hljs-number >5</span>, <span class=hljs-number >5</span>, <span class=hljs-number >100</span>), np.linspace(-<span class=hljs-number >5</span>, <span class=hljs-number >5</span>, <span class=hljs-number >100</span>))
xx = np.array([xx0, xx1]).reshape(<span class=hljs-number >2</span>, -<span class=hljs-number >1</span>).T
X_test = xx

y_pred, y_project = predict(X_test,w,b)

<span class=hljs-comment ># 訓練データを可視化</span>
plt.scatter(X_train[:, <span class=hljs-number >0</span>], X_train[:, <span class=hljs-number >1</span>], c=ys_train)

<span class=hljs-comment ># サポートベクトルを可視化</span>
plt.scatter(support_vectors[:, <span class=hljs-number >0</span>], support_vectors[:, <span class=hljs-number >1</span>],
                    s=<span class=hljs-number >100</span>, facecolors=<span class=hljs-string >&#x27;none&#x27;</span>, edgecolors=<span class=hljs-string >&#x27;k&#x27;</span>)

<span class=hljs-comment ># 領域を可視化</span>
plt.contourf(xx0, xx1, y_pred.reshape(<span class=hljs-number >100</span>, <span class=hljs-number >100</span>), alpha=<span class=hljs-number >0.2</span>, levels=np.linspace(<span class=hljs-number >0</span>, <span class=hljs-number >1</span>, <span class=hljs-number >3</span>))
<span class=hljs-comment ># マージンと決定境界を可視化</span>
plt.contour(xx0, xx1, y_project.reshape(<span class=hljs-number >100</span>, <span class=hljs-number >100</span>), colors=<span class=hljs-string >&#x27;k&#x27;</span>,
                     levels=[-<span class=hljs-number >1</span>, <span class=hljs-number >0</span>, <span class=hljs-number >1</span>], alpha=<span class=hljs-number >0.5</span>, linestyles=[<span class=hljs-string >&#x27;--&#x27;</span>, <span class=hljs-string >&#x27;-&#x27;</span>, <span class=hljs-string >&#x27;--&#x27;</span>])

<span class=hljs-comment ># マージンと決定境界を可視化</span>
plt.quiver(<span class=hljs-number >0</span>, <span class=hljs-number >0</span>, <span class=hljs-number >0.1</span>, <span class=hljs-number >0.35</span>, width=<span class=hljs-number >0.01</span>, scale=<span class=hljs-number >1</span>, color=<span class=hljs-string >&#x27;pink&#x27;</span>)</code></pre>
<p>&lt;matplotlib.quiver.Quiver at 0x7f1ce7904070&gt;</p>
<p><img src="/assets/np_svm_files/np_svm_5_1.svg" alt=SVG  /></p>
<h4 id="線形分離不可能なケース"><a href="#線形分離不可能なケース" class=header-anchor >線形分離不可能なケース</a></h4>
<p>元のデータ空間では線形分離は出来ないケースに対して、特徴空間上で線形分離することを考える。 今回はカーネルとしてRBFカーネル（ガウシアンカーネル）を利用する。</p>
<pre><code class="python hljs"><span class=hljs-keyword >def</span> <span class="hljs-title function_">fit_k</span>(<span class=hljs-params >K, X_train, t, n_iter=<span class=hljs-number >500</span>,  eta1=<span class=hljs-number >0.01</span>, eta2=<span class=hljs-number >0.001</span></span>):
    n_samples = <span class=hljs-built_in >len</span>(t)
    eta1 = <span class=hljs-number >0.01</span>
    eta2 = <span class=hljs-number >0.001</span>
    n_iter = <span class=hljs-number >5000</span>

    H = np.outer(t, t) * K
    <span class=hljs-comment ># a の学習</span>
    a = np.ones(n_samples)
    <span class=hljs-keyword >for</span> _ <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(n_iter):
        grad = <span class=hljs-number >1</span> - H.dot(a)
        a += eta1 * grad
        a -= eta2 * a.dot(t) * t
        a = np.where(a &gt; <span class=hljs-number >0</span>, a, <span class=hljs-number >0</span>)

    <span class=hljs-comment ># support vector の情報取得</span>
    index = a &gt; <span class=hljs-number >1e-6</span>
    support_vectors = X_train[index]
    support_vector_t = t[index]
    support_vector_a = a[index]

    <span class=hljs-comment ># b の計算</span>
    term2 = K[index][:, index].dot(support_vector_a * support_vector_t)
    b = (support_vector_t - term2).mean()

    <span class=hljs-keyword >return</span> a, b, support_vectors, support_vector_t, support_vector_a


<span class=hljs-keyword >def</span> <span class="hljs-title function_">predict_k</span>(<span class=hljs-params >X, b, support_vectors, support_vector_t, support_vector_a</span>):
    y_project = np.ones(<span class=hljs-built_in >len</span>(X)) * b
    <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-built_in >len</span>(X)):
        <span class=hljs-keyword >for</span> a, sv_t, sv <span class=hljs-keyword >in</span> <span class=hljs-built_in >zip</span>(support_vector_a, support_vector_t, support_vectors):
            y_project[i] += a * sv_t * rbf(X[i], sv)
    y_pred = np.sign(y_project)
    <span class=hljs-keyword >return</span> y_pred,  y_project</code></pre>
<pre><code class="python hljs"><span class=hljs-comment ># 半径の異なる円周上に点をばらつかせ, 内側を1, 外側を0 に分類</span>
factor = <span class=hljs-number >.2</span>
n_samples = <span class=hljs-number >50</span>
linspace = np.linspace(<span class=hljs-number >0</span>, <span class=hljs-number >2</span> * np.pi, n_samples // <span class=hljs-number >2</span> + <span class=hljs-number >1</span>)[:-<span class=hljs-number >1</span>]
outer_circ_x = np.cos(linspace)
outer_circ_y = np.sin(linspace)
inner_circ_x = outer_circ_x * factor
inner_circ_y = outer_circ_y * factor

X = np.vstack((np.append(outer_circ_x, inner_circ_x),
               np.append(outer_circ_y, inner_circ_y))).T
y = np.hstack([np.zeros(n_samples // <span class=hljs-number >2</span>, dtype=np.intp),
               np.ones(n_samples // <span class=hljs-number >2</span>, dtype=np.intp)])
X += np.random.normal(scale=<span class=hljs-number >0.15</span>, size=X.shape)
x_train = X
y_train = y

<span class=hljs-comment ># RBFカーネルの計算</span>
<span class=hljs-keyword >def</span> <span class="hljs-title function_">rbf</span>(<span class=hljs-params >u, v</span>):
        sigma = <span class=hljs-number >0.8</span>
        <span class=hljs-keyword >return</span> np.exp(-<span class=hljs-number >0.5</span> * ((u - v)**<span class=hljs-number >2</span>).<span class=hljs-built_in >sum</span>() / sigma**<span class=hljs-number >2</span>)

X_train = x_train
t = np.where(y_train == <span class=hljs-number >1.0</span>, <span class=hljs-number >1.0</span>, -<span class=hljs-number >1.0</span>)

K = np.zeros((n_samples, n_samples))
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(n_samples):
    <span class=hljs-keyword >for</span> j <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(n_samples):
        K[i, j] = rbf(X_train[i], X_train[j])

<span class=hljs-comment ># 学習</span>
a,b,support_vectors,support_vector_t, support_vector_a = fit_k(K, X_train, t)

<span class=hljs-comment ># 予測</span>
xx0, xx1 = np.meshgrid(np.linspace(-<span class=hljs-number >1.5</span>, <span class=hljs-number >1.5</span>, <span class=hljs-number >100</span>), np.linspace(-<span class=hljs-number >1.5</span>, <span class=hljs-number >1.5</span>, <span class=hljs-number >100</span>))
xx = np.array([xx0, xx1]).reshape(<span class=hljs-number >2</span>, -<span class=hljs-number >1</span>).T
X_test = xx

y_pred, y_project = predict_k(X_test, b, support_vectors, support_vector_t, support_vector_a)

<span class=hljs-comment ># 訓練データを可視化</span>
plt.scatter(x_train[:, <span class=hljs-number >0</span>], x_train[:, <span class=hljs-number >1</span>], c=y_train)
<span class=hljs-comment ># サポートベクトルを可視化</span>
plt.scatter(support_vectors[:, <span class=hljs-number >0</span>], support_vectors[:, <span class=hljs-number >1</span>],
                    s=<span class=hljs-number >100</span>, facecolors=<span class=hljs-string >&#x27;none&#x27;</span>, edgecolors=<span class=hljs-string >&#x27;k&#x27;</span>)
<span class=hljs-comment ># 領域を可視化</span>
plt.contourf(xx0, xx1, y_pred.reshape(<span class=hljs-number >100</span>, <span class=hljs-number >100</span>), alpha=<span class=hljs-number >0.2</span>, levels=np.linspace(<span class=hljs-number >0</span>, <span class=hljs-number >1</span>, <span class=hljs-number >3</span>))
<span class=hljs-comment ># マージンと決定境界を可視化</span>
plt.contour(xx0, xx1, y_project.reshape(<span class=hljs-number >100</span>, <span class=hljs-number >100</span>), colors=<span class=hljs-string >&#x27;k&#x27;</span>,
                     levels=[-<span class=hljs-number >1</span>, <span class=hljs-number >0</span>, <span class=hljs-number >1</span>], alpha=<span class=hljs-number >0.5</span>, linestyles=[<span class=hljs-string >&#x27;--&#x27;</span>, <span class=hljs-string >&#x27;-&#x27;</span>, <span class=hljs-string >&#x27;--&#x27;</span>])</code></pre>
<p>&lt;matplotlib.contour.QuadContourSet at 0x7f1cec0fb0a0&gt;</p>
<p><img src="/assets/np_svm_files/np_svm_9_1.svg" alt=SVG  /></p>
<h3 id="重なりのあるケースでの_ソフトマージンsvm"><a href="#重なりのあるケースでの_ソフトマージンsvm" class=header-anchor >重なりのあるケースでの ソフトマージンSVM</a></h3>
<p>要点まとめに書いた通り、最終的にパラメータ更新における、<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">a</span></span></span></span>の不等式制約が少し違うだけ。 関数をまとめて、Cの値によって場合分け実装した &#40;オリジナルの実装だと epsilon が異なっていたがまぁ、共通でもいいだろう。&#41;</p>
<pre><code class="python hljs"><span class=hljs-keyword >if</span> C == <span class=hljs-number >0</span>: <span class=hljs-comment ># 通常のSVM</span>
    a = np.where(a &gt; <span class=hljs-number >0</span>, a, <span class=hljs-number >0</span>) 
<span class=hljs-keyword >elif</span> C&gt;<span class=hljs-number >0</span>: <span class=hljs-comment ># ソフトマージンのとき</span>
    a = np.clip(a, <span class=hljs-number >0</span>, C)</code></pre>
<pre><code class="python hljs"><span class=hljs-comment ># 通常のSVMで使用したデータよりも集合が近い (1,1)と(-1,-1)の中心で散らばりをもたせたデータ</span>
x0 = np.random.normal(size=<span class=hljs-number >50</span>).reshape(-<span class=hljs-number >1</span>, <span class=hljs-number >2</span>) - <span class=hljs-number >1.</span>
x1 = np.random.normal(size=<span class=hljs-number >50</span>).reshape(-<span class=hljs-number >1</span>, <span class=hljs-number >2</span>) + <span class=hljs-number >1.</span>
x_train = np.concatenate([x0, x1])
y_train = np.concatenate([np.zeros(<span class=hljs-number >25</span>), np.ones(<span class=hljs-number >25</span>)]).astype(np.<span class=hljs-built_in >int</span>)

plt.scatter(x_train[:, <span class=hljs-number >0</span>], x_train[:, <span class=hljs-number >1</span>], c=y_train)

<span class=hljs-comment ># 学習</span>
X_train = x_train
t = np.where(y_train == <span class=hljs-number >1.0</span>, <span class=hljs-number >1.0</span>, -<span class=hljs-number >1.0</span>)
w, b, support_vectors  = fit(X_train, t, n_iter=<span class=hljs-number >1000</span>, C=<span class=hljs-number >1</span>)

<span class=hljs-comment ># 領域可視化のため、mesh上の点を生成</span>
xx0, xx1 = np.meshgrid(np.linspace(-<span class=hljs-number >4</span>, <span class=hljs-number >4</span>, <span class=hljs-number >100</span>), np.linspace(-<span class=hljs-number >4</span>, <span class=hljs-number >4</span>, <span class=hljs-number >100</span>))
xx = np.array([xx0, xx1]).reshape(<span class=hljs-number >2</span>, -<span class=hljs-number >1</span>).T
X_test = xx 
y_pred, y_project = predict(X_test,w,b)

<span class=hljs-comment ># 訓練データを可視化</span>
plt.scatter(x_train[:, <span class=hljs-number >0</span>], x_train[:, <span class=hljs-number >1</span>], c=y_train)

<span class=hljs-comment ># サポートベクトルを可視化</span>
plt.scatter(support_vectors[:, <span class=hljs-number >0</span>], support_vectors[:, <span class=hljs-number >1</span>],
                    s=<span class=hljs-number >100</span>, facecolors=<span class=hljs-string >&#x27;none&#x27;</span>, edgecolors=<span class=hljs-string >&#x27;k&#x27;</span>)
<span class=hljs-comment ># 領域を可視化</span>
plt.contourf(xx0, xx1, y_pred.reshape(<span class=hljs-number >100</span>, <span class=hljs-number >100</span>), alpha=<span class=hljs-number >0.2</span>, levels=np.linspace(<span class=hljs-number >0</span>, <span class=hljs-number >1</span>, <span class=hljs-number >3</span>))

<span class=hljs-comment ># マージンと決定境界を可視化</span>
plt.contour(xx0, xx1, y_project.reshape(<span class=hljs-number >100</span>, <span class=hljs-number >100</span>), colors=<span class=hljs-string >&#x27;k&#x27;</span>,
                     levels=[-<span class=hljs-number >1</span>, <span class=hljs-number >0</span>, <span class=hljs-number >1</span>], alpha=<span class=hljs-number >0.5</span>, linestyles=[<span class=hljs-string >&#x27;--&#x27;</span>, <span class=hljs-string >&#x27;-&#x27;</span>, <span class=hljs-string >&#x27;--&#x27;</span>])</code></pre>
<p>&lt;matplotlib.contour.QuadContourSet at 0x7f1ce7e997c0&gt;</p>
<p><img src="/assets/np_svm_files/np_svm_11_1.svg" alt=SVG  />
<h3 id="双対問題の導出_通常のsvmのケースについて"><a href="#双対問題の導出_通常のsvmのケースについて" class=header-anchor >双対問題の導出 &#40;通常のSVMのケースについて&#41;</a></h3>
<ul>
<li><p>自分もSVMよく覚えてなかったので、ざっくり思い出したい</p>

<li><p>ハンズオンの説明でも双対問題への変換の説明はすっ飛ばされているように感じる</p>

<li><p>SVMのケースに特化して、納得した気になるだけならそこまで難しくなさそう</p>

</ul>
<p>ということで、厳密性 &lt; 直感的理解 重視で、自分なりの納得の仕方を記す。</p>
<p>ラビットチャレンジの同期生で、早々と Stage.2 を終えた方はたくさんいるようだが、双対問題がどうやって導かれたかわからん、という人が一定数いるようなので、参考になれば幸い。&#40;厳密に理解したい人は教科書をちゃんと読むのがいいと思います&#41;</p>
<p>最小化問題と不等式制約の２つを分けて扱うのは大変なので、 「不等式制約のことは一旦わすれて、最小化問題を解いていたら、勝手に不等式制約もみたされていた」という状況を作れると嬉しい。 「目的関数を小さくしつつ、こういう性質を満たして欲しい」みたいな解を探す方法は色々あるが、&#40;ラビットチャレンジ勢的に&#41; 最初に思いつくのは ペナルティ項の追加&#40;正則化&#41;ですよね。不等式制約が満たされないと大きな値をとるような関数<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi mathvariant=bold-italic >w</mi><mo separator=true >,</mo><mi>b</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">f(\bm{w},b) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class=mclose >)</span></span></span></span>を足してやればよさそう。</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>J</mi><mo stretchy=false >(</mo><mi mathvariant=bold-italic >w</mi><mo separator=true >,</mo><mi>b</mi><mo stretchy=false >)</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi mathvariant=normal >∣</mi><mi mathvariant=normal >∣</mi><mi mathvariant=bold-italic >w</mi><mi mathvariant=normal >∣</mi><msup><mi mathvariant=normal >∣</mi><mn>2</mn></msup><mo>+</mo><mi>f</mi><mo stretchy=false >(</mo><mi mathvariant=bold-italic >w</mi><mo separator=true >,</mo><mi>b</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> J(\bm{w},b) = \frac{1}{2} ||\bm{w} ||^{2} + f(\bm{w},b)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class=mopen >(</span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.00744em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord >∣</span><span class=mord >∣</span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=mord >∣</span><span class=mord ><span class=mord >∣</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class=mclose >)</span></span></span></span></span>
<p>ただし、今まで扱ってきた正則化では、「なるべくノルムが小さくなるように」でヨカッタのだが、不等式制約は絶対に満たさなければいけないので、下記注意が必要。</p>
<ul>
<li><p>不等式制約が満たされているときに <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi mathvariant=bold-italic >w</mi><mo separator=true >,</mo><mi>b</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">f(\bm{w},b)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class=mclose >)</span></span></span></span> が何らかの値を持ってしまうとすると、</p>

</ul>
<p>この新たな目的関数の勾配は、元の目的関数 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mi mathvariant=normal >∣</mi><mi mathvariant=normal >∣</mi><mi mathvariant=bold-italic >w</mi><mi mathvariant=normal >∣</mi><msup><mi mathvariant=normal >∣</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\frac{1}{2} ||\bm{w} ||^2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.190108em;vertical-align:-0.345em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord >∣</span><span class=mord >∣</span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=mord >∣</span><span class=mord ><span class=mord >∣</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> をもっとも減少させる勾配とは少しズレた方向を向くことになって問題だ。 つまり、不等式制約を満たす時、<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">f=0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>でなければならない。</p>
<ul>
<li><p>また 制約を満たさないペナルティに対して、制約を犯したときの第一項目が減少量が大きいければ、不等式制約を満たす保証ができない。</p>

</ul>
<p>つまり、不等式制約を満たさないとき、<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>=</mo><mo>+</mo><mi mathvariant=normal >∞</mi></mrow><annotation encoding="application/x-tex">f=+\infty</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class=mord >+</span><span class=mord >∞</span></span></span></span> でないとならない。</p>
<p>このような性質をもった関数はあるだろうか? ぱっと考え着くのは、微分不可能・不連続点のある関数だが、これを扱うのは数学的に難しそう。 こういうちょっと特殊な関数の振る舞いを、再現するときは、新しい変数・次元を増やしてやるとうまくいくことがある。&#40;カーネルSVMもそうだよね&#41; ここでは、新しい&quot;非負の&quot; 変数を導入して、それに対する max をとる関数として定義してみよう。</p>
<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi mathvariant=bold-italic >w</mi><mo separator=true >,</mo><mi>b</mi><mo stretchy=false >)</mo><mo>=</mo><msub><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >x</mi></mrow><mi mathvariant=bold-italic >a</mi></msub><msub><mo>∑</mo><mi>i</mi></msub><msub><mi>a</mi><mi>i</mi></msub><mo fence=true >(</mo><mo>−</mo><mo stretchy=false >(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy=false >(</mo><msup><mi mathvariant=bold-italic >w</mi><mi>T</mi></msup><msub><mi mathvariant=bold-italic >x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo stretchy=false >)</mo><mo>−</mo><mn>1</mn><mo stretchy=false >)</mo><mo fence=true >)</mo></mrow><annotation encoding="application/x-tex"> f(\bm{w},b) = \mathrm{max}_{\bm{a}}  \sum_i a_i \bigl(-(t_i (\bm{w}^T \bm{x}_i + b) -1)\bigr) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.20001em;vertical-align:-0.35001em;"></span><span class=mord ><span class=mord ><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight">a</span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mop ><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.16195399999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen ><span class="delimsizing size1">(</span></span><span class=mord >−</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.20001em;vertical-align:-0.35001em;"></span><span class=mord >1</span><span class=mclose >)</span><span class=mclose ><span class="delimsizing size1">)</span></span></span></span></span>
<ul>
<li><p>不等式制約を満たすとき つまり <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy=false >(</mo><msup><mi mathvariant=bold-italic >w</mi><mi>T</mi></msup><msub><mi mathvariant=bold-italic >x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo stretchy=false >)</mo><mo>−</mo><mn>1</mn><mo stretchy=false >)</mo><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">(t_i (\bm{w}^T \bm{x}_i + b) -1) \ge 0 </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≥</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> の時、 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> と掛け算する値が負なので、最大化するには <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a_i=0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>　で <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">f=0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>  ※ これKKT条件 等式制約に一致する</p>

<li><p>不等式制約を満たさないとき つまり <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy=false >(</mo><msup><mi mathvariant=bold-italic >w</mi><mi>T</mi></msup><msub><mi mathvariant=bold-italic >x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo stretchy=false >)</mo><mo>−</mo><mn>1</mn><mo stretchy=false >)</mo><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">(t_i (\bm{w}^T \bm{x}_i + b) -1) &lt; 0 </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> の時 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> と掛け算する値が生なので、最大化するには <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>→</mo><mi mathvariant=normal >∞</mi></mrow><annotation encoding="application/x-tex">a_i \rightarrow \infty</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >→</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class=mord >∞</span></span></span></span> で <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>=</mo><mi mathvariant=normal >∞</mi></mrow><annotation encoding="application/x-tex">f=\infty</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class=mord >∞</span></span></span></span> </p>

</ul>
<p>うん、よさそうだ。ということで解くべき問題は、</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msub><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >i</mi><mi mathvariant=normal >n</mi></mrow><mrow><mi mathvariant=bold-italic >w</mi><mo separator=true >,</mo><mi>b</mi></mrow></msub><mo fence=true >(</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi mathvariant=normal >∣</mi><mi mathvariant=normal >∣</mi><mi mathvariant=bold-italic >w</mi><mi mathvariant=normal >∣</mi><msup><mi mathvariant=normal >∣</mi><mn>2</mn></msup><mo>+</mo><mtext>　</mtext><msub><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >x</mi></mrow><mrow><mi mathvariant=bold-italic >a</mi><mo>&gt;</mo><mn>0</mn></mrow></msub><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>a</mi><mi>i</mi></msub><mo fence=true >(</mo><mo>−</mo><mo stretchy=false >(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy=false >(</mo><msup><mi mathvariant=bold-italic >w</mi><mi>T</mi></msup><msub><mi mathvariant=bold-italic >x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo stretchy=false >)</mo><mo>−</mo><mn>1</mn><mo stretchy=false >)</mo><mo fence=true >)</mo><mo fence=true >)</mo><mspace width=2em /><msub><mi>a</mi><mi>i</mi></msub><mo>≥</mo><mn>0</mn><mspace width=1em /><mo stretchy=false >(</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=true >,</mo><mn>2</mn><mo separator=true >,</mo><mo>…</mo><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> \mathrm{min}_{\bm{w},b}  \biggl( \frac{1}{2} ||\bm{w} ||^{2} +　\mathrm{max}_{\bm{a}&gt;0}  \sum_i a_i \bigl(-(t_i (\bm{w}^T \bm{x}_i + b) -1)\bigr) \biggr) \qquad a_i \ge 0 \quad (i=1,2,\ldots) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class=mord ><span class=mord ><span class="mord mathrm">m</span><span class="mord mathrm">i</span><span class="mord mathrm">n</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.02778em;">w</span></span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mopen ><span class="delimsizing size3">(</span></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord >∣</span><span class=mord >∣</span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=mord >∣</span><span class=mord ><span class=mord >∣</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.327674em;vertical-align:-1.277669em;"></span><span class="mord cjk_fallback">　</span><span class=mord ><span class=mord ><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight">a</span></span></span><span class="mrel mtight">&gt;</span><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.17737em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0500050000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.277669em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen ><span class="delimsizing size1">(</span></span><span class=mord >−</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class=mord >1</span><span class=mclose >)</span><span class=mclose ><span class="delimsizing size1">)</span></span><span class=mclose ><span class="delimsizing size3">)</span></span><span class=mspace  style="margin-right:2em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≥</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >0</span><span class=mspace  style="margin-right:1em;"></span><span class=mopen >(</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >2</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner >…</span><span class=mclose >)</span></span></span></span></span>
<p>ということになるが、<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold-italic >w</mi><mo separator=true >,</mo><mi>b</mi><mo separator=true >,</mo><mi mathvariant=bold-italic >a</mi></mrow><annotation encoding="application/x-tex">\bm{w}, b, \bm{a}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span></span></span></span> は本来独立に動かせる変数で、第一項目に <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold-italic >a</mi></mrow><annotation encoding="application/x-tex">\bm{a}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.44444em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span></span></span></span> は含まれないので、</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msub><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >i</mi><mi mathvariant=normal >n</mi></mrow><mrow><mi mathvariant=bold-italic >w</mi><mo separator=true >,</mo><mi>b</mi></mrow></msub><msub><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >x</mi></mrow><mrow><mi mathvariant=bold-italic >a</mi><mo>&gt;</mo><mn>0</mn></mrow></msub><mtext>　</mtext><mo fence=true >(</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi mathvariant=normal >∣</mi><mi mathvariant=normal >∣</mi><mi mathvariant=bold-italic >w</mi><mi mathvariant=normal >∣</mi><msup><mi mathvariant=normal >∣</mi><mn>2</mn></msup><mo>+</mo><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>a</mi><mi>i</mi></msub><mo fence=true >(</mo><mo>−</mo><mo stretchy=false >(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy=false >(</mo><msup><mi mathvariant=bold-italic >w</mi><mi>T</mi></msup><msub><mi mathvariant=bold-italic >x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo stretchy=false >)</mo><mo>−</mo><mn>1</mn><mo stretchy=false >)</mo><mo fence=true >)</mo><mo fence=true >)</mo><mspace width=2em /><msub><mi>a</mi><mi>i</mi></msub><mo>≥</mo><mn>0</mn><mspace width=1em /><mo stretchy=false >(</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=true >,</mo><mn>2</mn><mo separator=true >,</mo><mo>…</mo><mo stretchy=false >)</mo><mo>:</mo><mo>=</mo><msub><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >i</mi><mi mathvariant=normal >n</mi></mrow><mrow><mi mathvariant=bold-italic >w</mi><mo separator=true >,</mo><mi>b</mi></mrow></msub><msub><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >x</mi></mrow><mrow><mi mathvariant=bold-italic >a</mi><mo>&gt;</mo><mn>0</mn></mrow></msub><mover accent=true ><mi>L</mi><mo>~</mo></mover><mo stretchy=false >(</mo><mi mathvariant=bold-italic >w</mi><mo separator=true >,</mo><mi>b</mi><mo separator=true >,</mo><mi mathvariant=bold-italic >a</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> \mathrm{min}_{\bm{w},b} \mathrm{max}_{\bm{a}&gt;0} 　 \biggl( \frac{1}{2} ||\bm{w} ||^{2} + \sum_i a_i \bigl(-(t_i (\bm{w}^T \bm{x}_i + b) -1)\bigr) \biggr) \qquad a_i \ge 0 \quad (i=1,2,\ldots) := \mathrm{min}_{\bm{w},b} \mathrm{max}_{\bm{a}&gt;0} \tilde{L}(\bm{w},b,\bm{a}) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class=mord ><span class=mord ><span class="mord mathrm">m</span><span class="mord mathrm">i</span><span class="mord mathrm">n</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.02778em;">w</span></span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight">a</span></span></span><span class="mrel mtight">&gt;</span><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.17737em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">　</span><span class=mopen ><span class="delimsizing size3">(</span></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord >∣</span><span class=mord >∣</span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=mord >∣</span><span class=mord ><span class=mord >∣</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.327674em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0500050000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.277669em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen ><span class="delimsizing size1">(</span></span><span class=mord >−</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol">x</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class=mord >1</span><span class=mclose >)</span><span class=mclose ><span class="delimsizing size1">)</span></span><span class=mclose ><span class="delimsizing size3">)</span></span><span class=mspace  style="margin-right:2em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≥</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >0</span><span class=mspace  style="margin-right:1em;"></span><span class=mopen >(</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >2</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner >…</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >:</span></span><span class=base ><span class=strut  style="height:0.36687em;vertical-align:0em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.2062979999999999em;vertical-align:-0.286108em;"></span><span class=mord ><span class=mord ><span class="mord mathrm">m</span><span class="mord mathrm">i</span><span class="mord mathrm">n</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.02778em;">w</span></span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight">a</span></span></span><span class="mrel mtight">&gt;</span><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.17737em;"><span></span></span></span></span></span></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9201899999999998em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">L</span></span></span><span style="top:-3.6023300000000003em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.22222em;"><span class=mord >~</span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span><span class=mclose >)</span></span></span></span></span>
<p>と書き換えてもよい。</p>
<p>ここで、内側で <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >x</mi></mrow><mrow><mi mathvariant=bold-italic >a</mi><mo>&gt;</mo><mn>0</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\mathrm{max}_{\bm{a}&gt;0}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.60793em;vertical-align:-0.17737em;"></span><span class=mord ><span class=mord ><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight">a</span></span></span><span class="mrel mtight">&gt;</span><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.17737em;"><span></span></span></span></span></span></span></span></span></span> の操作をすることは、より小さな最適値を見つけるための可能性を狭めることにつながるので、一般には</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msub><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >i</mi><mi mathvariant=normal >n</mi></mrow><mrow><mi mathvariant=bold-italic >w</mi><mo separator=true >,</mo><mi>b</mi></mrow></msub><msub><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >x</mi></mrow><mrow><mi mathvariant=bold-italic >a</mi><mo>&gt;</mo><mn>0</mn></mrow></msub><mover accent=true ><mi>L</mi><mo>~</mo></mover><mo stretchy=false >(</mo><mi mathvariant=bold-italic >w</mi><mo separator=true >,</mo><mi>b</mi><mo separator=true >,</mo><mi mathvariant=bold-italic >a</mi><mo stretchy=false >)</mo><mo>≥</mo><msub><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >x</mi></mrow><mrow><mi mathvariant=bold-italic >a</mi><mo>&gt;</mo><mn>0</mn></mrow></msub><msub><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >i</mi><mi mathvariant=normal >n</mi></mrow><mrow><mi mathvariant=bold-italic >w</mi><mo separator=true >,</mo><mi>b</mi></mrow></msub><mover accent=true ><mi>L</mi><mo>~</mo></mover><mo stretchy=false >(</mo><mi mathvariant=bold-italic >w</mi><mo separator=true >,</mo><mi>b</mi><mo separator=true >,</mo><mi mathvariant=bold-italic >a</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">
\mathrm{min}_{\bm{w},b} \mathrm{max}_{\bm{a}&gt;0} \tilde{L}(\bm{w},b,\bm{a}) \ge  \mathrm{max}_{\bm{a}&gt;0} \mathrm{min}_{\bm{w},b}  \tilde{L}(\bm{w},b,\bm{a})
</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2062979999999999em;vertical-align:-0.286108em;"></span><span class=mord ><span class=mord ><span class="mord mathrm">m</span><span class="mord mathrm">i</span><span class="mord mathrm">n</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.02778em;">w</span></span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight">a</span></span></span><span class="mrel mtight">&gt;</span><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.17737em;"><span></span></span></span></span></span></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9201899999999998em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">L</span></span></span><span style="top:-3.6023300000000003em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.22222em;"><span class=mord >~</span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≥</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.2062979999999999em;vertical-align:-0.286108em;"></span><span class=mord ><span class=mord ><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight">a</span></span></span><span class="mrel mtight">&gt;</span><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.17737em;"><span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class="mord mathrm">m</span><span class="mord mathrm">i</span><span class="mord mathrm">n</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.02778em;">w</span></span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9201899999999998em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">L</span></span></span><span style="top:-3.6023300000000003em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.22222em;"><span class=mord >~</span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span><span class=mclose >)</span></span></span></span></span>
<p>の関係が成り立ち、この等号が成立するかどうかは自明ではない。&#40;cf. 弱双対定理&#41; </p>
<p>しかしながら、今、各パラメータによる<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent=true ><mi>L</mi><mo>~</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{L}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.9201899999999998em;vertical-align:0em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9201899999999998em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">L</span></span></span><span style="top:-3.6023300000000003em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.22222em;"><span class=mord >~</span></span></span></span></span></span></span></span></span></span> の勾配 &#61; 0 から得られる式は、基本的に各パラメータに対しての1次ないし0次の式。また制約式も線形だ。最大化、最小化を行う順番を変える、というのは、勾配&#61;0の式を使って、そのパラメータを消去する順番が違うということに相当するわけだが、問題がずっと線形のままならば、どういう順番でパラメータを消去していったところで、直感的には最適値が変わることはなさそうである。</p>
<p>ということで、問題は、</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msub><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >x</mi></mrow><mrow><mi mathvariant=bold-italic >a</mi><mo>&gt;</mo><mn>0</mn></mrow></msub><msub><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >i</mi><mi mathvariant=normal >n</mi></mrow><mrow><mi mathvariant=bold-italic >w</mi><mo separator=true >,</mo><mi>b</mi></mrow></msub><mover accent=true ><mi>L</mi><mo>~</mo></mover><mo stretchy=false >(</mo><mi mathvariant=bold-italic >w</mi><mo separator=true >,</mo><mi>b</mi><mo separator=true >,</mo><mi mathvariant=bold-italic >a</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">
\mathrm{max}_{\bm{a}&gt;0} \mathrm{min}_{\bm{w},b}  \tilde{L}(\bm{w},b,\bm{a})
</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2062979999999999em;vertical-align:-0.286108em;"></span><span class=mord ><span class=mord ><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight">a</span></span></span><span class="mrel mtight">&gt;</span><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.17737em;"><span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class="mord mathrm">m</span><span class="mord mathrm">i</span><span class="mord mathrm">n</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.02778em;">w</span></span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9201899999999998em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">L</span></span></span><span style="top:-3.6023300000000003em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.22222em;"><span class=mord >~</span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol">a</span></span></span><span class=mclose >)</span></span></span></span></span>
<p>と書き換えられる事になり、ハンズオンの議論につながる。</p>
<h2 id="取り組み概要_感想"><a href="#取り組み概要_感想" class=header-anchor >取り組み概要 &amp; 感想</a></h2>
<h3 id="取り組みの記録"><a href="#取り組みの記録" class=header-anchor >取り組みの記録</a></h3>
<ul>
<li><p>3/31, 4/1: まずはざっと新しい動画を視聴&#40;1.5倍速&#41;しながらメモをとり・微分計算。基本的に動画を途中でストップすることはなかった。約200分で完了。まぁ、問題なさそうだなぁ。という感触だけ得る。</p>

</ul>
<ul>
<li><p>4/1~28 : しばらく塩漬け状態.. &#40;GTC21の聴講などをしていたので&#41;</p>

</ul>
<ul>
<li><p>4/29 : ハンズオンの実行環境の構築。Collaborately はセル実行のレスポンスが遅いのでローカルに環境を整える。win10上に pyenv &#43; poetry でを仮想環境を作る。30分程度。</p>

</ul>
<ul>
<li><p>4/30-5/1 : 線形回帰 旧動画の方をみながらハンズオン。新旧動画をみながら残したメモを適当に要点まとめとしてblog記事にする。その後 ハンズオンのノートブックファイルを markdown 化し、課題提出用blogの記事ty中にinclude。ハンズオンが 45分, 要点まとめや記事の整形が 1h. </p>

</ul>
<ul>
<li><p>5/1 : 非線形回帰。旧動画をみながら、新動画をみたときのメモと見比べていくつかコメント追加し、要点まとめ。その後、ハンズオンを実行。scikit-learn で RBFカーネルといったときには何をさすのか? SVRってなんだ? など調べていたらすこし時間をくった。合計 3h。</p>

</ul>
<ul>
<li><p>5/2~5/5 : 非線形回帰と同様の取り組み方で、残りの単元を1日1つずつ仕上げる。各日3h程度なので、合計12hくらい </p>

</ul>
<ul>
<li><p>5/6 : ステージテスト。所要時間は 30 分程度で、結果は14点/15点。ハヤトチリしました。。スタートテストと違って制限時間が無いのでリラックスして受けられた。</p>

</ul>
<h3 id="感想ほか"><a href="#感想ほか" class=header-anchor >感想ほか　</a></h3>
<p>講義動画について。旧動画と新動画でけっこう趣が違う。時間に余裕があれば、両方見てもよいのではなかろうか。</p>
<ul>
<li><p>新動画</p>
<ul>
<li><p>「基本きっちり押さえれば、後の細かい所は頑張れるでしょ」的な解説。講師の男性はもともとは研究寄りの人な印象を受ける</p>

<li><p>手計算してるところをみせてくれる &#40;ロジスティック回帰の勾配計算とかやったことない人はやりましょう&#41;</p>

<li><p>実戦的な注意点などは、参考情報が旧動画より多め</p>

<li><p>その他資料に載っていない背景説明などもある。結果的に時間の都合で資料の説明を一部すっとばすことがある</p>

<li><p>「お前らコレ難しいからわかってねーだろ」的な発言がチラホラ。人によってはイラッとするかも?</p>

</ul>

</ul>
<ul>
<li><p>旧動画のいいところ</p>
<ul>
<li><p>基本的に資料に沿った説明をたんたんとしてくれる感じで、 講師の女性はどちらかというとソフトウェア開発寄の人な印象</p>

<li><p>ハンズオンの説明は こちらの方が丁寧</p>

</ul>

</ul>
<p>ハンズオンは基本的に、資料/動画 で学習した手法を使ったデータ分析で、自分で編集しなくてもそのまま実行できてしまう。 コードから学ぶことに慣れている人は、買ってに勘所を見つけて得るべきものを得るが、 人によっては、「へーこんな結果になるんだぁ」で終わってしまうんでなかろうか? それだとちょっともったいない。 例えば、大事なところを数カ所穴埋めにして、考えるきっかけにしてもらう、などやっても良い気がした。</p>
<p>テストについての感想。&#40;他の受講生もあとから受ける可能性があるため具体的な内容には触れない&#41; 15問中13問はビデオ講義のどこかででやった内容そのままだった。 単純なミスや早とちりこそあれ、これらの問題に自信を持って回答できないのであれば、しっかり復習をした方がよさそうだ。 残り2問は、ラビットチャレンジで初めて勉強を始めた人にとっては、未知の手法が出題されたように感じるかもしれない。 しかし、この2問のうち先に出題される問題が、その未知の手法自体を問題文で説明してくれているので、問題文の意味をしっかり捉えれば正解は導ける。 また、それができれば、芋づる式に残り1問も計算問題として解けるので、難しすぎるとか、講義内容とのミスマッチなどを感じることは個人的にはなかった。</p>
<h2 id="計画の見直し_20210506_時点"><a href="#計画の見直し_20210506_時点" class=header-anchor >計画の見直し &#40;2021/05/06 時点&#41;</a></h2>
<p>4/18に終わらせるはずだったステージ2が半月遅れてしまった。 実際に学習に費やしている時間はそこまで長くないが、取り組む時間を確保するのが難しい。</p>
<p>これまで ステージテストはスムーズに合格しているので、各ステージうまく理解ができていると思いたい。 この調子ですすめれば、修了テストにかかる時間は少し縮めてもよいだろう。スケジュールを下記の様に修正する。</p>
<ul>
<li><p>~2021/2/15  : スタートテスト &#40;2021/02/07完了&#41;</p>

<li><p>~2021/3/30  : ステージ1      &#40;2021/03/30完了&#41;</p>

<li><p>~2021/5/6   : ステージ2      &#40;2021/05/06完了&#41;</p>

<li><p>~2021/5/30  : ステージ3 </p>

<li><p>~2021/6/27  : ステージ4 </p>

<li><p>~2021/7/4   : 復習 -&gt; 修了テスト </p>

<li><p>~2021/7/15  : Eもぎライト -&gt; 今後の計画具体化 </p>

<li><p>~2021/7/30  : シラバスの未習箇所の学習 </p>

<li><p>~2021/8/26  : 全体の復習</p>

<li><p>2021/8/27,28: E資格 受験 </p>

</ul>
<p>だんだん 8月に万全を期しての受験が厳しくなってきた気もするが、、淡々と進めていこう。</p>
<div class=page-foot >
  <div class=copyright >
    &copy; kyokke. Last modified: November 07, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>
    </div>